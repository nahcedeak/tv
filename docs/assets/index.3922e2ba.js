var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,i=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,a=(e,i,n)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n,r=(t,r)=>{for(var s in r||(r={}))e.call(r,s)&&a(t,s,r[s]);if(i)for(var s of i(r))n.call(r,s)&&a(t,s,r[s]);return t};!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(i){const n=new URL(t,location),a=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((i,r)=>{const s=new URL(t,n);if(self[e].moduleMap[s])return i(self[e].moduleMap[s]);const o=new Blob([`import * as m from '${s}';`,`${e}.moduleMap['${s}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){r(new Error(`Failed to import: ${t}`)),a(l)},onload(){i(self[e].moduleMap[s]),a(l)}});document.head.appendChild(l)})),self[e].moduleMap={}}}("assets/");var s;window.FontAwesomeKitConfig={asyncLoading:{enabled:!1},autoA11y:{enabled:!0},baseUrl:"https://ka-f.fontawesome.com",baseUrlKit:"https://kit.fontawesome.com",detectConflictsUntil:null,iconUploads:{},id:7,license:"pro",method:"js",minify:{enabled:!0},token:"110",v4FontFaceShim:{enabled:!0},v4shim:{enabled:!0},version:"5.15.3"},s=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function i(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function n(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?i(Object(a),!0).forEach((function(i){e(t,i,a[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){var i=e&&e.addOn||"",n=e&&e.baseFilename||t.license+i,a=e&&e.minify?".min":"",r=e&&e.fileSuffix||t.method,s=e&&e.subdir||t.method;return t.baseUrl+"/releases/"+("latest"===t.version?"latest":"v".concat(t.version))+"/"+s+"/"+n+a+"."+r}function s(t){return t.baseUrlKit+"/"+t.token+"/"+t.id+"/kit-upload.css"}function o(t,e){var i=e||["fa"],n="."+Array.prototype.join.call(i,",."),a=t.querySelectorAll(n);Array.prototype.forEach.call(a,(function(e){var i=e.getAttribute("title");e.setAttribute("aria-hidden","true");var n=!e.nextElementSibling||!e.nextElementSibling.classList.contains("sr-only");if(i&&n){var a=t.createElement("span");a.innerHTML=i,a.classList.add("sr-only"),e.parentNode.insertBefore(a,e.nextSibling)}}))}var l,d=function(){},u="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,h="undefined"==typeof setImmediate?setTimeout:setImmediate,c=[];function g(){for(var t=0;t<c.length;t++)c[t][0](c[t][1]);c=[],l=!1}function f(t,e){c.push([t,e]),l||(l=!0,h(g,0))}function p(t){var e=t.owner,i=e._state,n=e._data,a=t[i],r=t.then;if("function"==typeof a){i="fulfilled";try{n=a(n)}catch(s){y(r,s)}}m(r,n)||("fulfilled"===i&&v(r,n),"rejected"===i&&y(r,n))}function m(e,i){var n;try{if(e===i)throw new TypeError("A promises callback cannot return that same promise.");if(i&&("function"==typeof i||"object"===t(i))){var a=i.then;if("function"==typeof a)return a.call(i,(function(t){n||(n=!0,i===t?T(e,t):v(e,t))}),(function(t){n||(n=!0,y(e,t))})),!0}}catch(r){return n||y(e,r),!0}return!1}function v(t,e){t!==e&&m(t,e)||T(t,e)}function T(t,e){"pending"===t._state&&(t._state="settled",t._data=e,f(b,t))}function y(t,e){"pending"===t._state&&(t._state="settled",t._data=e,f(S,t))}function E(t){t._then=t._then.forEach(p)}function b(t){t._state="fulfilled",E(t)}function S(t){t._state="rejected",E(t),!t._handled&&u&&global.process.emit("unhandledRejection",t._data,t)}function A(t){global.process.emit("rejectionHandled",t)}function L(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof L==0)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(t,e){function i(t){y(e,t)}try{t((function(t){v(e,t)}),i)}catch(n){i(n)}}(t,this)}L.prototype={constructor:L,_state:"pending",_then:null,_data:void 0,_handled:!1,then:function(t,e){var i={owner:this,then:new this.constructor(d),fulfilled:t,rejected:e};return!e&&!t||this._handled||(this._handled=!0,"rejected"===this._state&&u&&f(A,this)),"fulfilled"===this._state||"rejected"===this._state?f(p,i):this._then.push(i),i.then},catch:function(t){return this.then(null,t)}},L.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new L((function(e,i){var n=[],a=0;function r(t){return a++,function(i){n[t]=i,--a||e(n)}}for(var s,o=0;o<t.length;o++)(s=t[o])&&"function"==typeof s.then?s.then(r(o),i):n[o]=s;a||e(n)}))},L.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new L((function(e,i){for(var n,a=0;a<t.length;a++)(n=t[a])&&"function"==typeof n.then?n.then(e,i):e(n)}))},L.resolve=function(e){return e&&"object"===t(e)&&e.constructor===L?e:new L((function(t){t(e)}))},L.reject=function(t){return new L((function(e,i){i(t)}))};var w="function"==typeof Promise?Promise:L;function C(t,e){var i=e.fetch,n=e.XMLHttpRequest,a=e.token,r=t;return"URLSearchParams"in window?(r=new URL(t)).searchParams.set("token",a):r=r+"?token="+encodeURIComponent(a),r=r.toString(),new w((function(t,e){if("function"==typeof i)i(r,{mode:"cors",cache:"default"}).then((function(t){if(t.ok)return t.text();throw new Error("")})).then((function(e){t(e)})).catch(e);else if("function"==typeof n){var a=new n;a.addEventListener("loadend",(function(){this.responseText?t(this.responseText):e(new Error(""))})),["abort","error","timeout"].map((function(t){a.addEventListener(t,(function(){e(new Error(""))}))})),a.open("GET",r),a.send()}else e(new Error(""))}))}function D(t,e,i){var n=t;return[[/(url\("?)\.\.\/\.\.\/\.\./g,function(t,i){return"".concat(i).concat(e)}],[/(url\("?)\.\.\/webfonts/g,function(t,n){return"".concat(n).concat(e,"/releases/v").concat(i,"/webfonts")}],[/(url\("?)https:\/\/kit-free([^.])*\.fontawesome\.com/g,function(t,i){return"".concat(i).concat(e)}]].forEach((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(l){a=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),i=e[0],r=e[1];n=n.replace(i,r)})),n}function R(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=e.document||a,l=o.bind(o,a,["fa","fab","fas","far","fal","fad","fak"]),d=Object.keys(t.iconUploads||{}).length>0;t.autoA11y.enabled&&i(l);var u=[{id:"fa-main",addOn:void 0}];t.v4shim.enabled&&u.push({id:"fa-v4-shims",addOn:"-v4-shims"}),t.v4FontFaceShim.enabled&&u.push({id:"fa-v4-font-face",addOn:"-v4-font-face"}),d&&u.push({id:"fa-kit-upload",customCss:!0});var h=u.map((function(i){return new w((function(a,o){C(i.customCss?s(t):r(t,{addOn:i.addOn,minify:t.minify.enabled}),e).then((function(r){a(k(r,n(n({},e),{},{baseUrl:t.baseUrl,version:t.version,id:i.id,contentFilter:function(t,e){return D(t,e.baseUrl,e.version)}})))})).catch(o)}))}));return w.all(h)}function k(t,e){var i=e.contentFilter||function(t,e){return t},n=document.createElement("style"),a=document.createTextNode(i(t,e));return n.appendChild(a),n.media="all",e.id&&n.setAttribute("id",e.id),e&&e.detectingConflicts&&e.detectionIgnoreAttr&&n.setAttributeNode(document.createAttribute(e.detectionIgnoreAttr)),n}function x(t,e){e.autoA11y=t.autoA11y.enabled,"pro"===t.license&&(e.autoFetchSvg=!0,e.fetchSvgFrom=t.baseUrl+"/releases/"+("latest"===t.version?"latest":"v".concat(t.version))+"/svgs",e.fetchUploadedSvgFrom=t.uploadsUrl);var i=[];return t.v4shim.enabled&&i.push(new w((function(i,a){C(r(t,{addOn:"-v4-shims",minify:t.minify.enabled}),e).then((function(t){i(O(t,n(n({},e),{},{id:"fa-v4-shims"})))})).catch(a)}))),i.push(new w((function(i,a){C(r(t,{minify:t.minify.enabled}),e).then((function(t){var a,r,s,o,l=O(t,n(n({},e),{},{id:"fa-main"}));i((a=l,s=(r=e)&&void 0!==r.autoFetchSvg?r.autoFetchSvg:void 0,void 0!==(o=r&&void 0!==r.autoA11y?r.autoA11y:void 0)&&a.setAttribute("data-auto-a11y",o?"true":"false"),s&&(a.setAttributeNode(document.createAttribute("data-auto-fetch-svg")),a.setAttribute("data-fetch-svg-from",r.fetchSvgFrom),a.setAttribute("data-fetch-uploaded-svg-from",r.fetchUploadedSvgFrom)),a))})).catch(a)}))),w.all(i)}function O(t,e){var i=document.createElement("SCRIPT"),n=document.createTextNode(t);return i.appendChild(n),i.referrerPolicy="strict-origin",e.id&&i.setAttribute("id",e.id),e&&e.detectingConflicts&&e.detectionIgnoreAttr&&i.setAttributeNode(document.createAttribute(e.detectionIgnoreAttr)),i}function I(t){var e,i=[],n=document,a=(n.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);a||n.addEventListener("DOMContentLoaded",e=function(){for(n.removeEventListener("DOMContentLoaded",e),a=1;e=i.shift();)e()}),a?setTimeout(t,0):i.push(t)}function _(t){"undefined"!=typeof MutationObserver&&new MutationObserver(t).observe(document,{childList:!0,subtree:!0})}try{if(window.FontAwesomeKitConfig){var F=window.FontAwesomeKitConfig,N={detectingConflicts:F.detectConflictsUntil&&new Date<=new Date(F.detectConflictsUntil),detectionIgnoreAttr:"data-fa-detection-ignore",fetch:window.fetch,token:F.token,XMLHttpRequest:window.XMLHttpRequest,document:document},P=document.currentScript,M=P?P.parentElement:document.head;(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"js"===t.method?x(t,e):"css"===t.method?R(t,e,(function(t){I(t),_(t)})):void 0})(F,N).then((function(t){t.map((function(t){try{M.insertBefore(t,P?P.nextSibling:null)}catch(e){M.appendChild(t)}})),N.detectingConflicts&&P&&I((function(){P.setAttributeNode(document.createAttribute(N.detectionIgnoreAttr));var t,e,i,n=(t=F,e=N,i=document.createElement("script"),e&&e.detectionIgnoreAttr&&i.setAttributeNode(document.createAttribute(e.detectionIgnoreAttr)),i.src=r(t,{baseFilename:"conflict-detection",fileSuffix:"js",subdir:"js",minify:t.minify.enabled}),i);document.body.appendChild(n)}))})).catch((function(t){console.error("".concat("Font Awesome Kit:"," ").concat(t))}))}}catch(B){console.error("".concat("Font Awesome Kit:"," ").concat(B))}},"function"==typeof define&&define.amd?define("kit-loader",s):s();const o="https://iptv-org.github.io/iptv/",l={method:"GET",mode:"cors",credentials:"omit"},d={tagName:"div",classList:" font-mono dark:bg-gray-700 dark:text-purple-700",subelement:[{tagName:"div",subelement:[{tagName:"div",id:"video-wrap",classList:" top-0 bg-gray-800 rounded-b-3xl z-10 sticky grid justify-items-center",subelement:[{tagName:"video",attribute:{controls:"controls",crossOrigin:"anonymous",preload:"metadata"},classList:"outline-none"},{tagName:"figure",id:"nav",attribute:{},classList:" w-full rounded-b-2xl grid grid-rows-1 grid-cols-10 items-center bg-gradient-to-r from-indigo-100 via-purple-50 to-indigo-100",subelement:[{tagName:"button",id:"random-button",classList:" \n    w-10 h-10 text-blue-900 \n    col-span-2 row-span-1 rounded-full\n    justify-self-end items-center' +\n    focus:text-blue-500 focus:outline-none\n    hover:text-blue-500",subelement:[{tagName:"i",classList:"fad fa-random text-2xl"}]},{tagName:"div",id:"channel-message",classList:" col-span-6 row-span-1 justify-self-center text-2xl text-blue-900 font-bold cursor-wait"},{tagName:"div",id:"bars",classList:"col-span-2 row-span-1 justify-self-start",subelement:[{tagName:"button",id:"menu-button",attribute:{"aria-expanded":"true","aria-haspopup":"true"},classList:" w-10 h-10 mt-1 text-blue-900 col-span-1 row-span-1 rounded-full  justify-self-center items-center focus:outline-none hover:text-blue-500",subelement:[{tagName:"i",classList:"fad fa-bars text-2xl w-full h-full"},{tagName:"i",classList:"fad fa-times text-2xl w-full h-full hidden"}]},{tagName:"div",id:"menu-pop",attribute:{role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabindex:"-1"},classList:" w-auto h-auto z-10 mx-8 p-2 mt-2 right-0 bg-white hidden origin-top-right absolute  rounded-md shadow-2xl border border-indigo-50 focus:outline-none",subelement:[{tagName:"div",classList:"container mx-auto appearance-none text-blue-900",subelement:[{tagName:"input",id:"radio-category",attribute:{type:"radio",name:"radio-tab"},classList:"hidden",subelement:[]},{tagName:"input",id:"radio-country",attribute:{type:"radio",name:"radio-tab"},classList:"hidden",subelement:[]},{tagName:"input",id:"radio-language",attribute:{type:"radio",name:"radio-tab",checked:""},classList:"hidden",subelement:[]},{tagName:"div",classList:"my-1 nav uppercase text-md font-bold justify-center",subelement:[{tagName:"label",attribute:{for:"radio-language"},subelement:[{tagName:"span",classList:"py-2 px-5 rounded-full inline-block ",innerHtml:"Languages"}]},{tagName:"label",attribute:{for:"radio-country"},subelement:[{tagName:"span",classList:"py-2 px-5 rounded-full inline-block",innerHtml:"Countries"}]},{tagName:"label",attribute:{for:"radio-category"},subelement:[{tagName:"span",classList:"py-2 px-5 rounded-full inline-block",innerHtml:"categories"}]}]},{tagName:"div",id:"tab-category",classList:"p-3 flex-wrap rounded-xl hidden bg-white",subelement:[]},{tagName:"div",id:"tab-country",classList:"p-3 flex-wrap rounded-xl hidden bg-white",subelement:[]},{tagName:"div",id:"tab-language",classList:"p-3 flex-wrap rounded-xl  hidden bg-white",subelement:[]}]}]}]}]}]},{tagName:"div",id:"channel-list",attribute:{disabled:""},classList:" h-max filter  grid grid-cols-1 gap-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6"}]}]},u={tagName:"label",classList:" w-full px-4 text-blue-900 truncate cursor-pointer col-span-5 row-span-1 text-center"},h={tagName:"img",attribute:{},classList:" h-14 w-auto p-2 rounded-md col-span-4 row-span-2 object-fill justify-self-center text-gray-400 text-sm italic"},c={tagName:"div",classList:" mx-3 my-2 h-24 bg-white shadow-lg cursor-pointer font-bold antialiased text-bule-500 text-xl rounded-md appearance-none border border-indigo-50 grid grid-rows-3 grid-cols-5 focus:text-purple-700 focus:outline-none hover:text-purple-700 hover:shadow-lg transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105",subelement:[u,h,{tagName:"i",classList:"fad fa-play-circle text-4xl text-blue-900  "}]},g={tagName:"button",classList:" m-2 px-3 py-1 text-blue-900 text-md font-semibold rounded-full shadow-md antialiased  cursor-pointer border border-indigo-50 hover:bg-gray-100 focus:outline-none"},f=/\s+/g,p=/^https?:\/\/(.*?)\.m3u8?$/;function m(t){return p.test(t)?t.indexOf("https")>-1?t:t.replace("http","https"):null}function v(t){let e={header:{},items:[]},i=t.split(/(?=#EXTINF)/).map((t=>t.trim()));const n=i.shift();if(!n||!/#EXTM3U/.test(n))throw new Error("Playlist is not valid");e.header=function(t){const e=["x-tvg-url"];let i={};for(let n of e){const e=T(t,n);e&&(i["x-tvg-url"]=e)}return{attrs:i,raw:t}}(n);for(let a of i){const t={name:y(a),tvg:{id:T(a,"tvg-id"),name:T(a,"tvg-name"),language:T(a,"tvg-language"),country:T(a,"tvg-country"),logo:T(a,"tvg-logo"),url:T(a,"tvg-url"),rec:T(a,"tvg-rec")},group:{title:b(a)||T(a,"group-title")},http:{referrer:E(a,"http-referrer"),"user-agent":E(a,"http-user-agent")},url:S(a),raw:a};e.items.push(t)}return e}function T(t,e){let i=new RegExp(e+'="(.*?)"',"gi").exec(t);return i&&i[1]?i[1]:""}function y(t){return t.split(/[\r\n]+/).shift().split(",").pop()||""}function E(t,e){let i=new RegExp("#EXTVLCOPT:"+e+"=(.*)","gi").exec(t);return i&&i[1]&&"string"==typeof i[1]?i[1].replace(/\"/g,""):""}function b(t){let e=new RegExp("#EXTGRP:(.*)","gi").exec(t);return e&&e[1]?e[1]:""}function S(t){const e=["#EXTVLCOPT","#EXTINF","#EXTGRP"];return t.split("\n").filter((t=>t)).map((t=>t.trim())).filter((t=>e.every((e=>!t.startsWith(e))))).shift()||""}function A(t,e){document.querySelector(t).innerHTML=e.name,console.log(e)}function L(t,e=888){let i;return function(){const n=this,a=arguments;clearTimeout(i),i=setTimeout((()=>{t.apply(n,a)}),e)}}var w,C,D,R,k,x,O=Object.create,I=Object.defineProperty,_=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty,N=Object.getOwnPropertyNames,P=Object.getOwnPropertyDescriptor,M=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),B=t=>{return((t,e,i)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of N(e))F.call(t,n)||"default"===n||I(t,n,{get:()=>e[n],enumerable:!(i=P(e,n))||i.enumerable});return t})((e=I(null!=t?O(_(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0}),I(e,"__esModule",{value:!0})),t);var e},U=M(((t,e)=>{var i,n,a,r,s,o;i=t,n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,a=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse base URL.");return n.path=o.normalizePath(n.path),o.buildURLFromParts(n)}var r=o.parseURL(e);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=o.normalizePath(r.path),o.buildURLFromParts(r)):e;var s=o.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=a.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var d={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(d.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){var u=s.path,h=u.substring(0,u.lastIndexOf("/")+1)+r.path;d.path=o.normalizePath(h)}else d.path=s.path,r.params||(d.params=s.params,r.query||(d.query=s.query));return null===d.path&&(d.path=i.alwaysNormalize?o.normalizePath(r.path):r.path),o.buildURLFromParts(d)},parseURL:function(t){var e=n.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(r,"");t.length!==(t=t.replace(s,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}},"object"==typeof t&&"object"==typeof e?e.exports=o:"function"==typeof define&&define.amd?define([],(function(){return o})):"object"==typeof t?t.URLToolkit=o:i.URLToolkit=o})),G=M(((t,e)=>{var i=Object.prototype.hasOwnProperty,n="~";function a(){}function r(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,i,a,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new r(i,a||t,s),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new a:delete t._events[e]}function l(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),l.prototype.eventNames=function(){var t,e,a=[];if(0===this._eventsCount)return a;for(e in t=this._events)i.call(t,e)&&a.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(t)):a},l.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,r=i.length,s=new Array(r);a<r;a++)s[a]=i[a].fn;return s},l.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},l.prototype.emit=function(t,e,i,a,r,s){var o=n?n+t:t;if(!this._events[o])return!1;var l,d,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,a),!0;case 5:return u.fn.call(u.context,e,i,a,r),!0;case 6:return u.fn.call(u.context,e,i,a,r,s),!0}for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u.fn.apply(u.context,l)}else{var c,g=u.length;for(d=0;d<g;d++)switch(u[d].once&&this.removeListener(t,u[d].fn,void 0,!0),h){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,e);break;case 3:u[d].fn.call(u[d].context,e,i);break;case 4:u[d].fn.call(u[d].context,e,i,a);break;default:if(!l)for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u[d].fn.apply(u[d].context,l)}}return!0},l.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},l.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},l.prototype.removeListener=function(t,e,i,a){var r=n?n+t:t;if(!this._events[r])return this;if(!e)return o(this,r),this;var s=this._events[r];if(s.fn)s.fn!==e||a&&!s.once||i&&s.context!==i||o(this,r);else{for(var l=0,d=[],u=s.length;l<u;l++)(s[l].fn!==e||a&&!s[l].once||i&&s[l].context!==i)&&d.push(s[l]);d.length?this._events[r]=1===d.length?d[0]:d:o(this,r)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,void 0!==e&&(e.exports=l)})),H=B(U());(C=w||(w={})).MEDIA_ATTACHING="hlsMediaAttaching",C.MEDIA_ATTACHED="hlsMediaAttached",C.MEDIA_DETACHING="hlsMediaDetaching",C.MEDIA_DETACHED="hlsMediaDetached",C.BUFFER_RESET="hlsBufferReset",C.BUFFER_CODECS="hlsBufferCodecs",C.BUFFER_CREATED="hlsBufferCreated",C.BUFFER_APPENDING="hlsBufferAppending",C.BUFFER_APPENDED="hlsBufferAppended",C.BUFFER_EOS="hlsBufferEos",C.BUFFER_FLUSHING="hlsBufferFlushing",C.BUFFER_FLUSHED="hlsBufferFlushed",C.MANIFEST_LOADING="hlsManifestLoading",C.MANIFEST_LOADED="hlsManifestLoaded",C.MANIFEST_PARSED="hlsManifestParsed",C.LEVEL_SWITCHING="hlsLevelSwitching",C.LEVEL_SWITCHED="hlsLevelSwitched",C.LEVEL_LOADING="hlsLevelLoading",C.LEVEL_LOADED="hlsLevelLoaded",C.LEVEL_UPDATED="hlsLevelUpdated",C.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",C.LEVELS_UPDATED="hlsLevelsUpdated",C.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",C.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",C.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",C.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",C.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",C.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",C.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",C.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",C.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",C.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",C.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",C.CUES_PARSED="hlsCuesParsed",C.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",C.INIT_PTS_FOUND="hlsInitPtsFound",C.FRAG_LOADING="hlsFragLoading",C.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",C.FRAG_LOADED="hlsFragLoaded",C.FRAG_DECRYPTED="hlsFragDecrypted",C.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",C.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",C.FRAG_PARSING_METADATA="hlsFragParsingMetadata",C.FRAG_PARSED="hlsFragParsed",C.FRAG_BUFFERED="hlsFragBuffered",C.FRAG_CHANGED="hlsFragChanged",C.FPS_DROP="hlsFpsDrop",C.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",C.ERROR="hlsError",C.DESTROYING="hlsDestroying",C.KEY_LOADING="hlsKeyLoading",C.KEY_LOADED="hlsKeyLoaded",C.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",C.BACK_BUFFER_REACHED="hlsBackBufferReached",(R=D||(D={})).NETWORK_ERROR="networkError",R.MEDIA_ERROR="mediaError",R.KEY_SYSTEM_ERROR="keySystemError",R.MUX_ERROR="muxError",R.OTHER_ERROR="otherError",(x=k||(k={})).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",x.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",x.KEY_SYSTEM_NO_SESSION="keySystemNoSession",x.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",x.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",x.MANIFEST_LOAD_ERROR="manifestLoadError",x.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",x.MANIFEST_PARSING_ERROR="manifestParsingError",x.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",x.LEVEL_EMPTY_ERROR="levelEmptyError",x.LEVEL_LOAD_ERROR="levelLoadError",x.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",x.LEVEL_SWITCH_ERROR="levelSwitchError",x.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",x.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",x.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",x.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",x.FRAG_LOAD_ERROR="fragLoadError",x.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",x.FRAG_DECRYPT_ERROR="fragDecryptError",x.FRAG_PARSING_ERROR="fragParsingError",x.REMUX_ALLOC_ERROR="remuxAllocError",x.KEY_LOAD_ERROR="keyLoadError",x.KEY_LOAD_TIMEOUT="keyLoadTimeOut",x.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",x.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",x.BUFFER_APPEND_ERROR="bufferAppendError",x.BUFFER_APPENDING_ERROR="bufferAppendingError",x.BUFFER_STALLED_ERROR="bufferStalledError",x.BUFFER_FULL_ERROR="bufferFullError",x.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",x.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",x.INTERNAL_EXCEPTION="internalException",x.INTERNAL_ABORTED="aborted",x.UNKNOWN="unknown";var V=function(){},K={trace:V,debug:V,log:V,warn:V,info:V,error:V},j=K;function X(t,...e){e.forEach((function(e){j[e]=t[e]?t[e].bind(t):function(t){const e=self.console[t];return e?e.bind(self.console,`[${t}] >`):V}(e)}))}var W=j;function Y(t,e,i){return Uint8Array.prototype.slice?t.slice(e,i):new Uint8Array(Array.prototype.slice.call(t,e,i))}var J,z,q=B(U()),$=B(U()),Z=class{constructor(t,e){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=e?(0,$.buildAbsoluteURL)(t,e,{alwaysNormalize:!0}):t}static fromURL(t,e){return new Z(t,e)}static fromURI(t){return new Z(t)}get uri(){return this._uri}},Q=class{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}};(z=J||(J={})).AUDIO="audio",z.VIDEO="video",z.AUDIOVIDEO="audiovideo";var tt=class{constructor(t){this._byteRange=null,this._url=null,this.elementaryStreams={[J.AUDIO]:null,[J.VIDEO]:null,[J.AUDIOVIDEO]:null},this.baseurl=t}setByteRange(t,e){const i=t.split("@",2),n=[];1===i.length?n[0]=e?e.byteRangeEndOffset:0:n[0]=parseInt(i[1]),n[1]=parseInt(i[0])+n[0],this._byteRange=n}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,q.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}},et=class extends tt{constructor(t,e){super(e),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.loader=null,this.level=-1,this.cc=0,this.start=0,this.stats=new Q,this.urlId=0,this.bitrateTest=!1,this.title=null,this.type=t}get decryptdata(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){let t=this.sn;"number"!=typeof t&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&W.warn(`missing IV for initialization segment with method="${this.levelkey.method}" - compliance issue`),t=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!Number.isFinite(this.programDateTime))return null;const t=Number.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;return!(!(null==(t=this.decryptdata)?void 0:t.keyFormat)||!this.decryptdata.uri)}createInitializationVector(t){const e=new Uint8Array(16);for(let i=12;i<16;i++)e[i]=t>>8*(15-i)&255;return e}setDecryptDataFromLevelKey(t,e){let i=t;return"AES-128"===(null==t?void 0:t.method)&&t.uri&&!t.iv&&(i=Z.fromURI(t.uri),i.method=t.method,i.iv=this.createInitializationVector(e),i.keyFormat="identity"),i}setElementaryStreamInfo(t,e,i,n,a,r=!1){const{elementaryStreams:s}=this,o=s[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,n),o.endDTS=Math.max(o.endDTS,a)):s[t]={startPTS:e,endPTS:i,startDTS:n,endDTS:a,partial:r}}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[J.AUDIO]=null,t[J.VIDEO]=null,t[J.AUDIOVIDEO]=null}},it=class extends tt{constructor(t,e,i,n,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.stats=new Q,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=n;const r=t.enumeratedString("BYTERANGE");r&&this.setByteRange(r,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}},nt=Math.pow(2,32)-1,at=[].push;function rt(t){return String.fromCharCode.apply(null,t)}function st(t,e){"data"in t&&(e+=t.start,t=t.data);const i=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return i<0?4294967296+i:i}function ot(t,e,i){"data"in t&&(e+=t.start,t=t.data),t[e]=i>>24,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i}function lt(t,e){const i=[];if(!e.length)return i;let n,a,r;"data"in t?(n=t.data,a=t.start,r=t.end):(n=t,a=0,r=n.byteLength);for(let s=a;s<r;){const t=st(n,s),a=t>1?s+t:r;if(rt(n.subarray(s+4,s+8))===e[0])if(1===e.length)i.push({data:n,start:s+8,end:a});else{const t=lt({data:n,start:s+8,end:a},e.slice(1));t.length&&at.apply(i,t)}s=a}return i}function dt(t){const e=lt(t,["moov"])[0],i=e?e.end:null,n=lt(t,["sidx"]);if(!n||!n[0])return null;const a=[],r=n[0],s=r.data[0];let o=0===s?8:16;const l=st(r,o);o+=4;o+=0===s?8:16,o+=2;let d=r.end+0;const u=function(t,e){"data"in t&&(e+=t.start,t=t.data);const i=t[e]<<8|t[e+1];return i<0?65536+i:i}(r,o);o+=2;for(let h=0;h<u;h++){let t=o;const e=st(r,t);t+=4;const i=2147483647&e;if(1===(2147483648&e)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;const n=st(r,t);t+=4,a.push({referenceSize:i,subsegmentDuration:n,info:{duration:n/l,start:d,end:d+i-1}}),d+=i,t+=4,o=t}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:u,references:a,moovEndOffset:i}}function ut(t){const e=st(t,0);let i=8;1&e&&(i+=4),4&e&&(i+=4);let n=0;const a=st(t,4);for(let r=0;r<a;r++){if(256&e){n+=st(t,i),i+=4}512&e&&(i+=4),1024&e&&(i+=4),2048&e&&(i+=4)}return n}function ht(t,e){const i=new Uint8Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}var ct=B(U()),gt=/^(\d+)x(\d+)$/,ft=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,pt=class{constructor(t){"string"==typeof t&&(t=pt.parseAttrList(t));for(const e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const i=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)i[t]=parseInt(e.slice(2*t,2*t+2),16);return i}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}bool(t){return"YES"===this[t]}decimalResolution(t){const e=gt.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t){let e;const i={};for(ft.lastIndex=0;null!==(e=ft.exec(t));){let t=e[2];0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),i[e[1]]=t}return i}},mt={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function vt(t,e){return MediaSource.isTypeSupported(`${e||"video"}/mp4;codecs="${t}"`)}var Tt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,yt=/#EXT-X-MEDIA:(.*)/g,Et=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),bt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),St=/\.(mp4|m4s|m4v|m4a)$/i;var At,Lt,wt,Ct,Dt=class{static findGroup(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(n.id===e)return n}}static convertAVC1ToAVCOTI(t){const e=t.split(".");if(e.length>2){let t=e.shift()+".";return t+=parseInt(e.shift()).toString(16),t+=("000"+parseInt(e.shift()).toString(16)).substr(-4),t}return t}static resolve(t,e){return ct.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static parseMasterPlaylist(t,e){const i=[],n={};let a,r=!1;for(Tt.lastIndex=0;null!=(a=Tt.exec(t));)if(a[1]){const t=new pt(a[1]),n={attrs:t,bitrate:t.decimalInteger("AVERAGE-BANDWIDTH")||t.decimalInteger("BANDWIDTH"),name:t.NAME,url:Dt.resolve(a[2],e)},r=t.decimalResolution("RESOLUTION");r&&(n.width=r.width,n.height=r.height),kt((t.CODECS||"").split(/[ ,]+/).filter((t=>t)),n),n.videoCodec&&-1!==n.videoCodec.indexOf("avc1")&&(n.videoCodec=Dt.convertAVC1ToAVCOTI(n.videoCodec)),i.push(n)}else if(a[3]){const t=new pt(a[3]);t["DATA-ID"]&&(r=!0,n[t["DATA-ID"]]=t)}return{levels:i,sessionData:r?n:null}}static parseMasterPlaylistMedia(t,e,i,n=[]){let a;const r=[];let s=0;for(yt.lastIndex=0;null!==(a=yt.exec(t));){const t=new pt(a[1]);if(t.TYPE===i){const a={attrs:t,bitrate:0,id:s++,groupId:t["GROUP-ID"],instreamId:t["INSTREAM-ID"],name:t.NAME||t.LANGUAGE||"",type:i,default:t.bool("DEFAULT"),autoselect:t.bool("AUTOSELECT"),forced:t.bool("FORCED"),lang:t.LANGUAGE,url:t.URI?Dt.resolve(t.URI,e):""};if(n.length){const t=Dt.findGroup(n,a.groupId)||n[0];xt(a,t,"audioCodec"),xt(a,t,"textCodec")}r.push(a)}}return r}static parseLevelPlaylist(t,e,i,n,a){var r;const s=new class{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.endCC=0,this.endSN=0,this.partList=null,this.initSegment=null,this.live=!0,this.ageHeader=0,this.updated=!0,this.advanced=!0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.tuneInGoal=0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e,this.advanced=this.endSN>t.endSN||e>0||0===e&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&Number.isFinite(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?1e3*(this.driftEnd-this.driftStart)/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(null==(t=this.partList)?void 0:t.length)?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(null==(t=this.fragments)?void 0:t.length)?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(null==(t=this.partList)?void 0:t.length)?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return(null==(t=this.partList)?void 0:t.length)?this.partList[this.partList.length-1].fragment.sn:this.endSN}}(e),o=s.fragments;let l,d,u,h=0,c=0,g=0,f=0,p=null,m=new et(n,e),v=-1;for(Et.lastIndex=0,s.m3u8=t;null!==(l=Et.exec(t));){const t=l[1];if(t){m.duration=parseFloat(t);const e=(" "+l[2]).slice(1);m.title=e||null,m.tagList.push(e?["INF",t,e]:["INF",t])}else if(l[3])Number.isFinite(m.duration)&&(m.start=g,u&&(m.levelkey=u),m.sn=h,m.level=i,m.cc=f,m.urlId=a,o.push(m),m.relurl=(" "+l[3]).slice(1),Ot(m,p),p=m,g+=m.duration,h++,c=0,m=new et(n,e),m.start=g,m.sn=h,m.cc=f,m.level=i);else if(l[4]){const t=(" "+l[4]).slice(1);p?m.setByteRange(t,p):m.setByteRange(t)}else if(l[5])m.rawProgramDateTime=(" "+l[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),-1===v&&(v=o.length);else{if(l=l[0].match(bt),!l){W.warn("No matches on slow regex match for level playlist!");continue}for(d=1;d<l.length&&void 0===l[d];d++);const t=(" "+l[d]).slice(1),a=(" "+l[d+1]).slice(1),g=l[d+2]?(" "+l[d+2]).slice(1):"";switch(t){case"PLAYLIST-TYPE":s.type=a.toUpperCase();break;case"MEDIA-SEQUENCE":h=s.startSN=parseInt(a);break;case"SKIP":{const t=new pt(a),e=t.decimalInteger("SKIPPED-SEGMENTS");if(Number.isFinite(e)){s.skippedSegments=e;for(let t=e;t--;)o.unshift(null);h+=e}const i=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(s.recentlyRemovedDateranges=i.split("\t"));break}case"TARGETDURATION":s.targetduration=parseFloat(a);break;case"VERSION":s.version=parseInt(a);break;case"EXTM3U":break;case"ENDLIST":s.live=!1;break;case"#":(a||g)&&m.tagList.push(g?[a,g]:[a]);break;case"DIS":f++;case"GAP":m.tagList.push([t]);break;case"BITRATE":m.tagList.push([t,a]);break;case"DISCONTINUITY-SEQ":f=parseInt(a);break;case"KEY":{const t=new pt(a),i=t.enumeratedString("METHOD"),n=t.URI,s=t.hexadecimalInteger("IV"),o=t.enumeratedString("KEYFORMATVERSIONS"),l=t.enumeratedString("KEYID"),d=null!=(r=t.enumeratedString("KEYFORMAT"))?r:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(d)>-1){W.warn(`Keyformat ${d} is not supported from the manifest`);continue}if("identity"!==d)continue;i&&(u=Z.fromURL(e,n),n&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(i)>=0&&(u.method=i,u.keyFormat=d,l&&(u.keyID=l),o&&(u.keyFormatVersions=o),u.iv=s));break}case"START":{const t=new pt(a).decimalFloatingPoint("TIME-OFFSET");Number.isFinite(t)&&(s.startTimeOffset=t);break}case"MAP":{const t=new pt(a);m.relurl=t.URI,t.BYTERANGE&&m.setByteRange(t.BYTERANGE),m.level=i,m.sn="initSegment",u&&(m.levelkey=u),s.initSegment=m,m=new et(n,e),m.rawProgramDateTime=s.initSegment.rawProgramDateTime;break}case"SERVER-CONTROL":{const t=new pt(a);s.canBlockReload=t.bool("CAN-BLOCK-RELOAD"),s.canSkipUntil=t.optionalFloat("CAN-SKIP-UNTIL",0),s.canSkipDateRanges=s.canSkipUntil>0&&t.bool("CAN-SKIP-DATERANGES"),s.partHoldBack=t.optionalFloat("PART-HOLD-BACK",0),s.holdBack=t.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const t=new pt(a);s.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let t=s.partList;t||(t=s.partList=[]);const i=c>0?t[t.length-1]:void 0,n=c++,r=new it(new pt(a),m,e,n,i);t.push(r),m.duration+=r.duration;break}case"PRELOAD-HINT":{const t=new pt(a);s.preloadHint=t;break}case"RENDITION-REPORT":{const t=new pt(a);s.renditionReports=s.renditionReports||[],s.renditionReports.push(t);break}default:W.warn(`line parsed but not handled: ${l}`)}}}p&&!p.relurl?(o.pop(),g-=p.duration,s.partList&&(s.fragmentHint=p)):s.partList&&(Ot(m,p),m.cc=f,s.fragmentHint=m);const T=o.length,y=o[0],E=o[T-1];if(g+=s.skippedSegments*s.targetduration,g>0&&T&&E){s.averagetargetduration=g/T;const t=E.sn;s.endSN="initSegment"!==t?t:0,y&&(s.startCC=y.cc,s.initSegment||s.fragments.every((t=>t.relurl&&function(t){var e,i;return St.test(null!=(i=null==(e=ct.parseURL(t))?void 0:e.path)?i:"")}(t.relurl)))&&(W.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),m=new et(n,e),m.relurl=E.relurl,m.level=i,m.sn="initSegment",s.initSegment=m,s.needSidxRanges=!0))}else s.endSN=0,s.startCC=0;return s.fragmentHint&&(g+=s.fragmentHint.duration),s.totalduration=g,s.endCC=f,v>0&&function(t,e){let i=t[e];for(let n=e;n--;){const e=t[n];if(!e)return;e.programDateTime=i.programDateTime-1e3*e.duration,i=e}}(o,v),s}},Rt=Dt;function kt(t,e){["video","audio","text"].forEach((i=>{const n=t.filter((t=>function(t,e){const i=mt[e];return!!i&&!0===i[t.slice(0,4)]}(t,i)));if(n.length){const a=n.filter((t=>0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)));e[`${i}Codec`]=a.length>0?a[0]:n[0],t=t.filter((t=>-1===n.indexOf(t)))}})),e.unknownCodecs=t}function xt(t,e,i){const n=e[i];n&&(t[i]=n)}function Ot(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):(null==e?void 0:e.programDateTime)&&(t.programDateTime=e.endProgramDateTime),Number.isFinite(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}function It(t,e){let i=t.url;return void 0!==i&&0!==i.indexOf("data:")||(i=e.url),i}(Lt=At||(At={})).MANIFEST="manifest",Lt.LEVEL="level",Lt.AUDIO_TRACK="audioTrack",Lt.SUBTITLE_TRACK="subtitleTrack",(Ct=wt||(wt={})).MAIN="main",Ct.AUDIO="audio",Ct.SUBTITLE="subtitle";var _t=class{constructor(t){this.loaders=Object.create(null),this.hls=t,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(w.MANIFEST_LOADING,this.onManifestLoading,this),t.on(w.LEVEL_LOADING,this.onLevelLoading,this),t.on(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(w.MANIFEST_LOADING,this.onManifestLoading,this),t.off(w.LEVEL_LOADING,this.onLevelLoading,this),t.off(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const e=this.hls.config,i=e.pLoader,n=e.loader,a=new(i||n)(e);return t.loader=a,this.loaders[t.type]=a,a}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:i}=e;this.load({id:null,groupId:null,level:0,responseType:"text",type:At.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(t,e){const{id:i,level:n,url:a,deliveryDirectives:r}=e;this.load({id:i,groupId:null,level:n,responseType:"text",type:At.LEVEL,url:a,deliveryDirectives:r})}onAudioTrackLoading(t,e){const{id:i,groupId:n,url:a,deliveryDirectives:r}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:At.AUDIO_TRACK,url:a,deliveryDirectives:r})}onSubtitleTrackLoading(t,e){const{id:i,groupId:n,url:a,deliveryDirectives:r}=e;this.load({id:i,groupId:n,level:null,responseType:"text",type:At.SUBTITLE_TRACK,url:a,deliveryDirectives:r})}load(t){var e;const i=this.hls.config;let n,a,r,s,o=this.getInternalLoader(t);if(o){const e=o.context;if(e&&e.url===t.url)return void W.trace("[playlist-loader]: playlist request ongoing");W.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),o.abort()}switch(t.type){case At.MANIFEST:n=i.manifestLoadingMaxRetry,a=i.manifestLoadingTimeOut,r=i.manifestLoadingRetryDelay,s=i.manifestLoadingMaxRetryTimeout;break;case At.LEVEL:case At.AUDIO_TRACK:case At.SUBTITLE_TRACK:n=0,a=i.levelLoadingTimeOut;break;default:n=i.levelLoadingMaxRetry,a=i.levelLoadingTimeOut,r=i.levelLoadingRetryDelay,s=i.levelLoadingMaxRetryTimeout}if(o=this.createInternalLoader(t),null==(e=t.deliveryDirectives)?void 0:e.part){let e;if(t.type===At.LEVEL&&null!==t.level?e=this.hls.levels[t.level].details:t.type===At.AUDIO_TRACK&&null!==t.id?e=this.hls.audioTracks[t.id].details:t.type===At.SUBTITLE_TRACK&&null!==t.id&&(e=this.hls.subtitleTracks[t.id].details),e){const t=e.partTarget,i=e.targetduration;t&&i&&(a=Math.min(1e3*Math.max(3*t,.8*i),a))}}const l={timeout:a,maxRetry:n,retryDelay:r,maxRetryDelay:s,highWaterMark:0},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o.load(t,l,d)}loadsuccess(t,e,i,n=null){if(i.isSidxRequest)return this.handleSidxRequest(t,i),void this.handlePlaylistLoaded(t,e,i,n);this.resetInternalLoader(i.type);const a=t.data;0===a.indexOf("#EXTM3U")?(e.parsing.start=performance.now(),a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,e,i,n):this.handleMasterPlaylist(t,e,i,n)):this.handleManifestParsingError(t,i,"no EXTM3U delimiter",n)}loaderror(t,e,i=null){this.handleNetworkError(e,i,!1,t)}loadtimeout(t,e,i=null){this.handleNetworkError(e,i,!0)}handleMasterPlaylist(t,e,i,n){const a=this.hls,r=t.data,s=It(t,i),{levels:o,sessionData:l}=Rt.parseMasterPlaylist(r,s);if(!o.length)return void this.handleManifestParsingError(t,i,"no level found in manifest",n);const d=o.map((t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec}))),u=o.map((t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec}))),h=Rt.parseMasterPlaylistMedia(r,s,"AUDIO",d),c=Rt.parseMasterPlaylistMedia(r,s,"SUBTITLES",u),g=Rt.parseMasterPlaylistMedia(r,s,"CLOSED-CAPTIONS");if(h.length){h.some((t=>!t.url))||!o[0].audioCodec||o[0].attrs.AUDIO||(W.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new pt({}),bitrate:0,url:""}))}a.trigger(w.MANIFEST_LOADED,{levels:o,audioTracks:h,subtitles:c,captions:g,url:s,stats:e,networkDetails:n,sessionData:l})}handleTrackOrLevelPlaylist(t,e,i,n){const a=this.hls,{id:r,level:s,type:o}=i,l=It(t,i),d=Number.isFinite(r)?r:0,u=Number.isFinite(s)?s:d,h=function(t){const{type:e}=t;switch(e){case At.AUDIO_TRACK:return wt.AUDIO;case At.SUBTITLE_TRACK:return wt.SUBTITLE;default:return wt.MAIN}}(i),c=Rt.parseLevelPlaylist(t.data,l,u,h,d);if(c.fragments.length){if(o===At.MANIFEST){const t={attrs:new pt({}),bitrate:0,details:c,name:"",url:l};a.trigger(w.MANIFEST_LOADED,{levels:[t],audioTracks:[],url:l,stats:e,networkDetails:n,sessionData:null})}if(e.parsing.end=performance.now(),c.needSidxRanges){const t=c.initSegment.url;this.load({url:t,isSidxRequest:!0,type:o,level:s,levelDetails:c,id:r,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else i.levelDetails=c,this.handlePlaylistLoaded(t,e,i,n)}else a.trigger(w.ERROR,{type:D.NETWORK_ERROR,details:k.LEVEL_EMPTY_ERROR,fatal:!1,url:l,reason:"no fragments found in level",level:"number"==typeof i.level?i.level:void 0})}handleSidxRequest(t,e){const i=dt(new Uint8Array(t.data));if(!i)return;const n=i.references,a=e.levelDetails;n.forEach(((t,e)=>{const i=t.info,n=a.fragments[e];0===n.byteRange.length&&n.setByteRange(String(1+i.end-i.start)+"@"+String(i.start))})),a.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}handleManifestParsingError(t,e,i,n){this.hls.trigger(w.ERROR,{type:D.NETWORK_ERROR,details:k.MANIFEST_PARSING_ERROR,fatal:e.type===At.MANIFEST,url:t.url,reason:i,response:t,context:e,networkDetails:n})}handleNetworkError(t,e,i=!1,n){W.warn(`[playlist-loader]: A network ${i?"timeout":"error"} occurred while loading ${t.type} level: ${t.level} id: ${t.id} group-id: "${t.groupId}"`);let a=k.UNKNOWN,r=!1;const s=this.getInternalLoader(t);switch(t.type){case At.MANIFEST:a=i?k.MANIFEST_LOAD_TIMEOUT:k.MANIFEST_LOAD_ERROR,r=!0;break;case At.LEVEL:a=i?k.LEVEL_LOAD_TIMEOUT:k.LEVEL_LOAD_ERROR,r=!1;break;case At.AUDIO_TRACK:a=i?k.AUDIO_TRACK_LOAD_TIMEOUT:k.AUDIO_TRACK_LOAD_ERROR,r=!1;break;case At.SUBTITLE_TRACK:a=i?k.SUBTITLE_TRACK_LOAD_TIMEOUT:k.SUBTITLE_LOAD_ERROR,r=!1}s&&this.resetInternalLoader(t.type);const o={type:D.NETWORK_ERROR,details:a,fatal:r,url:t.url,loader:s,context:t,networkDetails:e};n&&(o.response=n),this.hls.trigger(w.ERROR,o)}handlePlaylistLoaded(t,e,i,n){const{type:a,level:r,id:s,groupId:o,loader:l,levelDetails:d,deliveryDirectives:u}=i;if(null==d?void 0:d.targetduration){if(l)switch(d.live&&(l.getCacheAge&&(d.ageHeader=l.getCacheAge()||0),l.getCacheAge&&!isNaN(d.ageHeader)||(d.ageHeader=0)),a){case At.MANIFEST:case At.LEVEL:this.hls.trigger(w.LEVEL_LOADED,{details:d,level:r||0,id:s||0,stats:e,networkDetails:n,deliveryDirectives:u});break;case At.AUDIO_TRACK:this.hls.trigger(w.AUDIO_TRACK_LOADED,{details:d,id:s||0,groupId:o||"",stats:e,networkDetails:n,deliveryDirectives:u});break;case At.SUBTITLE_TRACK:this.hls.trigger(w.SUBTITLE_TRACK_LOADED,{details:d,id:s||0,groupId:o||"",stats:e,networkDetails:n,deliveryDirectives:u})}}else this.handleManifestParsingError(t,i,"invalid target duration",n)}},Ft=class{constructor(t){this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=t,this._registerListeners()}_registerListeners(){this.hls.on(w.KEY_LOADING,this.onKeyLoading,this)}_unregisterListeners(){this.hls.off(w.KEY_LOADING,this.onKeyLoading)}destroy(){this._unregisterListeners();for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy()}this.loaders={}}onKeyLoading(t,e){const{frag:i}=e,n=i.type,a=this.loaders[n];if(!i.decryptdata)return void W.warn("Missing decryption data on fragment in onKeyLoading");const r=i.decryptdata.uri;if(r!==this.decrypturl||null===this.decryptkey){const t=this.hls.config;if(a&&(W.warn(`abort previous key loader for type:${n}`),a.abort()),!r)return void W.warn("key uri is falsy");const e=t.loader,s=i.loader=this.loaders[n]=new e(t);this.decrypturl=r,this.decryptkey=null;const o={url:r,frag:i,responseType:"arraybuffer"},l={timeout:t.fragLoadingTimeOut,maxRetry:0,retryDelay:t.fragLoadingRetryDelay,maxRetryDelay:t.fragLoadingMaxRetryTimeout,highWaterMark:0},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.load(o,l,d)}else this.decryptkey&&(i.decryptdata.key=this.decryptkey,this.hls.trigger(w.KEY_LOADED,{frag:i}))}loadsuccess(t,e,i){const n=i.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(t.data),n.loader=null,delete this.loaders[n.type],this.hls.trigger(w.KEY_LOADED,{frag:n})):W.error("after key load, decryptdata unset")}loaderror(t,e){const i=e.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(w.ERROR,{type:D.NETWORK_ERROR,details:k.KEY_LOAD_ERROR,fatal:!1,frag:i,response:t})}loadtimeout(t,e){const i=e.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(w.ERROR,{type:D.NETWORK_ERROR,details:k.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})}};function Nt(t,e){let i;try{i=new Event("addtrack")}catch(n){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=t,e.dispatchEvent(i)}function Pt(t,e,i){const n=t.mode;if("disabled"===n&&(t.mode="hidden"),!t.cues||!t.cues.length)return;const a=function(t,e,i){const n=[],a=function(t,e){if(e<t[0].startTime)return 0;const i=t.length-1;if(e>t[i].endTime)return-1;let n=0,a=i;for(;n<=a;){const r=Math.floor((a+n)/2);if(e<t[r].startTime)a=r-1;else{if(!(e>t[r].startTime&&n<i))return r;n=r+1}}return t[n].startTime-e<e-t[a].startTime?n:a}(t,e);if(a>-1)for(let r=a,s=t.length;r<s;r++){const a=t[r];if(a.startTime>=e&&a.endTime<=i)n.push(a);else if(a.startTime>i)return n}return n}(t.cues,e,i);for(let r=0;r<a.length;r++)t.removeCue(a[r]);"disabled"===n&&(t.mode=n)}var Mt,Bt=(t,e)=>e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,Ut=(t,e)=>e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,Gt=(t,e)=>{const i=e;let n=0;for(;Bt(t,e);){n+=10;n+=Ht(t,e+6),Ut(t,e+10)&&(n+=10),e+=n}if(n>0)return t.subarray(i,i+n)},Ht=(t,e)=>{let i=0;return i=(127&t[e])<<21,i|=(127&t[e+1])<<14,i|=(127&t[e+2])<<7,i|=127&t[e+3],i},Vt=(t,e)=>Bt(t,e)&&Ht(t,e+6)+10<=t.length-e,Kt=t=>t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info,jt=t=>{const e=String.fromCharCode(t[0],t[1],t[2],t[3]),i=Ht(t,4);return{type:e,size:i,data:t.subarray(10,10+i)}},Xt=t=>{let e=0;const i=[];for(;Bt(t,e);){const n=Ht(t,e+6);e+=10;const a=e+n;for(;e+8<a;){const n=jt(t.subarray(e)),a=Wt(n);a&&i.push(a),e+=n.size+10}Ut(t,e)&&(e+=10)}return i},Wt=t=>"PRIV"===t.type?Yt(t):"W"===t.type[0]?zt(t):Jt(t),Yt=t=>{if(t.size<2)return;const e=$t(t.data,!0),i=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:i.buffer}},Jt=t=>{if(t.size<2)return;if("TXXX"===t.type){let e=1;const i=$t(t.data.subarray(e),!0);e+=i.length+1;const n=$t(t.data.subarray(e));return{key:t.type,info:i,data:n}}const e=$t(t.data.subarray(1));return{key:t.type,data:e}},zt=t=>{if("WXXX"===t.type){if(t.size<2)return;let e=1;const i=$t(t.data.subarray(e),!0);e+=i.length+1;const n=$t(t.data.subarray(e));return{key:t.type,info:i,data:n}}const e=$t(t.data);return{key:t.type,data:e}},qt=t=>{if(8===t.data.byteLength){const e=new Uint8Array(t.data),i=1&e[3];let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},$t=(t,e=!1)=>{const i=function(){Mt||void 0===self.TextDecoder||(Mt=new self.TextDecoder("utf-8"));return Mt}();if(i){const n=i.decode(t);if(e){const t=n.indexOf("\0");return-1!==t?n.substring(0,t):n}return n.replace(/\0/g,"")}const n=t.length;let a,r,s,o="",l=0;for(;l<n;){if(a=t[l++],0===a&&e)return o;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(a);break;case 12:case 13:r=t[l++],o+=String.fromCharCode((31&a)<<6|63&r);break;case 14:r=t[l++],s=t[l++],o+=String.fromCharCode((15&a)<<12|(63&r)<<6|(63&s)<<0)}}return o};var Zt,Qt,te=class{constructor(t){this.id3Track=null,this.media=null,this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners()}_registerListeners(){const{hls:t}=this;t.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}_unregisterListeners(){const{hls:t}=this;t.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}onMediaAttached(t,e){this.media=e.media}onMediaDetaching(){this.id3Track&&(!function(t){const e=t.mode;if("disabled"===e&&(t.mode="hidden"),t.cues){for(let e=t.cues.length;e--;)t.removeCue(t.cues[e]);"disabled"===e&&(t.mode=e)}}(this.id3Track),this.id3Track=null,this.media=null)}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const i=t[e];if("metadata"===i.kind&&"id3"===i.label)return Nt(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media)return;const i=e.frag,n=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");const a=self.WebKitDataCue||self.VTTCue||self.TextTrackCue;for(let r=0;r<n.length;r++){const t=Xt(n[r].data);if(t){const e=n[r].pts;let s=r<n.length-1?n[r+1].pts:i.end;s-e<=0&&(s=e+.25);for(let i=0;i<t.length;i++){const n=t[i];if(!Kt(n)){const t=new a(e,s,"");t.value=n,this.id3Track.addCue(t)}}}}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:n}){if(!n||"audio"===n){const{id3Track:t}=this;t&&Pt(t,e,i)}}},ee=class{constructor(t){this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:e}=this;return void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(null===t)return null;const{holdBack:e,partHoldBack:i,targetduration:n}=t,{liveSyncDuration:a,liveSyncDurationCount:r,lowLatencyMode:s}=this.config,o=this.hls.userConfig;let l=s&&i||e;(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==a?a:r*n);const d=n;return l+Math.min(1*this.stallCount,d)}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency,i=this.levelDetails;if(null===t||null===e||null===i)return null;const n=i.edge,a=t-e-this.edgeStalled,r=n-i.totalduration,s=n-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(r,a),s)}get drift(){const{levelDetails:t}=this;return null===t?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(null===t)return 0;const e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t,levelDetails:e}=this;if(!t||!e)return 0;const i=t.buffered.length;return i?t.buffered.end(i-1):e.edge-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(w.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(w.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(w.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(w.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(w.ERROR,this.onError)}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){this.levelDetails=e,e.advanced&&this.timeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,e){e.details===k.BUFFER_STALLED_ERROR&&(this.stallCount++,W.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:e}=this;if(!t||!e)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:n,maxLiveSyncPlaybackRate:a}=this.config;if(!n||1===a)return;const r=this.targetLatency;if(null===r)return;const s=i-r,o=s<Math.min(this.maxLatency,r+e.targetduration);if(e.live&&o&&s>.05&&this.forwardBufferLength>1){const e=Math.min(2,Math.max(1,a)),i=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;t.playbackRate=Math.min(e,Math.max(1,i))}else 1!==t.playbackRate&&0!==t.playbackRate&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}};(Qt=Zt||(Zt={})).No="",Qt.Yes="YES",Qt.v2="v2";var ie=class{constructor(t,e,i){this.msn=t,this.part=e,this.skip=i}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.toString()}};function ne(t,e,i){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds.push(i);break;case"text":t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds.push(i)}}function ae(t){const e={};t.forEach((t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++}))}function re(t,e){const i=e.startPTS;if(Number.isFinite(i)){let n,a=0;e.sn>t.sn?(a=i-t.start,n=t):(a=t.start-i,n=e),n.duration!==a&&(n.duration=a)}else if(e.sn>t.sn){t.cc===e.cc&&t.minEndPTS?e.start=t.start+(t.minEndPTS-t.start):e.start=t.start+t.duration}else e.start=Math.max(t.start-e.duration,0)}function se(t,e,i,n,a,r){n-i<=0&&(W.warn("Fragment should have a positive duration",e),n=i+e.duration,r=a+e.duration);let s=i,o=n;const l=e.startPTS,d=e.endPTS;if(Number.isFinite(l)){const t=Math.abs(l-i);Number.isFinite(e.deltaPTS)?e.deltaPTS=Math.max(t,e.deltaPTS):e.deltaPTS=t,s=Math.max(i,l),i=Math.min(i,l),a=Math.min(a,e.startDTS),o=Math.min(n,d),n=Math.max(n,d),r=Math.max(r,e.endDTS)}e.duration=n-i;const u=i-e.start;e.appendedPTS=n,e.start=e.startPTS=i,e.maxStartPTS=s,e.startDTS=a,e.endPTS=n,e.minEndPTS=o,e.endDTS=r;const h=e.sn;if(!t||h<t.startSN||h>t.endSN)return 0;let c;const g=h-t.startSN,f=t.fragments;for(f[g]=e,c=g;c>0;c--)re(f[c],f[c-1]);for(c=g;c<f.length-1;c++)re(f[c],f[c+1]);return t.fragmentHint&&re(f[f.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,u}function oe(t,e){e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment),t.fragmentHint&&delete t.fragmentHint.endPTS;let i,n=0;if(function(t,e,i){const n=e.skippedSegments,a=Math.max(t.startSN,e.startSN)-e.startSN,r=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,s=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let d=a;d<=r;d++){const t=l[s+d];let a=o[d];n&&!a&&d<n&&(a=e.fragments[d]=t),t&&a&&i(t,a)}}(t,e,((t,a)=>{t.relurl&&(n=t.cc-a.cc),Number.isFinite(t.startPTS)&&Number.isFinite(t.endPTS)&&(a.start=a.startPTS=t.startPTS,a.startDTS=t.startDTS,a.appendedPTS=t.appendedPTS,a.maxStartPTS=t.maxStartPTS,a.endPTS=t.endPTS,a.endDTS=t.endDTS,a.minEndPTS=t.minEndPTS,a.duration=t.endPTS-t.startPTS,a.duration&&(i=a),e.PTSKnown=e.alignedSliding=!0),a.elementaryStreams=t.elementaryStreams,a.loader=t.loader,a.stats=t.stats,a.urlId=t.urlId})),e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some((t=>!t)),e.deltaUpdateFailed)){W.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=e.skippedSegments;t--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}const a=e.fragments;if(n){W.warn("discontinuity sliding from playlist, take drift into account");for(let t=0;t<a.length;t++)a[t].cc+=n}e.skippedSegments&&(e.initSegment||(e.initSegment=t.initSegment),e.startCC=e.fragments[0].cc),function(t,e,i){if(t&&e){let n=0;for(let a=0,r=t.length;a<=r;a++){const r=t[a],s=e[a+n];r&&s&&r.index===s.index&&r.fragment.sn===s.fragment.sn?i(r,s):n--}}}(t.partList,e.partList,((t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats})),i?se(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):le(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const r=e.advancedDateTime;if(e.advanced&&r){const t=e.edge;e.driftStart||(e.driftStartTime=r,e.driftStart=t),e.driftEndTime=r,e.driftEnd=t}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime}function le(t,e){const i=e.startSN+e.skippedSegments-t.startSN,n=t.fragments,a=e.fragments;if(i<0||i>=n.length)return;const r=n[i].start;if(r){for(let t=e.skippedSegments;t<a.length;t++)a[t].start+=r;e.fragmentHint&&(e.fragmentHint.start+=r)}}var de,ue,he=class{constructor(t,e){this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=W.log.bind(W,`${e}:`),this.warn=W.warn.bind(W,`${e}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}onError(t,e){e.fatal&&e.type===D.NETWORK_ERROR&&this.clearTimer()}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e){const i=null==e?void 0:e.renditionReports;if(i)for(let n=0;n<i.length;n++){const a=i[n],r=""+a.URI;if(r===t.substr(-r.length)){const t=parseInt(a["LAST-MSN"]);let i=parseInt(a["LAST-PART"]);if(e&&this.hls.config.lowLatencyMode){const t=Math.min(e.age-e.partTarget,e.targetduration);void 0!==i&&t>e.partTarget&&(i+=1)}if(Number.isFinite(t))return new ie(t,Number.isFinite(i)?i:void 0,Zt.No)}}}loadPlaylist(t){}shouldLoadTrack(t){return this.canLoad&&t&&!!t.url&&(!t.details||t.details.live)}playlistLoaded(t,e,i){const{details:n,stats:a}=e,r=a.loading.end?Math.max(0,self.performance.now()-a.loading.end):0;if(n.advancedDateTime=Date.now()-r,n.live||(null==i?void 0:i.live)){if(n.reloaded(i),i&&this.log(`live playlist ${t} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:"MISSED"}`),i&&n.fragments.length>0&&oe(i,n),!this.canLoad||!n.live)return;let r,s,o;if(n.canBlockReload&&n.endSN&&n.advanced){const t=this.hls.config.lowLatencyMode,a=n.lastPartSn,l=n.endSN,d=n.lastPartIndex,u=a===l,h=t?0:d;-1!==d?(s=u?l+1:a,o=u?h:d+1):s=l+1;const c=n.age,g=c+n.ageHeader;let f=Math.min(g-n.partTarget,1.5*n.targetduration);if(f>0){if(i&&f>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${f} with playlist age: ${n.age}`),f=0;else{const t=Math.floor(f/n.targetduration);if(s+=t,void 0!==o){o+=Math.round(f%n.targetduration/n.partTarget)}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${c.toFixed(2)}s goal: ${f} skip sn ${t} to part ${o}`)}n.tuneInGoal=f}if(r=this.getDeliveryDirectives(n,e.deliveryDirectives,s,o),t||!u)return void this.loadPlaylist(r)}else r=this.getDeliveryDirectives(n,e.deliveryDirectives,s,o);let l=function(t,e){const i=1e3*t.levelTargetDuration,n=i/2,a=t.age,r=a>0&&a<3*i,s=e.loading.end-e.loading.start;let o,l=t.availabilityDelay;if(!1===t.updated)if(r){const e=333*t.misses;o=Math.max(Math.min(n,2*s),e),t.availabilityDelay=(t.availabilityDelay||0)+o}else o=n;else r?(l=Math.min(l||i/2,a),t.availabilityDelay=l,o=l+i-a):o=i-s;return Math.round(o)}(n,a);void 0!==s&&n.canBlockReload&&(l-=n.partTarget||1),this.log(`reload live playlist ${t} in ${Math.round(l)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(r)),l)}else this.clearTimer()}getDeliveryDirectives(t,e,i,n){let a=function(t,e){const{canSkipUntil:i,canSkipDateRanges:n,endSN:a}=t;return i&&(void 0!==e?e-a:0)<i?n?Zt.v2:Zt.Yes:Zt.No}(t,i);return(null==e?void 0:e.skip)&&t.deltaUpdateFailed&&(i=e.msn,n=e.part,a=Zt.No),new ie(i,n,a)}retryLoadingOrFail(t){var e;const{config:i}=this.hls,n=this.retryCount<i.levelLoadingMaxRetry;if(n)if(this.retryCount++,t.details.indexOf("LoadTimeOut")>-1&&(null==(e=t.context)?void 0:e.deliveryDirectives))this.warn(`retry playlist loading #${this.retryCount} after "${t.details}"`),this.loadPlaylist();else{const e=Math.min(Math.pow(2,this.retryCount)*i.levelLoadingRetryDelay,i.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`retry playlist loading #${this.retryCount} in ${e} ms after "${t.details}"`)}else this.warn(`cannot recover from error "${t.details}"`),this.clearTimer(),t.fatal=!0;return n}},ce=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),ge=class extends he{constructor(t){super(t,"[level-controller]"),this._levels=[],this._firstLevel=-1,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(w.LEVEL_LOADED,this.onLevelLoaded,this),t.on(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(w.FRAG_LOADED,this.onFragLoaded,this),t.on(w.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(w.LEVEL_LOADED,this.onLevelLoaded,this),t.off(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(w.FRAG_LOADED,this.onFragLoaded,this),t.off(w.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,super.destroy()}startLoad(){this._levels.forEach((t=>{t.loadError=0})),super.startLoad()}onManifestLoaded(t,e){let i,n=[],a=[],r=[];const s={};let o,l=!1,d=!1,u=!1;if(e.levels.forEach((t=>{const e=t.attrs;l=l||!(!t.width||!t.height),d=d||!!t.videoCodec,u=u||!!t.audioCodec,ce&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),o=s[t.bitrate],o?o.url.push(t.url):(o=new class{constructor(t){this.fragmentError=0,this.loadError=0,this.realBitrate=0,this._urlId=0,this.url=[t.url],this.attrs=t.attrs,this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter((t=>t)).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(t){const e=t%this.url.length;this._urlId!==e&&(this.details=void 0,this._urlId=e)}}(t),s[t.bitrate]=o,n.push(o)),e&&(e.AUDIO&&ne(o,"audio",e.AUDIO),e.SUBTITLES&&ne(o,"text",e.SUBTITLES))})),(l||d)&&u&&(n=n.filter((({videoCodec:t,width:e,height:i})=>!!t||!(!e||!i)))),n=n.filter((({audioCodec:t,videoCodec:e})=>(!t||vt(t,"audio"))&&(!e||vt(e,"video")))),e.audioTracks&&(a=e.audioTracks.filter((t=>!t.audioCodec||vt(t.audioCodec,"audio"))),ae(a)),e.subtitles&&(r=e.subtitles,ae(r)),n.length>0){i=n[0].bitrate,n.sort(((t,e)=>t.bitrate-e.bitrate)),this._levels=n;for(let e=0;e<n.length;e++)if(n[e].bitrate===i){this._firstLevel=e,this.log(`manifest loaded, ${n.length} level(s) found, first bitrate: ${i}`);break}const t=u&&!d,s={levels:n,audioTracks:a,subtitleTracks:r,firstLevel:this._firstLevel,stats:e.stats,audio:u,video:d,altAudio:!t&&a.some((t=>!!t.url))};this.hls.trigger(w.MANIFEST_PARSED,s),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,reason:"no level with compatible codecs found in manifest"})}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(t){var e;const i=this._levels;if(0===i.length)return;if(this.currentLevelIndex===t&&(null==(e=i[t])?void 0:e.details))return;if(t<0||t>=i.length){const e=t<0;if(this.hls.trigger(w.ERROR,{type:D.OTHER_ERROR,details:k.LEVEL_SWITCH_ERROR,level:t,fatal:e,reason:"invalid level idx"}),e)return;t=Math.min(t,i.length-1)}this.clearTimer();const n=this.currentLevelIndex,a=i[n],r=i[t];this.log(`switching to level ${t} from ${n}`),this.currentLevelIndex=t;const s=Object.assign({},r,{level:t,maxBitrate:r.maxBitrate,uri:r.uri,urlId:r.urlId});delete s._urlId,this.hls.trigger(w.LEVEL_SWITCHING,s);const o=r.details;if(!o||o.live){const t=this.switchParams(r.uri,null==a?void 0:a.details);this.loadPlaylist(t)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,e){if(super.onError(t,e),e.fatal)return;const i=e.context,n=this._levels[this.currentLevelIndex];if(i&&(i.type===At.AUDIO_TRACK&&n.audioGroupIds&&i.groupId===n.audioGroupIds[n.urlId]||i.type===At.SUBTITLE_TRACK&&n.textGroupIds&&i.groupId===n.textGroupIds[n.urlId]))return void this.redundantFailover(this.currentLevelIndex);let a,r=!1,s=!0;switch(e.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:if(e.frag){const t=this._levels[e.frag.level];t?(t.fragmentError++,t.fragmentError>this.hls.config.fragLoadingMaxRetry&&(a=e.frag.level)):a=e.frag.level}break;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:i&&(i.deliveryDirectives&&(s=!1),a=i.level),r=!0;break;case k.REMUX_ALLOC_ERROR:a=e.level,r=!0}void 0!==a&&this.recoverLevel(e,a,r,s)}recoverLevel(t,e,i,n){const{details:a}=t,r=this._levels[e];if(r.loadError++,i){if(!this.retryLoadingOrFail(t))return void(this.currentLevelIndex=-1);t.levelRetry=!0}if(n){const i=r.url.length;if(i>1&&r.loadError<i)t.levelRetry=!0,this.redundantFailover(e);else if(-1===this.manualLevelIndex){const i=0===e?this._levels.length-1:e-1;this.currentLevelIndex!==i&&0===this._levels[i].loadError&&(this.warn(`${a}: switch to ${i}`),t.levelRetry=!0,this.hls.nextAutoLevel=i)}}}redundantFailover(t){const e=this._levels[t],i=e.url.length;if(i>1){const n=(e.urlId+1)%i;this.warn(`Switching to redundant URL-id ${n}`),this._levels.forEach((t=>{t.urlId=n})),this.level=t}}onFragLoaded(t,{frag:e}){if(void 0!==e&&e.type===wt.MAIN){const t=this._levels[e.level];void 0!==t&&(t.fragmentError=0,t.loadError=0)}}onLevelLoaded(t,e){var i,n;const{level:a,details:r}=e,s=this._levels[a];if(!s)return this.warn(`Invalid level index ${a}`),void((null==(i=e.deliveryDirectives)?void 0:i.skip)&&(r.deltaUpdateFailed=!0));a===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0,this.retryCount=0),this.playlistLoaded(a,e,s.details)):(null==(n=e.deliveryDirectives)?void 0:n.skip)&&(r.deltaUpdateFailed=!0)}onAudioTrackSwitched(t,e){const i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){let t=-1;const n=this.hls.audioTracks[e.id].groupId;for(let e=0;e<i.audioGroupIds.length;e++)if(i.audioGroupIds[e]===n){t=e;break}t!==i.urlId&&(i.urlId=t,this.startLoad())}}loadPlaylist(t){const e=this.currentLevelIndex,i=this._levels[e];if(this.canLoad&&i&&i.url.length>0){const a=i.urlId;let r=i.url[a];if(t)try{r=t.addDirectives(r)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}this.log(`Attempt loading level index ${e}${t?" at sn "+t.msn+" part "+t.part:""} with URL-id ${a} ${r}`),this.clearTimer(),this.hls.trigger(w.LEVEL_LOADING,{url:r,level:e,id:a,deliveryDirectives:t||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t,e){const i=(t,i)=>i!==e,n=this._levels.filter(((n,a)=>a!==t||n.url.length>1&&void 0!==e&&(n.url=n.url.filter(i),n.audioGroupIds&&(n.audioGroupIds=n.audioGroupIds.filter(i)),n.textGroupIds&&(n.textGroupIds=n.textGroupIds.filter(i)),n.urlId=0,!0))).map(((t,e)=>{const{details:i}=t;return(null==i?void 0:i.fragments)&&i.fragments.forEach((t=>{t.level=e})),t}));this._levels=n,this.hls.trigger(w.LEVELS_UPDATED,{levels:n})}};(ue=de||(de={})).NOT_LOADED="NOT_LOADED",ue.BACKTRACKED="BACKTRACKED",ue.APPENDING="APPENDING",ue.PARTIAL="PARTIAL",ue.OK="OK";function fe(t){var e,i;return t.buffered&&((null==(e=t.range.video)?void 0:e.partial)||(null==(i=t.range.audio)?void 0:i.partial))}function pe(t){return`${t.type}_${t.level}_${t.urlId}_${t.sn}`}var me=class{constructor(){this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)}doTick(){}},ve={length:0,start:()=>0,end:()=>0},Te=class{static isBuffered(t,e){try{if(t){const i=Te.getBuffered(t);for(let t=0;t<i.length;t++)if(e>=i.start(t)&&e<=i.end(t))return!0}}catch(i){}return!1}static bufferInfo(t,e,i){try{if(t){const n=Te.getBuffered(t),a=[];let r;for(r=0;r<n.length;r++)a.push({start:n.start(r),end:n.end(r)});return this.bufferedInfo(a,e,i)}}catch(n){}return{len:0,start:e,end:e,nextStart:void 0}}static bufferedInfo(t,e,i){t.sort((function(t,e){const i=t.start-e.start;return i||e.end-t.end}));let n=[];if(i)for(let l=0;l<t.length;l++){const e=n.length;if(e){const a=n[e-1].end;t[l].start-a<i?t[l].end>a&&(n[e-1].end=t[l].end):n.push(t[l])}else n.push(t[l])}else n=t;let a,r=0,s=e,o=e;for(let l=0;l<n.length;l++){const t=n[l].start,d=n[l].end;if(e+i>=t&&e<d)s=t,o=d,r=o-e;else if(e+i<t){a=t;break}}return{len:r,start:s||0,end:o||0,nextStart:a}}static getBuffered(t){try{return t.buffered}catch(e){return W.log("failed to get media.buffered",e),ve}}},ye=class{constructor(t,e,i,n=0,a=-1,r=!1){this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=i,this.size=n,this.part=a,this.partial=r}};function Ee(t,e){if(t){const i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}}function be(t,e){const i=e.fragments;for(let n=0,a=i.length;n<a;n++)Ee(i[n],t);e.fragmentHint&&Ee(e.fragmentHint,t),e.alignedSliding=!0}function Se(t,e,i){e&&(!function(t,e,i){if(function(t,e,i){return!(!e.details||!(i.endCC>i.startCC||t&&t.cc<i.startCC))}(t,i,e)){const t=function(t,e){const i=t.fragments,n=e.fragments;if(!n.length||!i.length)return void W.log("No fragments to align");const a=function(t,e){let i=null;for(let n=0,a=t.length;n<a;n++){const a=t[n];if(a&&a.cc===e){i=a;break}}return i}(i,n[0].cc);if(a&&(!a||a.startPTS))return a;W.log("No frag in previous level to align on")}(i.details,e);t&&Number.isFinite(t.start)&&(W.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),be(t.start,e))}}(t,i,e),!i.alignedSliding&&e.details&&function(t,e){if(!e.fragments.length||!t.hasProgramDateTime||!e.hasProgramDateTime)return;const i=e.fragments[0].programDateTime,n=t.fragments[0].programDateTime,a=(n-i)/1e3+e.fragments[0].start;a&&Number.isFinite(a)&&(W.log(`Adjusting PTS using programDateTime delta ${n-i}ms, sliding:${a.toFixed(3)} ${t.url} `),be(a,t))}(i,e.details),i.alignedSliding||!e.details||i.skippedSegments||le(e.details,i))}var Ae={search:function(t,e){let i=0,n=t.length-1,a=null,r=null;for(;i<=n;){a=(i+n)/2|0,r=t[a];const s=e(r);if(s>0)i=a+1;else{if(!(s<0))return r;n=a-1}}return null}};function Le(t=0,e=0,i){const n=Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-n<=t?1:i.start-n>t&&i.start?-1:0}function we(t,e,i){const n=1e3*Math.min(e,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-n>t}var Ce=Math.pow(2,17),De=class{constructor(t){this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const i=t.url;if(!i)return Promise.reject(new ke({type:D.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,networkDetails:null},"Fragment does not have a "+(i?"part list":"url")));this.abort();const n=this.config,a=n.fLoader,r=n.loader;return new Promise(((i,s)=>{this.loader&&this.loader.destroy();const o=this.loader=t.loader=a?new a(n):new r(n),l=Re(t),d={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:Ce};t.stats=o.stats,o.load(l,d,{onSuccess:(e,n,a,r)=>{this.resetLoader(t,o),i({frag:t,part:null,payload:e.data,networkDetails:r})},onError:(e,i,n)=>{this.resetLoader(t,o),s(new ke({type:D.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:e,networkDetails:n}))},onAbort:(e,i,n)=>{this.resetLoader(t,o),s(new ke({type:D.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:t,networkDetails:n}))},onTimeout:(e,i,n)=>{this.resetLoader(t,o),s(new ke({type:D.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,networkDetails:n}))},onProgress:(i,n,a,r)=>{e&&e({frag:t,part:null,payload:a,networkDetails:r})}})}))}loadPart(t,e,i){this.abort();const n=this.config,a=n.fLoader,r=n.loader;return new Promise(((s,o)=>{this.loader&&this.loader.destroy();const l=this.loader=t.loader=a?new a(n):new r(n),d=Re(t,e),u={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:Ce};e.stats=l.stats,l.load(d,u,{onSuccess:(n,a,r,o)=>{this.resetLoader(t,l),this.updateStatsFromPart(t,e);const d={frag:t,part:e,payload:n.data,networkDetails:o};i(d),s(d)},onError:(i,n,a)=>{this.resetLoader(t,l),o(new ke({type:D.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:i,networkDetails:a}))},onAbort:(i,n,a)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,l),o(new ke({type:D.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,networkDetails:a}))},onTimeout:(i,n,a)=>{this.resetLoader(t,l),o(new ke({type:D.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,networkDetails:a}))}})}))}updateStatsFromPart(t,e){const i=t.stats,n=e.stats,a=n.total;if(i.loaded+=n.loaded,a){const n=Math.round(t.duration/e.duration),r=Math.min(Math.round(i.loaded/a),n),s=(n-r)*Math.round(i.loaded/r);i.total=i.loaded+s}else i.total=Math.max(i.loaded,i.total);const r=i.loading,s=n.loading;r.start?r.first+=s.first-s.start:(r.start=s.start,r.first=s.first),r.end=s.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}};function Re(t,e=null){const i=e||t,n={frag:t,part:e,responseType:"arraybuffer",url:i.url,rangeStart:0,rangeEnd:0},a=i.byteRangeStartOffset,r=i.byteRangeEndOffset;return Number.isFinite(a)&&Number.isFinite(r)&&(n.rangeStart=a,n.rangeEnd=r),n}var ke=class extends Error{constructor(t,...e){super(...e),this.data=t}},xe=class{constructor(t,e){this.subtle=t,this.aesIV=e}decrypt(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)}},Oe=class{constructor(t,e){this.subtle=t,this.key=e}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}};var Ie=class{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let n=0;n<4;n++)i[n]=e.getUint32(4*n);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,n=i[0],a=i[1],r=i[2],s=i[3],o=this.invSubMix,l=o[0],d=o[1],u=o[2],h=o[3],c=new Uint32Array(256);let g=0,f=0,p=0;for(p=0;p<256;p++)c[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){let i=f^f<<1^f<<2^f<<3^f<<4;i=i>>>8^255&i^99,t[g]=i,e[i]=g;const o=c[g],p=c[o],m=c[p];let v=257*c[i]^16843008*i;n[g]=v<<24|v>>>8,a[g]=v<<16|v>>>16,r[g]=v<<8|v>>>24,s[g]=v,v=16843009*m^65537*p^257*o^16843008*g,l[i]=v<<24|v>>>8,d[i]=v<<16|v>>>16,u[i]=v<<8|v>>>24,h[i]=v,g?(g=o^c[c[c[m^o]]],f^=c[c[f]]):g=f=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let i=!0,n=0;for(;n<e.length&&i;)i=e[n]===this.key[n],n++;if(i)return;this.key=e;const a=this.keySize=e.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);const r=this.ksRows=4*(a+6+1);let s,o;const l=this.keySchedule=new Uint32Array(r),d=this.invKeySchedule=new Uint32Array(r),u=this.sBox,h=this.rcon,c=this.invSubMix,g=c[0],f=c[1],p=c[2],m=c[3];let v,T;for(s=0;s<r;s++)s<a?v=l[s]=e[s]:(T=v,s%a==0?(T=T<<8|T>>>24,T=u[T>>>24]<<24|u[T>>>16&255]<<16|u[T>>>8&255]<<8|u[255&T],T^=h[s/a|0]<<24):a>6&&s%a==4&&(T=u[T>>>24]<<24|u[T>>>16&255]<<16|u[T>>>8&255]<<8|u[255&T]),l[s]=v=(l[s-a]^T)>>>0);for(o=0;o<r;o++)s=r-o,T=3&o?l[s]:l[s-4],d[o]=o<4||s<=4?T:g[u[T>>>24]]^f[u[T>>>16&255]]^p[u[T>>>8&255]]^m[u[255&T]],d[o]=d[o]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,i){const n=this.keySize+6,a=this.invKeySchedule,r=this.invSBox,s=this.invSubMix,o=s[0],l=s[1],d=s[2],u=s[3],h=this.uint8ArrayToUint32Array_(i);let c=h[0],g=h[1],f=h[2],p=h[3];const m=new Int32Array(t),v=new Int32Array(m.length);let T,y,E,b,S,A,L,w,C,D,R,k,x,O;const I=this.networkToHostOrderSwap;for(;e<m.length;){for(C=I(m[e]),D=I(m[e+1]),R=I(m[e+2]),k=I(m[e+3]),S=C^a[0],A=k^a[1],L=R^a[2],w=D^a[3],x=4,O=1;O<n;O++)T=o[S>>>24]^l[A>>16&255]^d[L>>8&255]^u[255&w]^a[x],y=o[A>>>24]^l[L>>16&255]^d[w>>8&255]^u[255&S]^a[x+1],E=o[L>>>24]^l[w>>16&255]^d[S>>8&255]^u[255&A]^a[x+2],b=o[w>>>24]^l[S>>16&255]^d[A>>8&255]^u[255&L]^a[x+3],S=T,A=y,L=E,w=b,x+=4;T=r[S>>>24]<<24^r[A>>16&255]<<16^r[L>>8&255]<<8^r[255&w]^a[x],y=r[A>>>24]<<24^r[L>>16&255]<<16^r[w>>8&255]<<8^r[255&S]^a[x+1],E=r[L>>>24]<<24^r[w>>16&255]<<16^r[S>>8&255]<<8^r[255&A]^a[x+2],b=r[w>>>24]<<24^r[S>>16&255]<<16^r[A>>8&255]<<8^r[255&L]^a[x+3],v[e]=I(T^c),v[e+1]=I(b^g),v[e+2]=I(E^f),v[e+3]=I(y^p),c=C,g=D,f=R,p=k,e+=4}return v.buffer}},_e=class{constructor(t,e,{removePKCS7Padding:i=!0}={}){if(this.logEnabled=!0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=t,this.config=e,this.removePKCS7Padding=i,i)try{const t=self.crypto;t&&(this.subtle=t.subtle||t.webkitSubtle)}catch(n){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}destroy(){this.observer=null}isSync(){return this.config.enableSoftwareAES}flush(){const{currentResult:t}=this;if(!t)return void this.reset();const e=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function(t){const e=t.byteLength,i=e&&new DataView(t.buffer).getUint8(e-1);return i?Y(t,0,e-i):t}(e):e}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,n){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(t),e,i);const a=this.flush();a&&n(a.buffer)}else this.webCryptoDecrypt(new Uint8Array(t),e,i).then(n)}softwareDecrypt(t,e,i){const{currentIV:n,currentResult:a,remainderData:r}=this;this.logOnce("JS AES decrypt"),r&&(t=ht(r,t),this.remainderData=null);const s=this.getValidChunk(t);if(!s.length)return null;n&&(i=n);let o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new Ie),o.expandKey(e);const l=a;return this.currentResult=o.decrypt(s.buffer,0,i),this.currentIV=Y(s,-16).buffer,l||null}webCryptoDecrypt(t,e,i){const n=this.subtle;return this.key===e&&this.fastAesKey||(this.key=e,this.fastAesKey=new Oe(n,e)),this.fastAesKey.expandKey().then((e=>{if(!n)return Promise.reject(new Error("web crypto not initialized"));return new xe(n,i).decrypt(t.buffer,e)})).catch((n=>this.onWebCryptoError(n,t,e,i)))}onWebCryptoError(t,e,i,n){return W.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",t),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(e,i,n)}getValidChunk(t){let e=t;const i=t.length-t.length%16;return i!==t.length&&(e=Y(t,0,i),this.remainderData=Y(t,i)),e}logOnce(t){this.logEnabled&&(W.log(`[decrypter.ts]: ${t}`),this.logEnabled=!1)}},Fe={toString:function(t){let e="";const i=t.length;for(let n=0;n<i;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}},Ne="STOPPED",Pe="IDLE",Me="KEY_LOADING",Be="FRAG_LOADING",Ue="FRAG_LOADING_WAITING_RETRY",Ge="PARSING",He="PARSED",Ve="BACKTRACKING",Ke="ENDED",je="ERROR",Xe="WAITING_LEVEL",We=class extends me{constructor(t,e,i){super(),this.fragPrevious=null,this.fragCurrent=null,this.transmuxer=null,this._state=Ne,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.loadedmetadata=!1,this.fragLoadError=0,this.retryDate=0,this.levels=null,this.levelLastLoaded=null,this.startFragRequested=!1,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.logPrefix=i,this.log=W.log.bind(W,`${i}:`),this.warn=W.warn.bind(W,`${i}:`),this.hls=t,this.fragmentLoader=new De(t.config),this.fragmentTracker=e,this.config=t.config,this.decrypter=new _e(t,t.config),t.on(w.KEY_LOADED,this.onKeyLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort();const t=this.fragCurrent;t&&this.fragmentTracker.removeFragment(t),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ne}_streamEnded(t,e){const{fragCurrent:i,fragmentTracker:n}=this;if(!e.live&&i&&i.sn===e.endSN&&!t.nextStart){const t=n.getState(i);return t===de.PARTIAL||t===de.OK}return!1}onMediaAttached(t,e){const i=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const n=this.config;this.levels&&n.autoStartLoad&&this.state===Ne&&this.startLoad(n.startPosition)}onMediaDetaching(){const t=this.media;(null==t?void 0:t.ended)&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:e,media:i,mediaBuffer:n,state:a}=this,r=i?i.currentTime:0,s=Te.bufferInfo(n||i,r,t.maxBufferHole);if(this.log(`media seeking to ${Number.isFinite(r)?r.toFixed(3):r}, state: ${a}`),a===Ke)this.resetLoadingState();else if(e&&!s.len){const i=t.maxFragLookUpTolerance,n=e.start-i,a=e.start+e.duration+i;(r<n||r>a)&&(e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.loader.abort()),this.resetLoadingState())}i&&(this.lastCurrentTime=r),this.loadedmetadata||s.len||(this.nextLoadPosition=this.startPosition=r),this.tick()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onKeyLoaded(t,e){if(this.state!==Me||e.frag!==this.fragCurrent||!this.levels)return;this.state=Pe;const i=this.levels[e.frag.level].details;i&&this.loadFragment(e.frag,i,e.frag.start)}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=Ne,this.hls.off(w.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadKey(t,e){this.log(`Loading key for ${t.sn} of [${e.startSN}-${e.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${t.level}`),this.state=Me,this.fragCurrent=t,this.hls.trigger(w.KEY_LOADING,{frag:t})}loadFragment(t,e,i){this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){this._doFragLoad(t,e,i,(e=>{if(this.fragContextChanged(t))return this.warn(`Fragment ${t.sn}${e.part?" p: "+e.part.index:""} of level ${t.level} was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)})).then((e=>{if(!e)return;this.fragLoadError=0;const i=this.state;if(!this.fragContextChanged(t))return"payload"in e&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(w.FRAG_LOADED,e),this.state===Ve)?(this.fragmentTracker.backtrack(t,e),void this.resetFragmentLoading(t)):void this._handleFragmentLoadComplete(e);(i===Be||i===Ve||!this.fragCurrent&&i===Ge)&&(this.fragmentTracker.removeFragment(t),this.state=Pe)})).catch((e=>{this.warn(e),this.resetFragmentLoading(t)}))}flushMainBuffer(t,e,i=null){const n={startOffset:t,endOffset:e,type:i};this.fragLoadError=0,this.hls.trigger(w.BUFFER_FLUSHING,n)}_loadInitSegment(t){this._doFragLoad(t).then((e=>{if(!e||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e})).then((e=>{const{hls:i}=this,{payload:n}=e,a=t.decryptdata;if(n&&n.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){const r=self.performance.now();return this.decrypter.webCryptoDecrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).then((n=>{const a=self.performance.now();return i.trigger(w.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:r,tdecrypt:a}}),e.payload=n,e}))}return e})).then((e=>{const{fragCurrent:i,hls:n,levels:a}=this;if(!a)throw new Error("init load aborted, missing levels");const r=a[t.level].details;console.assert(r,"Level details are defined when init segment is loaded");const s=r.initSegment;console.assert(s,"Fragment initSegment is defined when init segment is loaded");const o=t.stats;this.state=Pe,this.fragLoadError=0,s.data=new Uint8Array(e.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),e.frag===i&&n.trigger(w.FRAG_BUFFERED,{stats:o,frag:i,part:null,id:t.type}),this.tick()})).catch((e=>{this.warn(e),this.resetFragmentLoading(t)}))}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.level!==e.level||t.sn!==e.sn||t.urlId!==e.urlId}fragBufferedComplete(t,e){const i=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${"[stream-controller]"===this.logPrefix?"level":"track"} ${t.level} ${Fe.toString(Te.getBuffered(i))}`),this.state=Pe,this.tick()}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:i,part:n,partsLoaded:a}=t,r=!a||0===a.length||a.some((t=>!t)),s=new ye(i.level,i.sn,i.stats.chunkCount+1,0,n?n.index:-1,!r);e.flush(s)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,n){if(!this.levels)throw new Error("frag load aborted, missing levels");if(i=Math.max(t.start,i||0),this.config.lowLatencyMode&&e){const a=e.partList;if(a&&n){i>t.end&&e.fragmentHint&&(t=e.fragmentHint);const r=this.getNextPart(a,t,i);if(r>-1){const s=a[r];return this.log(`Loading part sn: ${t.sn} p: ${s.index} cc: ${t.cc} of playlist [${e.startSN}-${e.endSN}] parts [0-${r}-${a.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${t.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=s.start+s.duration,this.state=Be,this.hls.trigger(w.FRAG_LOADING,{frag:t,part:a[r],targetBufferTime:i}),this.doFragPartsLoad(t,a,r,n).catch((t=>this.handleFragLoadError(t)))}if(!t.url||this.loadedEndOfParts(a,i))return Promise.resolve(null)}}return this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${e?"of ["+e.startSN+"-"+e.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${t.level}, target: ${parseFloat(i.toFixed(3))}`),Number.isFinite(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=Be,this.hls.trigger(w.FRAG_LOADING,{frag:t,targetBufferTime:i}),this.fragmentLoader.load(t,n).catch((t=>this.handleFragLoadError(t)))}doFragPartsLoad(t,e,i,n){return new Promise(((a,r)=>{const s=[],o=i=>{const l=e[i];this.fragmentLoader.loadPart(t,l,n).then((n=>{s[l.index]=n;const r=n.part;this.hls.trigger(w.FRAG_LOADED,n);const d=e[i+1];if(!d||d.fragment!==t)return a({frag:t,part:r,partsLoaded:s});o(i+1)})).catch(r)};o(i)}))}handleFragLoadError({data:t}){return t&&t.details===k.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(w.ERROR,t),null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==Ge)return void(this.fragCurrent||(this.state=Pe));const{frag:i,part:n,level:a}=e,r=self.performance.now();i.stats.parsing.end=r,n&&(n.stats.parsing.end=r),this.updateLevelTiming(i,n,a,t.partial)}getCurrentContext(t){const{levels:e}=this,{level:i,sn:n,part:a}=t;if(!e||!e[i])return this.warn(`Levels object was unset while buffering fragment ${n} of level ${i}. The current chunk will not be buffered.`),null;const r=e[i],s=a>-1?function(t,e,i){if(!t||!t.details)return null;const n=t.details.partList;if(n)for(let a=n.length;a--;){const t=n[a];if(t.index===i&&t.fragment.sn===e)return t}return null}(r,n,a):null,o=s?s.fragment:function(t,e){if(!t||!t.details)return null;const i=t.details;let n=i.fragments[e-i.startSN];return n||(n=i.fragmentHint,n&&n.sn===e?n:null)}(r,n);return o?{frag:o,part:s,level:r}:null}bufferFragmentData(t,e,i,n){if(!t||this.state!==Ge)return;const{data1:a,data2:r}=t;let s=a;if(a&&r&&(s=ht(a,r)),!s||!s.length)return;const o={type:t.type,frag:e,part:i,chunkMeta:n,parent:e.type,data:s};this.hls.trigger(w.BUFFER_APPENDING,o),t.dropped&&t.independent&&!i&&this.flushBufferGap(e)}flushBufferGap(t){const e=this.media;if(!e)return;if(!Te.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const i=e.currentTime,n=Te.bufferInfo(e,i,0),a=t.duration,r=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),s=Math.max(Math.min(t.start-r,n.end-r),i+r);t.start-s>r&&this.flushMainBuffer(s,t.start)}reduceMaxBufferLength(t){const e=this.config,i=t||e.maxBufferLength;return e.maxMaxBufferLength>=i&&(e.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${e.maxMaxBufferLength}s`),!0)}getNextFragment(t,e){const i=e.fragments,n=i.length;if(!n)return null;const{config:a}=this,r=i[0].start;let s;if(!e.initSegment||e.initSegment.data||this.bitrateTest)if(e.live){const r=a.initialLiveManifestSize;if(n<r)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${r})`),null;e.PTSKnown||this.startFragRequested||-1!==this.startPosition||(s=this.getInitialLiveFragment(e,i),this.startPosition=s?this.hls.liveSyncPosition||s.start:t)}else t<=r&&(s=i[0]);else s=e.initSegment;if(!s){const i=a.lowLatencyMode?e.partEnd:e.fragmentEnd;s=this.getFragmentAtPosition(t,i,e)}return s}getNextPart(t,e,i){let n=-1,a=!1,r=!0;for(let s=0,o=t.length;s<o;s++){const o=t[s];if(r=r&&!o.independent,n>-1&&i<o.start)break;const l=o.loaded;!l&&(a||o.independent||r)&&o.fragment===e&&(n=s),a=l}return n}loadedEndOfParts(t,e){const i=t[t.length-1];return i&&e>i.start&&i.loaded}getInitialLiveFragment(t,e){const i=this.fragPrevious;let n=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),n=function(t,e,i){if(null===e||!Array.isArray(t)||!t.length||!Number.isFinite(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;i=i||0;for(let n=0;n<t.length;++n){const a=t[n];if(we(e,i,a))return a}return null}(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const a=i.sn+1;if(a>=t.startSN&&a<=t.endSN){const r=e[a-t.startSN];i.cc===r.cc&&(n=r,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=function(t,e){return Ae.search(t,(t=>t.cc<e?1:t.cc>e?-1:0))}(e,i.cc),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const e=this.hls.liveSyncPosition;null!==e&&(n=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t))}return n}getFragmentAtPosition(t,e,i){const{config:n,fragPrevious:a}=this;let{fragments:r,endSN:s}=i;const{fragmentHint:o}=i,l=n.maxFragLookUpTolerance,d=!!(n.lowLatencyMode&&i.partList&&o);let u;if(d&&o&&!this.bitrateTest&&(r=r.concat(o),s=o.sn),t<e){u=function(t,e,i=0,n=0){let a=null;if(t?a=e[t.sn-e[0].sn+1]:0===i&&0===e[0].start&&(a=e[0]),a&&0===Le(i,n,a))return a;return Ae.search(e,Le.bind(null,i,n))||a}(a,r,t,t>e-l?0:l)}else u=r[r.length-1];if(u){const t=u.sn-i.startSN,e=a&&u.level===a.level,n=r[t+1];if(this.fragmentTracker.getState(u)===de.BACKTRACKED){u=null;let e=t;for(;r[e]&&this.fragmentTracker.getState(r[e])===de.BACKTRACKED;)u=a?r[e--]:r[--e];u||(u=n)}else a&&u.sn===a.sn&&!d&&e&&(u.sn<s&&this.fragmentTracker.getState(n)!==de.OK?(this.log(`SN ${u.sn} just loaded, load next one: ${n.sn}`),u=n):u=null)}return u}synchronizeToLiveEdge(t){const{config:e,media:i}=this;if(!i)return;const n=this.hls.liveSyncPosition,a=i.currentTime,r=t.fragments[0].start,s=t.edge,o=a>=r-e.maxFragLookUpTolerance&&a<=s;if(null!==n&&i.duration>n&&(a<n||!o)){const r=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;(!o&&i.readyState<4||a<s-r)&&(this.loadedmetadata||(this.nextLoadPosition=n),i.readyState&&(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${s}, reset currentTime to : ${n.toFixed(3)}`),i.currentTime=n))}}alignPlaylists(t,e){const{levels:i,levelLastLoaded:n}=this,a=null!==n?i[n]:null;let r=0;return e&&t.fragments.length>0?(r=t.fragments[0].start,t.alignedSliding&&Number.isFinite(r)?this.log(`Live playlist sliding:${r.toFixed(3)}`):r||(this.warn(`[${this.constructor.name}] Live playlist - outdated PTS, unknown sliding`),Se(this.fragPrevious,a,t))):(this.log("Live playlist - first load, unknown sliding"),Se(this.fragPrevious,a,t)),r}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let i=this.startPosition;if(-1===this.startPosition||-1===this.lastCurrentTime){let n=t.startTimeOffset;Number.isFinite(n)?(n<0&&(this.log(`Negative start time offset ${n}, count from end of last fragment`),n=e+t.totalduration+n),this.log(`Start time offset found in playlist, adjust startPosition to ${n}`),this.startPosition=i=n):t.live?i=this.hls.liveSyncPosition||e:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:t}=this;let e=0;return this.loadedmetadata?e=t.currentTime:this.nextLoadPosition&&(e=this.nextLoadPosition),e}handleFragLoadAborted(t,e){this.transmuxer&&"initSegment"!==t.sn&&(this.warn(`Fragment ${t.sn}${e?" part"+e.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&this.fragContextChanged(t)||(this.state=Pe)}onFragmentOrKeyLoadError(t,e){if(e.fatal)return;const i=e.frag;if(!i||i.type!==t)return;const n=this.fragCurrent;console.assert(n&&i.sn===n.sn&&i.level===n.level&&i.urlId===n.urlId,"Frag load error must match current frag to retry");const a=this.config;if(this.fragLoadError+1<=a.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(i.level))return;const e=Math.min(Math.pow(2,this.fragLoadError)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);this.warn(`Fragment ${i.sn} of ${t} ${i.level} failed to load, retrying in ${e}ms`),this.retryDate=self.performance.now()+e,this.fragLoadError++,this.state=Ue}else e.levelRetry?(t===wt.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=Pe):(W.error(`${e.details} reaches max retry, redispatch as fatal ...`),e.fatal=!0,this.hls.stopLoad(),this.state=je)}afterBufferFlushed(t,e,i){if(!t)return;const n=Te.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,n,i),this.state===Ke&&this.resetLoadingState()}resetLoadingState(){this.fragCurrent=null,this.fragPrevious=null,this.state=Pe}resetLiveStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const e=this.levels?this.levels[t].details:null;if(null==e?void 0:e.live)return this.startPosition=-1,this.setStartPosition(e,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1}updateLevelTiming(t,e,i,n){const a=i.details;console.assert(!!a,"level.details must be defined");Object.keys(t.elementaryStreams).reduce(((e,r)=>{const s=t.elementaryStreams[r];if(s){const o=s.endPTS-s.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${t.sn} ${r} duration reliably (${o}) resetting transmuxer to fallback to playlist timing`),this.resetTransmuxer(),e||!1;const l=n?0:se(a,t,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return this.hls.trigger(w.LEVEL_PTS_UPDATED,{details:a,level:i,drift:l,type:r,frag:t,start:s.startPTS,end:s.endPTS}),!0}return e}),!1)?(this.state=He,this.hls.trigger(w.FRAG_PARSED,{frag:t,part:e})):this.resetLoadingState()}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}};function Ye(){return self.MediaSource||self.WebKitMediaSource}function Je(){return self.SourceBuffer||self.WebKitSourceBuffer}var ze=(t,e)=>Number.isFinite(t)?90*t:9e4*e,qe=class{constructor(){this.frameIndex=0,this.cachedData=null,this.initPTS=null}resetInitSegment(t,e,i){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(){}resetContiguity(){}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=ht(this.cachedData,t),this.cachedData=null);let i,n,a=Gt(t,0),r=a?a.length:0;const s=this._audioTrack,o=this._id3Track,l=a?(t=>{const e=Xt(t);for(let i=0;i<e.length;i++){const t=e[i];if(Kt(t))return qt(t)}})(a):void 0,d=t.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=ze(l,e)),a&&a.length>0&&o.samples.push({pts:this.initPTS,dts:this.initPTS,data:a}),n=this.initPTS;r<d;){if(this.canParse(t,r)){const e=this.appendFrame(s,t,r);e?(this.frameIndex++,n=e.sample.pts,r+=e.length,i=r):r=d}else Vt(t,r)?(a=Gt(t,r),o.samples.push({pts:n,dts:n,data:a}),r+=a.length,i=r):r++;if(r===d&&i!==d){const e=Y(t,i);this.cachedData?this.cachedData=ht(this.cachedData,e):this.cachedData=e}}return{audioTrack:s,avcTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},id3Track:o,textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},id3Track:this._id3Track,textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}}destroy(){}};function $e(t,e){return 255===t[e]&&240==(246&t[e+1])}function Ze(t,e){return 1&t[e+1]?7:9}function Qe(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function ti(t,e){return e+1<t.length&&$e(t,e)}function ei(t,e){if(ti(t,e)){const i=Ze(t,e);if(e+i>=t.length)return!1;const n=Qe(t,e);if(n<=i)return!1;const a=e+n;return a===t.length||ti(t,a)}return!1}function ii(t,e,i,n,a){if(!t.samplerate){const r=function(t,e,i,n){let a,r,s,o;const l=navigator.userAgent.toLowerCase(),d=n,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=1+((192&e[i+2])>>>6);const h=(60&e[i+2])>>>2;if(!(h>u.length-1))return s=(1&e[i+2])<<2,s|=(192&e[i+3])>>>6,W.log(`manifest codec:${n}, ADTS type:${a}, samplingIndex:${h}`),/firefox/i.test(l)?h>=6?(a=5,o=new Array(4),r=h-3):(a=2,o=new Array(2),r=h):-1!==l.indexOf("android")?(a=2,o=new Array(2),r=h):(a=5,o=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&h>=6?r=h-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(h>=6&&1===s||/vivaldi/i.test(l))||!n&&1===s)&&(a=2,o=new Array(2)),r=h)),o[0]=a<<3,o[0]|=(14&h)>>1,o[1]|=(1&h)<<7,o[1]|=s<<3,5===a&&(o[1]|=(14&r)>>1,o[2]=(1&r)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:u[h],channelCount:s,codec:"mp4a.40."+a,manifestCodec:d};t.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${h}`})}(e,i,n,a);if(!r)return;t.config=r.config,t.samplerate=r.samplerate,t.channelCount=r.channelCount,t.codec=r.codec,t.manifestCodec=r.manifestCodec,W.log(`parsed codec:${t.codec}, rate:${r.samplerate}, channels:${r.channelCount}`)}}function ni(t){return 9216e4/t}function ai(t,e,i,n,a){const r=function(t,e,i,n,a){const r=t.length,s=Ze(t,e);let o=Qe(t,e);if(o-=s,o>0&&e+s+o<=r)return{headerLength:s,frameLength:o,stamp:i+n*a}}(e,i,n,a,ni(t.samplerate));if(r){const n=r.stamp,a=r.headerLength,s=r.frameLength,o={unit:e.subarray(i+a,i+a+s),pts:n,dts:n};return t.samples.push(o),{sample:o,length:s+a}}}var ri=class extends qe{constructor(t,e){super(),this.observer=t,this.config=e}resetInitSegment(t,e,i){super.resetInitSegment(t,e,i),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;let e=(Gt(t,0)||[]).length;for(let i=t.length;e<i;e++)if(ei(t,e))return W.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return function(t,e){return e+5<t.length}(t,e)&&$e(t,e)&&Qe(t,e)<=t.length-e}(t,e)}appendFrame(t,e,i){return ii(t,this.observer,e,i,t.manifestCodec),ai(t,e,i,this.initPTS,this.frameIndex)}};ri.minProbeByteLength=9;var si=ri,oi=class{constructor(t,e){this.remainderData=null,this.config=e}resetTimeStamp(){}resetInitSegment(){}resetContiguity(){}static probe(t){return lt({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0}demux(t){let e=t;const i={type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0};if(this.config.progressive){this.remainderData&&(e=ht(this.remainderData,t));const n=function(t){const e={valid:null,remainder:null},i=lt(t,["moof"]);if(!i)return e;if(i.length<2)return e.remainder=t,e;const n=i[i.length-1];return e.valid=Y(t,0,n.start-8),e.remainder=Y(t,n.start-8),e}(e);this.remainderData=n.remainder,i.samples=n.valid||new Uint8Array}else i.samples=e;return{audioTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},avcTrack:i,id3Track:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}}flush(){const t={type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0};return t.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},avcTrack:t,id3Track:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}};oi.minProbeByteLength=1024;var li=oi,di=null,ui=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],hi=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ci=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],gi=[0,1,1,4];function fi(t,e,i,n,a){if(i+24>e.length)return;const r=pi(e,i);if(r&&i+r.frameLength<=e.length){const s=n+a*(9e4*r.samplesPerFrame/r.sampleRate),o={unit:e.subarray(i,i+r.frameLength),pts:s,dts:s};return t.config=[],t.channelCount=r.channelCount,t.samplerate=r.sampleRate,t.samples.push(o),{sample:o,length:r.frameLength}}}function pi(t,e){const i=t[e+1]>>3&3,n=t[e+1]>>1&3,a=t[e+2]>>4&15,r=t[e+2]>>2&3;if(1!==i&&0!==a&&15!==a&&3!==r){const s=t[e+2]>>1&1,o=t[e+3]>>6,l=1e3*ui[14*(3===i?3-n:3===n?3:4)+a-1],d=hi[3*(3===i?0:2===i?1:2)+r],u=3===o?1:2,h=ci[i][n],c=gi[n],g=8*h*c,f=Math.floor(h*l/d+s)*c;if(null===di){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);di=t?parseInt(t[1]):0}return!!di&&di<=87&&2===n&&l>=224e3&&0===o&&(t[e+3]=128|t[e+3]),{sampleRate:d,channelCount:u,frameLength:f,samplesPerFrame:g}}}function mi(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])}function vi(t,e){return e+1<t.length&&mi(t,e)}function Ti(t,e){if(e+1<t.length&&mi(t,e)){const i=4,n=pi(t,e);let a=i;(null==n?void 0:n.frameLength)&&(a=n.frameLength);const r=e+a;return r===t.length||vi(t,r)}return!1}var yi=class{constructor(t){this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,i=t.byteLength-e,n=new Uint8Array(4),a=Math.min(4,e);if(0===a)throw new Error("no bytes available");n.set(t.subarray(i,i+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}skipBits(t){let e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const i=this.word>>>32-e;return t>32&&W.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let e,i=8,n=8;for(let a=0;a<t;a++)0!==n&&(e=this.readEG(),n=(i+e+256)%256),i=0===n?i:n}readSPS(){let t,e,i,n=0,a=0,r=0,s=0;const o=this.readUByte.bind(this),l=this.readBits.bind(this),d=this.readUEG.bind(this),u=this.readBoolean.bind(this),h=this.skipBits.bind(this),c=this.skipEG.bind(this),g=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);o();const p=o();if(l(5),h(3),o(),g(),100===p||110===p||122===p||244===p||44===p||83===p||86===p||118===p||128===p){const t=d();if(3===t&&h(1),g(),g(),h(1),u())for(e=3!==t?8:12,i=0;i<e;i++)u()&&f(i<6?16:64)}g();const m=d();if(0===m)d();else if(1===m)for(h(1),c(),c(),t=d(),i=0;i<t;i++)c();g(),h(1);const v=d(),T=d(),y=l(1);0===y&&h(1),h(1),u()&&(n=d(),a=d(),r=d(),s=d());let E=[1,1];if(u()&&u()){switch(o()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[o()<<8|o(),o()<<8|o()]}}return{width:Math.ceil(16*(v+1)-2*n-2*a),height:(2-y)*(T+1)*16-(y?2:4)*(r+s),pixelRatio:E}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}},Ei=class{constructor(t,e,i){this.keyData=i,this.decrypter=new _e(t,e,{removePKCS7Padding:!1})}decryptBuffer(t,e){this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,e)}decryptAacSample(t,e,i,n){const a=t[e].unit,r=a.subarray(16,a.length-a.length%16),s=r.buffer.slice(r.byteOffset,r.byteOffset+r.length),o=this;this.decryptBuffer(s,(r=>{const s=new Uint8Array(r);a.set(s,16),n||o.decryptAacSamples(t,e+1,i)}))}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length)return void i();if(t[e].unit.length<32)continue;const n=this.decrypter.isSync();if(this.decryptAacSample(t,e,i,n),!n)return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e);let n=0;for(let a=32;a<=t.length-16;a+=160,n+=16)i.set(t.subarray(a,a+16),n);return i}getAvcDecryptedUnit(t,e){const i=new Uint8Array(e);let n=0;for(let a=32;a<=t.length-16;a+=160,n+=16)t.set(i.subarray(n,n+16),a);return t}decryptAvcSample(t,e,i,n,a,r){const s=xi(a.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,(function(o){a.data=l.getAvcDecryptedUnit(s,o),r||l.decryptAvcSamples(t,e,i+1,n)}))}decryptAvcSamples(t,e,i,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length)return void n();const a=t[e].units;for(;!(i>=a.length);i++){const r=a[i];if(r.data.length<=48||1!==r.type&&5!==r.type)continue;const s=this.decrypter.isSync();if(this.decryptAvcSample(t,e,i,n,r,s),!s)return}}}},bi={video:1,audio:2,id3:3,text:4},Si=class{constructor(t,e,i){this.sampleAes=null,this.pmtParsed=!1,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=t,this.config=e,this.typeSupported=i}static probe(t){const e=Si.syncOffset(t);return!(e<0)&&(e&&W.warn(`MPEG2-TS detected but first sync word found @ offset ${e}, junk ahead ?`),!0)}static syncOffset(t){const e=Math.min(1e3,t.length-564);let i=0;for(;i<e;){if(71===t[i]&&71===t[i+188]&&71===t[i+376])return i;i++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:bi[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=Si.createTrack("video",i),this._audioTrack=Si.createTrack("audio",i),this._id3Track=Si.createTrack("id3",i),this._txtTrack=Si.createTrack("text",i),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=e,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_avcTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null}demux(t,e,i=!1,n=!1){let a;i||(this.sampleAes=null);const r=this._avcTrack,s=this._audioTrack,o=this._id3Track;let l=r.pid,d=r.pesData,u=s.pid,h=o.pid,c=s.pesData,g=o.pesData,f=!1,p=this.pmtParsed,m=this._pmtId,v=t.length;if(this.remainderData&&(v=(t=ht(this.remainderData,t)).length,this.remainderData=null),v<188&&!n)return this.remainderData=t,{audioTrack:s,avcTrack:r,id3Track:o,textTrack:this._txtTrack};const T=Math.max(0,Si.syncOffset(t));v-=(v+T)%188,v<t.byteLength&&!n&&(this.remainderData=new Uint8Array(t.buffer,v,t.buffer.byteLength-v));for(let E=T;E<v;E+=188)if(71===t[E]){const e=!!(64&t[E+1]),n=((31&t[E+1])<<8)+t[E+2];let v;if((48&t[E+3])>>4>1){if(v=E+5+t[E+4],v===E+188)continue}else v=E+4;switch(n){case l:e&&(d&&(a=Di(d))&&this.parseAVCPES(a,!1),d={data:[],size:0}),d&&(d.data.push(t.subarray(v,E+188)),d.size+=E+188-v);break;case u:e&&(c&&(a=Di(c))&&(s.isAAC?this.parseAACPES(a):this.parseMPEGPES(a)),c={data:[],size:0}),c&&(c.data.push(t.subarray(v,E+188)),c.size+=E+188-v);break;case h:e&&(g&&(a=Di(g))&&this.parseID3PES(a),g={data:[],size:0}),g&&(g.data.push(t.subarray(v,E+188)),g.size+=E+188-v);break;case 0:e&&(v+=t[v]+1),m=this._pmtId=wi(t,v);break;case m:{e&&(v+=t[v]+1);const n=Ci(t,v,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,i);l=n.avc,l>0&&(r.pid=l),u=n.audio,u>0&&(s.pid=u,s.isAAC=n.isAAC),h=n.id3,h>0&&(o.pid=h),f&&!p&&(W.log("reparse from beginning"),f=!1,E=T-188),p=this.pmtParsed=!0;break}case 17:case 8191:break;default:f=!0}}else this.observer.emit(w.ERROR,w.ERROR,{type:D.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});r.pesData=d,s.pesData=c,o.pesData=g;const y={audioTrack:s,avcTrack:r,id3Track:o,textTrack:this._txtTrack};return n&&this.extractRemainingSamples(y),y}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,avcTrack:i,id3Track:n}=t,a=i.pesData,r=e.pesData,s=n.pesData;let o;a&&(o=Di(a))?(this.parseAVCPES(o,!0),i.pesData=null):i.pesData=a,r&&(o=Di(r))?(e.isAAC?this.parseAACPES(o):this.parseMPEGPES(o),e.pesData=null):((null==r?void 0:r.size)&&W.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=r),s&&(o=Di(s))?(this.parseID3PES(o),n.pesData=null):n.pesData=s}demuxSampleAes(t,e,i){const n=this.demux(t,i,!0,!this.config.progressive),a=this.sampleAes=new Ei(this.observer,this.config,e);return this.decrypt(n,a)}decrypt(t,e){return new Promise((i=>{const{audioTrack:n,avcTrack:a}=t;n.samples&&n.isAAC?e.decryptAacSamples(n.samples,0,(()=>{a.samples?e.decryptAvcSamples(a.samples,0,0,(()=>{i(t)})):i(t)})):a.samples&&e.decryptAvcSamples(a.samples,0,0,(()=>{i(t)}))}))}destroy(){this._initPTS=this._initDTS=null,this._duration=0}parseAVCPES(t,e){const i=this._avcTrack,n=this.parseAVCNALu(t.data);let a,r=this.avcSample,s=!1;t.data=null,r&&n.length&&!i.audFound&&(Ri(r,i),r=this.avcSample=Li(!1,t.pts,t.dts,"")),n.forEach((e=>{switch(e.type){case 1:{a=!0,r||(r=this.avcSample=Li(!0,t.pts,t.dts,"")),r.frame=!0;const i=e.data;if(s&&i.length>4){const t=new yi(i).readSliceType();2!==t&&4!==t&&7!==t&&9!==t||(r.key=!0)}break}case 5:a=!0,r||(r=this.avcSample=Li(!0,t.pts,t.dts,"")),r.key=!0,r.frame=!0;break;case 6:{a=!0;const i=new yi(xi(e.data));i.readUByte();let n=0,r=0,s=!1,o=0;for(;!s&&i.bytesAvailable>1;){n=0;do{o=i.readUByte(),n+=o}while(255===o);r=0;do{o=i.readUByte(),r+=o}while(255===o);if(4===n&&0!==i.bytesAvailable){s=!0;if(181===i.readUByte()){if(49===i.readUShort()){if(1195456820===i.readUInt()){if(3===i.readUByte()){const e=i.readUByte(),n=31&e,a=[e,i.readUByte()];for(let t=0;t<n;t++)a.push(i.readUByte()),a.push(i.readUByte()),a.push(i.readUByte());ki(this._txtTrack.samples,{type:3,pts:t.pts,bytes:a})}}}}}else if(5===n&&0!==i.bytesAvailable){if(s=!0,r>16){const e=[];for(let t=0;t<16;t++)e.push(i.readUByte().toString(16)),3!==t&&5!==t&&7!==t&&9!==t||e.push("-");const a=r-16,s=new Uint8Array(a);for(let t=0;t<a;t++)s[t]=i.readUByte();ki(this._txtTrack.samples,{pts:t.pts,payloadType:n,uuid:e.join(""),userData:$t(s),userDataBytes:s})}}else if(r<i.bytesAvailable)for(let t=0;t<r;t++)i.readUByte()}break}case 7:if(a=!0,s=!0,!i.sps){const t=new yi(e.data).readSPS();i.width=t.width,i.height=t.height,i.pixelRatio=t.pixelRatio,i.sps=[e.data],i.duration=this._duration;const n=e.data.subarray(1,4);let a="avc1.";for(let e=0;e<3;e++){let t=n[e].toString(16);t.length<2&&(t="0"+t),a+=t}i.codec=a}break;case 8:a=!0,i.pps||(i.pps=[e.data]);break;case 9:a=!1,i.audFound=!0,r&&Ri(r,i),r=this.avcSample=Li(!1,t.pts,t.dts,"");break;case 12:a=!1;break;default:a=!1,r&&(r.debug+="unknown NAL "+e.type+" ")}if(r&&a){r.units.push(e)}})),e&&r&&(Ri(r,i),this.avcSample=null)}getLastNalUnit(){let t,e=this.avcSample;if(!e||0===e.units.length){const t=this._avcTrack.samples;e=t[t.length-1]}if(null==e?void 0:e.units){const i=e.units;t=i[i.length-1]}return t}parseAVCNALu(t){const e=t.byteLength,i=this._avcTrack;let n=i.naluState||0;const a=n,r=[];let s,o,l,d=0,u=-1,h=0;for(-1===n&&(u=0,h=31&t[0],n=0,d=1);d<e;)if(s=t[d++],n)if(1!==n)if(s)if(1===s){if(u>=0){const e={data:t.subarray(u,d-n-1),type:h};r.push(e)}else{const e=this.getLastNalUnit();if(e&&(a&&d<=4-a&&e.state&&(e.data=e.data.subarray(0,e.data.byteLength-a)),o=d-n-1,o>0)){const i=new Uint8Array(e.data.byteLength+o);i.set(e.data,0),i.set(t.subarray(0,o),e.data.byteLength),e.data=i}}d<e?(l=31&t[d],u=d,h=l,n=0):n=-1}else n=0;else n=3;else n=s?0:2;else n=s?0:1;if(u>=0&&n>=0){const i={data:t.subarray(u,e),type:h,state:n};r.push(i)}if(0===r.length){const e=this.getLastNalUnit();if(e){const i=new Uint8Array(e.data.byteLength+t.byteLength);i.set(e.data,0),i.set(t,e.data.byteLength),e.data=i}}return i.naluState=n,r}parseAACPES(t){const e=this._audioTrack,i=this.aacLastPTS,n=this.aacOverFlow;let a,r,s=t.data;if(n){const t=new Uint8Array(n.byteLength+s.byteLength);t.set(n,0),t.set(s,n.byteLength),s=t}for(a=0,r=s.length;a<r-1&&!ti(s,a);a++);if(a){let t,e;if(a<r-1?(t=`AAC PES did not start with ADTS header,offset:${a}`,e=!1):(t="no ADTS header found in AAC PES",e=!0),W.warn(`parsing error:${t}`),this.observer.emit(w.ERROR,w.ERROR,{type:D.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:e,reason:t}),e)return}ii(e,this.observer,s,a,this.audioCodec);let o=0;const l=ni(e.samplerate);let d;if(void 0!==t.pts)d=t.pts;else{if(null===i)return void W.warn("[tsdemuxer]: AAC PES unknown PTS");d=i}if(n&&null!==i){const t=i+l;Math.abs(t-d)>1&&(W.log(`[tsdemuxer]: AAC: align PTS for overlapping frames by ${Math.round((t-d)/90)}`),d=t)}let u=null;for(;a<r;){if(ti(s,a)){if(a+5<r){const t=ai(e,s,a,d,o);if(t){a+=t.length,u=t.sample.pts,o++;continue}}break}a++}this.aacOverFlow=a<r?s.subarray(a,r):null,this.aacLastPTS=u}parseMPEGPES(t){const e=t.data,i=e.length;let n=0,a=0;const r=t.pts;if(void 0!==r)for(;a<i;)if(vi(e,a)){const t=fi(this._audioTrack,e,a,r,n);if(!t)break;a+=t.length,n++}else a++;else W.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(t){void 0!==t.pts?this._id3Track.samples.push(t):W.warn("[tsdemuxer]: ID3 PES unknown PTS")}},Ai=Si;function Li(t,e,i,n){return{key:t,frame:!1,pts:e,dts:i,units:[],debug:n,length:0}}function wi(t,e){return(31&t[e+10])<<8|t[e+11]}function Ci(t,e,i,n){const a={audio:-1,avc:-1,id3:-1,isAAC:!0},r=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<r;){const r=(31&t[e+1])<<8|t[e+2];switch(t[e]){case 207:if(!n){W.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===a.audio&&(a.audio=r);break;case 21:-1===a.id3&&(a.id3=r);break;case 219:if(!n){W.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===a.avc&&(a.avc=r);break;case 3:case 4:i?-1===a.audio&&(a.audio=r,a.isAAC=!1):W.log("MPEG audio found, not supported in this browser");break;case 36:W.warn("Unsupported HEVC stream type found")}e+=5+((15&t[e+3])<<8|t[e+4])}return a}function Di(t){let e,i,n,a,r,s=0;const o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&o.length>1;){const t=new Uint8Array(o[0].length+o[1].length);t.set(o[0]),t.set(o[1],o[0].length),o[0]=t,o.splice(1,1)}e=o[0];if(1===(e[0]<<16)+(e[1]<<8)+e[2]){if(i=(e[4]<<8)+e[5],i&&i>t.size-6)return null;const l=e[7];192&l&&(a=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&l?(r=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,a-r>54e5&&(W.warn(`${Math.round((a-r)/9e4)}s delta between PTS and DTS, align them`),a=r)):r=a),n=e[8];let d=n+9;if(t.size<=d)return null;t.size-=d;const u=new Uint8Array(t.size);for(let t=0,i=o.length;t<i;t++){e=o[t];let i=e.byteLength;if(d){if(d>i){d-=i;continue}e=e.subarray(d),i-=d,d=0}u.set(e,s),s+=i}return i&&(i-=n+3),{data:u,pts:a,dts:r,len:i}}return null}function Ri(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const i=e.samples,n=i.length;if(!n)return void e.dropped++;{const e=i[n-1];t.pts=e.pts,t.dts=e.dts}}e.samples.push(t)}t.debug.length&&W.log(t.pts+"/"+t.dts+":"+t.debug)}function ki(t,e){const i=t.length;if(i>0){if(e.pts>=t[i-1].pts)t.push(e);else for(let n=i-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)}function xi(t){const e=t.byteLength,i=[];let n=1;for(;n<e-2;)0===t[n]&&0===t[n+1]&&3===t[n+2]?(i.push(n+2),n+=2):n++;if(0===i.length)return t;const a=e-i.length,r=new Uint8Array(a);let s=0;for(n=0;n<a;s++,n++)s===i[0]&&(s++,i.shift()),r[n]=t[s];return r}Ai.minProbeByteLength=188;var Oi=Ai,Ii=class extends qe{resetInitSegment(t,e,i){super.resetInitSegment(t,e,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;let e=(Gt(t,0)||[]).length;for(let i=t.length;e<i;e++)if(Ti(t,e))return W.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return mi(t,e)&&4<=t.length-e}(t,e)}appendFrame(t,e,i){if(null!==this.initPTS)return fi(t,e,i,this.initPTS,this.frameIndex)}};Ii.minProbeByteLength=4;var _i=Ii,Fi=class{static getSilentFrame(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}},Ni=Math.pow(2,32)-1,Pi=class{static init(){let t;for(t in Pi.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Pi.types)Pi.types.hasOwnProperty(t)&&(Pi.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Pi.HDLR_TYPES={video:e,audio:i};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);Pi.STTS=Pi.STSC=Pi.STCO=a,Pi.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Pi.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Pi.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Pi.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const r=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Pi.FTYP=Pi.box(Pi.types.ftyp,r,o,r,s),Pi.DINF=Pi.box(Pi.types.dinf,Pi.box(Pi.types.dref,n))}static box(t,...e){let i=8,n=e.length;const a=n;for(;n--;)i+=e[n].byteLength;const r=new Uint8Array(i);for(r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(t,4),n=0,i=8;n<a;n++)r.set(e[n],i),i+=e[n].byteLength;return r}static hdlr(t){return Pi.box(Pi.types.hdlr,Pi.HDLR_TYPES[t])}static mdat(t){return Pi.box(Pi.types.mdat,t)}static mdhd(t,e){e*=t;const i=Math.floor(e/(Ni+1)),n=Math.floor(e%(Ni+1));return Pi.box(Pi.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(t){return Pi.box(Pi.types.mdia,Pi.mdhd(t.timescale,t.duration),Pi.hdlr(t.type),Pi.minf(t))}static mfhd(t){return Pi.box(Pi.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?Pi.box(Pi.types.minf,Pi.box(Pi.types.smhd,Pi.SMHD),Pi.DINF,Pi.stbl(t)):Pi.box(Pi.types.minf,Pi.box(Pi.types.vmhd,Pi.VMHD),Pi.DINF,Pi.stbl(t))}static moof(t,e,i){return Pi.box(Pi.types.moof,Pi.mfhd(t),Pi.traf(i,e))}static moov(t){let e=t.length;const i=[];for(;e--;)i[e]=Pi.trak(t[e]);return Pi.box.apply(null,[Pi.types.moov,Pi.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(Pi.mvex(t)))}static mvex(t){let e=t.length;const i=[];for(;e--;)i[e]=Pi.trex(t[e]);return Pi.box.apply(null,[Pi.types.mvex,...i])}static mvhd(t,e){e*=t;const i=Math.floor(e/(Ni+1)),n=Math.floor(e%(Ni+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Pi.box(Pi.types.mvhd,a)}static sdtp(t){const e=t.samples||[],i=new Uint8Array(4+e.length);let n,a;for(n=0;n<e.length;n++)a=e[n].flags,i[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return Pi.box(Pi.types.sdtp,i)}static stbl(t){return Pi.box(Pi.types.stbl,Pi.stsd(t),Pi.box(Pi.types.stts,Pi.STTS),Pi.box(Pi.types.stsc,Pi.STSC),Pi.box(Pi.types.stsz,Pi.STSZ),Pi.box(Pi.types.stco,Pi.STCO))}static avc1(t){let e,i,n,a=[],r=[];for(e=0;e<t.sps.length;e++)i=t.sps[e],n=i.byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(i));for(e=0;e<t.pps.length;e++)i=t.pps[e],n=i.byteLength,r.push(n>>>8&255),r.push(255&n),r=r.concat(Array.prototype.slice.call(i));const s=Pi.box(Pi.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(r))),o=t.width,l=t.height,d=t.pixelRatio[0],u=t.pixelRatio[1];return Pi.box(Pi.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,Pi.box(Pi.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Pi.box(Pi.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(t){const e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))}static mp4a(t){const e=t.samplerate;return Pi.box(Pi.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]),Pi.box(Pi.types.esds,Pi.esds(t)))}static mp3(t){const e=t.samplerate;return Pi.box(Pi.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]))}static stsd(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?Pi.box(Pi.types.stsd,Pi.STSD,Pi.mp4a(t)):Pi.box(Pi.types.stsd,Pi.STSD,Pi.mp3(t)):Pi.box(Pi.types.stsd,Pi.STSD,Pi.avc1(t))}static tkhd(t){const e=t.id,i=t.duration*t.timescale,n=t.width,a=t.height,r=Math.floor(i/(Ni+1)),s=Math.floor(i%(Ni+1));return Pi.box(Pi.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))}static traf(t,e){const i=Pi.sdtp(t),n=t.id,a=Math.floor(e/(Ni+1)),r=Math.floor(e%(Ni+1));return Pi.box(Pi.types.traf,Pi.box(Pi.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),Pi.box(Pi.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,r>>24,r>>16&255,r>>8&255,255&r])),Pi.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,Pi.box(Pi.types.trak,Pi.tkhd(t),Pi.mdia(t))}static trex(t){const e=t.id;return Pi.box(Pi.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const i=t.samples||[],n=i.length,a=12+16*n,r=new Uint8Array(a);let s,o,l,d,u,h;for(e+=8+a,r.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),s=0;s<n;s++)o=i[s],l=o.duration,d=o.size,u=o.flags,h=o.cts,r.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,d>>>24&255,d>>>16&255,d>>>8&255,255&d,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*s);return Pi.box(Pi.types.trun,r)}static initSegment(t){Pi.types||Pi.init();const e=Pi.moov(t),i=new Uint8Array(Pi.FTYP.byteLength+e.byteLength);return i.set(Pi.FTYP),i.set(e,Pi.FTYP.byteLength),i}},Mi=Pi;function Bi(t,e=!1){return function(t,e,i=1,n=!1){const a=t*e*i;return n?Math.round(a):a}(t,1e3,1/9e4,e)}var Ui=null,Gi=null,Hi=!1,Vi=class{constructor(t,e,i,n=""){if(this.ISGenerated=!1,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=t,this.config=e,this.typeSupported=i,this.ISGenerated=!1,null===Ui){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ui=t?parseInt(t[1]):0}if(null===Gi){const t=navigator.userAgent.match(/Safari\/(\d+)/i);Gi=t?parseInt(t[1]):0}Hi=!!Ui&&Ui<75||!!Gi&&Gi<600}destroy(){}resetTimeStamp(t){W.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){W.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){W.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(t){let e=!1;const i=t.reduce(((t,i)=>{const n=i.pts-t;return n<-4294967296?(e=!0,Ki(t,i.pts)):n>0?t:i.pts}),t[0].pts);return e&&W.debug("PTS rollover detected"),i}remux(t,e,i,n,a,r,s){let o,l,d,u,h,c,g=a,f=a;const p=t.pid>-1,m=e.pid>-1,v=t.samples.length>0,T=e.samples.length>1;if((!p||v)&&(!m||T)||this.ISGenerated||s){this.ISGenerated||(d=this.generateIS(t,e,a));const i=this.isVideoContiguous;if(T&&!i&&this.config.forceKeyFrameOnDiscontinuity){const t=e.samples.length,i=function(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples);if(c=!0,i>0){W.warn(`[mp4-remuxer]: Dropped ${i} out of ${t} video samples due to a missing keyframe`);const n=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(i),e.dropped+=i,f+=(e.samples[0].pts-n)/(e.timescale||9e4)}else-1===i&&(W.warn(`[mp4-remuxer]: No keyframe found out of ${t} video samples`),c=!1)}if(this.ISGenerated){if(v&&T){const i=this.getVideoStartPts(e.samples),n=(Ki(t.samples[0].pts,i)-i)/e.inputTimeScale;g+=Math.max(0,n),f+=Math.max(0,-n)}if(v){if(t.samplerate||(W.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(t,e,a),delete d.video),l=this.remuxAudio(t,g,this.isAudioContiguous,r,T?f:void 0),T){const n=l?l.endPTS-l.startPTS:0;e.inputTimeScale||(W.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(t,e,a)),o=this.remuxVideo(e,f,i,n)}}else T&&(o=this.remuxVideo(e,f,i,0));o&&void 0!==c&&(o.independent=c)}}return this.ISGenerated&&(i.samples.length&&(h=this.remuxID3(i,a)),n.samples.length&&(u=this.remuxText(n,a))),{audio:l,video:o,initSegment:d,independent:c,text:u,id3:h}}generateIS(t,e,i){const n=t.samples,a=e.samples,r=this.typeSupported,s={},o=!Number.isFinite(this._initPTS);let l,d,u,h="audio/mp4";if(o&&(l=d=1/0),t.config&&n.length&&(t.timescale=t.samplerate,t.isAAC||(r.mpeg?(h="audio/mpeg",t.codec=""):r.mp3&&(t.codec="mp3")),s.audio={id:"audio",container:h,codec:t.codec,initSegment:!t.isAAC&&r.mpeg?new Uint8Array(0):Mi.initSegment([t]),metadata:{channelCount:t.channelCount}},o&&(u=t.inputTimeScale,l=d=n[0].pts-Math.round(u*i))),e.sps&&e.pps&&a.length&&(e.timescale=e.inputTimeScale,s.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:Mi.initSegment([e]),metadata:{width:e.width,height:e.height}},o)){u=e.inputTimeScale;const t=this.getVideoStartPts(a),n=Math.round(u*i);d=Math.min(d,Ki(a[0].dts,t)-n),l=Math.min(l,t-n)}if(Object.keys(s).length)return this.ISGenerated=!0,o&&(this._initPTS=l,this._initDTS=d),{tracks:s,initPTS:l,timescale:u}}remuxVideo(t,e,i,n){const a=t.inputTimeScale,r=t.samples,s=[],o=r.length,l=this._initPTS;let d,u,h,c=this.nextAvcDts,g=8,f=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,m=0,v=!1;if(!i||null===c){c=e*a-(r[0].pts-Ki(r[0].dts,r[0].pts))}for(let w=0;w<o;w++){const t=r[w];if(t.pts=Ki(t.pts-l,c),t.dts=Ki(t.dts-l,c),t.dts>t.pts){const e=18e3;m=Math.max(Math.min(m,t.pts-t.dts),-1*e)}t.dts<r[w>0?w-1:w].dts&&(v=!0)}v&&r.sort((function(t,e){const i=t.dts-e.dts,n=t.pts-e.pts;return i||n})),u=r[0].dts,h=r[r.length-1].dts;const T=Math.round((h-u)/(o-1));if(m<0){if(m<-2*T){W.warn(`PTS < DTS detected in video samples, offsetting DTS from PTS by ${Bi(-T,!0)} ms`);let t=m;for(let e=0;e<o;e++)r[e].dts=t=Math.max(t,r[e].pts-T),r[e].pts=Math.max(t,r[e].pts)}else{W.warn(`PTS < DTS detected in video samples, shifting DTS by ${Bi(m,!0)} ms to overcome this issue`);for(let t=0;t<o;t++)r[t].dts=r[t].dts+m}u=r[0].dts}if(i){const t=u-c,e=t>T,i=t<-1;if(e||i){e?W.warn(`AVC: ${Bi(t,!0)} ms (${t}dts) hole between fragments detected, filling it`):W.warn(`AVC: ${Bi(-t,!0)} ms (${t}dts) overlapping between fragments detected`),u=c;const i=r[0].pts-t;r[0].dts=u,r[0].pts=i,W.log(`Video: First PTS/DTS adjusted: ${Bi(i,!0)}/${Bi(u,!0)}, delta: ${Bi(t,!0)} ms`)}}Hi&&(u=Math.max(0,u));let y=0,E=0;for(let w=0;w<o;w++){const t=r[w],e=t.units,i=e.length;let n=0;for(let a=0;a<i;a++)n+=e[a].data.length;E+=n,y+=i,t.length=n,t.dts=Math.max(t.dts,u),t.pts=Math.max(t.pts,t.dts,0),f=Math.min(t.pts,f),p=Math.max(t.pts,p)}h=r[o-1].dts;const b=E+4*y+8;let S;try{S=new Uint8Array(b)}catch(C){return void this.observer.emit(w.ERROR,w.ERROR,{type:D.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,bytes:b,reason:`fail allocating video mdat ${b}`})}const A=new DataView(S.buffer);A.setUint32(0,b),S.set(Mi.types.mdat,4);for(let w=0;w<o;w++){const t=r[w],e=t.units;let i=0;for(let n=0,a=e.length;n<a;n++){const t=e[n],a=t.data,r=t.data.byteLength;A.setUint32(g,r),g+=4,S.set(a,g),g+=r,i+=4+r}if(w<o-1)d=r[w+1].dts-t.dts;else{const e=this.config,i=t.dts-r[w>0?w-1:w].dts;if(e.stretchShortVideoTrack&&null!==this.nextAudioPts){const r=Math.floor(e.maxBufferHole*a),s=(n?f+n*a:this.nextAudioPts)-t.pts;s>r?(d=s-i,d<0&&(d=i),W.log(`[mp4-remuxer]: It is approximately ${s/90} ms to the next segment; using duration ${d/90} ms for the last video frame.`)):d=i}else d=i}const l=Math.round(t.pts-t.dts);s.push(new ji(t.key,d,i,l))}if(s.length&&Ui&&Ui<70){const t=s[0].flags;t.dependsOn=2,t.isNonSync=0}console.assert(void 0!==d,"mp4SampleDuration must be computed"),this.nextAvcDts=c=h+d,this.isVideoContiguous=!0;const L={data1:Mi.moof(t.sequenceNumber++,u,Object.assign({},t,{samples:s})),data2:S,startPTS:f/a,endPTS:(p+d)/a,startDTS:u/a,endDTS:c/a,type:"video",hasAudio:!1,hasVideo:!0,nb:s.length,dropped:t.dropped};return t.samples=[],t.dropped=0,console.assert(S.length,"MDAT length must not be zero"),L}remuxAudio(t,e,i,n,a){const r=t.inputTimeScale,s=r/(t.samplerate?t.samplerate:r),o=t.isAAC?1024:1152,l=o*s,d=this._initPTS,u=!t.isAAC&&this.typeSupported.mpeg,h=[];let c,g=t.samples,f=u?0:8,p=this.nextAudioPts||-1;const m=e*r;if(this.isAudioContiguous=i=i||g.length&&p>0&&(n&&Math.abs(m-p)<9e3||Math.abs(Ki(g[0].pts-d,m)-p)<20*l),g.forEach((function(t){t.pts=t.dts=Ki(t.pts-d,m)})),!i||p<0){if(g=g.filter((t=>t.pts>=0)),!g.length)return;p=0===a?0:n?Math.max(0,m):g[0].pts}if(t.isAAC){const e=this.config.maxAudioFramesDrift;for(let n=0,s=p;n<g.length;){const o=g[n],d=o.pts,u=d-s,h=Math.abs(1e3*u/r);if(u<=-e*l&&void 0!==a)i||n>0?(W.warn(`[mp4-remuxer]: Dropping 1 audio frame @ ${(s/r).toFixed(3)}s due to ${Math.round(h)} ms overlap.`),g.splice(n,1)):(W.warn(`Audio frame @ ${(d/r).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*u/r)} ms.`),s=d+l,n++);else if(u>=e*l&&h<1e4&&void 0!==a){const e=Math.floor(u/l);s=d-e*l,W.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(s/r).toFixed(3)}s due to ${Math.round(1e3*u/r)} ms gap.`);for(let i=0;i<e;i++){const e=Math.max(s,0);c=Fi.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(W.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),c=o.unit.subarray()),g.splice(n,0,{unit:c,pts:e,dts:e}),s+=l,n++}o.pts=o.dts=s,s+=l,n++}else o.pts=o.dts=s,s+=l,n++}}let v,T=null,y=null,E=0,b=g.length;for(;b--;)E+=g[b].unit.byteLength;for(let I=0,_=g.length;I<_;I++){const e=g[I],n=e.unit;let a=e.pts;if(null!==y){h[I-1].duration=Math.round((a-y)/s)}else{const e=Math.round(1e3*(a-p)/r);let s=0;if(i&&t.isAAC){if(e>0&&e<1e4)s=Math.round((a-p)/l),W.log(`[mp4-remuxer]: ${e} ms hole between AAC samples detected,filling it`),s>0&&(c=Fi.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(c=n.subarray()),E+=s*c.length);else if(e<-12){W.log(`[mp4-remuxer]: drop overlapping AAC sample, expected/parsed/delta:${(p/r).toFixed(3)}s/${(a/r).toFixed(3)}s/${-e}ms`),E-=n.byteLength;continue}a=p}if(T=a,!(E>0))return;E+=f;try{v=new Uint8Array(E)}catch(O){return void this.observer.emit(w.ERROR,w.ERROR,{type:D.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,bytes:E,reason:`fail allocating audio mdat ${E}`})}if(!u){new DataView(v.buffer).setUint32(0,E),v.set(Mi.types.mdat,4)}for(let i=0;i<s;i++)c=Fi.getSilentFrame(t.manifestCodec||t.codec,t.channelCount),c||(W.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating the current frame instead"),c=n.subarray()),v.set(c,f),f+=c.byteLength,h.push(new ji(!0,1024,c.byteLength,0))}v.set(n,f);const d=n.byteLength;f+=d,h.push(new ji(!0,o,d,0)),y=a}const S=h.length;if(!S)return;const A=h[h.length-1];this.nextAudioPts=p=y+s*A.duration;const L=u?new Uint8Array(0):Mi.moof(t.sequenceNumber++,T/s,Object.assign({},t,{samples:h}));t.samples=[];const C=T/r,R=p/r,x={data1:L,data2:v,startPTS:C,endPTS:R,startDTS:C,endDTS:R,type:"audio",hasAudio:!0,hasVideo:!1,nb:S};return this.isAudioContiguous=!0,console.assert(v.length,"MDAT length must not be zero"),x}remuxEmptyAudio(t,e,i,n){const a=t.inputTimeScale,r=a/(t.samplerate?t.samplerate:a),s=this.nextAudioPts,o=(null!==s?s:n.startDTS*a)+this._initDTS,l=n.endDTS*a+this._initDTS,d=1024*r,u=Math.ceil((l-o)/d),h=Fi.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(W.warn("[mp4-remuxer]: remux empty Audio"),!h)return void W.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const c=[];for(let g=0;g<u;g++){const t=o+g*d;c.push({unit:h,pts:t,dts:t})}return t.samples=c,this.remuxAudio(t,e,i,!1)}remuxID3(t,e){const i=t.samples.length;if(!i)return;const n=t.inputTimeScale,a=this._initPTS,r=this._initDTS;for(let o=0;o<i;o++){const i=t.samples[o];i.pts=Ki(i.pts-a,e*n)/n,i.dts=Ki(i.dts-r,e*n)/n}const s=t.samples;return t.samples=[],{samples:s}}remuxText(t,e){const i=t.samples.length;if(!i)return;const n=t.inputTimeScale,a=this._initPTS;for(let s=0;s<i;s++){const i=t.samples[s];i.pts=Ki(i.pts-a,e*n)/n}t.samples.sort(((t,e)=>t.pts-e.pts));const r=t.samples;return t.samples=[],{samples:r}}};function Ki(t,e){let i;if(null===e)return t;for(i=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=i;return t}var ji=class{constructor(t,e,i,n){this.duration=e,this.size=i,this.cts=n,this.flags=new Xi(t)}},Xi=class{constructor(t){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=t?2:1,this.isNonSync=t?0:1}},Wi=(t,e,i)=>function(t,e){return lt(e,["moof","traf"]).reduce(((e,i)=>{const n=lt(i,["tfdt"])[0],a=n.data[n.start],r=lt(i,["tfhd"]).reduce(((e,i)=>{const r=st(i,4),s=t[r];if(s){let t=st(n,4);1===a&&(t*=Math.pow(2,32),t+=st(n,8));const i=t/(s.timescale||9e4);if(isFinite(i)&&(null===e||i<e))return i}return e}),null);return null!==r&&isFinite(r)&&(null===e||r<e)?r:e}),null)||0}(t,e)-i;function Yi(t,e){const i=null==t?void 0:t.codec;return i&&i.length>4?i:"hvc1"===i?"hvc1.1.c.L120.90":"av01"===i?"av01.0.04M.08":"avc1"===i||e===J.VIDEO?"avc1.42e01e":"mp4a.40.5"}var Ji,zi=class{constructor(){this.emitInitSegment=!1,this.lastEndDTS=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndDTS=null}resetNextTimestamp(){this.lastEndDTS=null}resetInitSegment(t,e,i){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(t),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:i}=this;if(!t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const n=this.initData=function(t){const e=[],i=lt(t,["moov","trak"]);for(let n=0;n<i.length;n++){const t=i[n],a=lt(t,["tkhd"])[0];if(a){let i=a.data[a.start],n=0===i?12:20;const r=st(a,n),s=lt(t,["mdia","mdhd"])[0];if(s){i=s.data[s.start],n=0===i?12:20;const a=st(s,n),o=lt(t,["mdia","hdlr"])[0];if(o){const i=rt(o.data.subarray(o.start+8,o.start+12)),n={soun:J.AUDIO,vide:J.VIDEO}[i];if(n){const i=lt(t,["mdia","minf","stbl","stsd"])[0];let s;i&&(s=rt(i.data.subarray(i.start+12,i.start+16))),e[r]={timescale:a,type:n},e[n]={timescale:a,id:r,codec:s}}}}}}return lt(t,["moov","mvex","trex"]).forEach((t=>{const i=st(t,4),n=e[i];n&&(n.default={duration:st(t,12),flags:st(t,20)})})),e}(t);e||(e=Yi(n.audio,J.AUDIO)),i||(i=Yi(n.video,J.VIDEO));const a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:e+","+i,initSegment:t,id:"main"}:n.audio?a.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:n.video?a.video={container:"video/mp4",codec:i,initSegment:t,id:"main"}:W.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(t,e,i,n,a){let{initPTS:r,lastEndDTS:s}=this;const o={audio:void 0,video:void 0,text:n,id3:i,initSegment:void 0};Number.isFinite(s)||(s=this.lastEndDTS=a||0);const l=e.samples;if(!l||!l.length)return o;const d={initPTS:void 0,timescale:1};let u=this.initData;if(u&&u.length||(this.generateInitSegment(l),u=this.initData),!u||!u.length)return W.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),o;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1),Number.isFinite(r)||(this.initPTS=d.initPTS=r=Wi(u,l,s));const h=function(t,e){let i=0,n=0,a=0;const r=lt(t,["moof","traf"]);for(let s=0;s<r.length;s++){const t=r[s],o=lt(t,["tfhd"])[0],l=e[st(o,4)];if(!l)continue;const d=l.default,u=st(o,0)|(null==d?void 0:d.flags);let h=null==d?void 0:d.duration;8&u&&(h=st(o,2&u?12:8));const c=l.timescale||9e4,g=lt(t,["trun"]);for(let e=0;e<g.length;e++)i=h?h*st(g[e],4):ut(g[e]),l.type===J.VIDEO?n+=i/c:l.type===J.AUDIO&&(a+=i/c)}if(0===n&&0===a){const e=dt(t);if(null==e?void 0:e.references)return e.references.reduce(((t,e)=>t+e.info.duration||0),0)}return n||a}(l,u),c=s,g=h+c;!function(t,e,i){lt(e,["moof","traf"]).forEach((function(e){lt(e,["tfhd"]).forEach((function(n){const a=st(n,4),r=t[a];if(!r)return;const s=r.timescale||9e4;lt(e,["tfdt"]).forEach((function(t){const e=t.data[t.start];let n=st(t,4);if(0===e)ot(t,4,n-i*s);else{n*=Math.pow(2,32),n+=st(t,8),n-=i*s,n=Math.max(n,0);const e=Math.floor(n/(nt+1)),a=Math.floor(n%(nt+1));ot(t,4,e),ot(t,8,a)}}))}))}))}(u,l,r),h>0?this.lastEndDTS=g:(W.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const f=!!u.audio,p=!!u.video;let m="";f&&(m+="audio"),p&&(m+="video");const v={data1:l,startPTS:c,startDTS:c,endPTS:g,endDTS:g,type:m,hasAudio:f,hasVideo:p,nb:1,dropped:0};return o.audio="audio"===v.type?v:void 0,o.video="audio"!==v.type?v:void 0,o.text=n,o.id3=i,o.initSegment=d,o}},qi=class{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let i;return t.length?(i=1===t.length?t[0]:function(t,e){const i=new Uint8Array(e);let n=0;for(let a=0;a<t.length;a++){const e=t[a];i.set(e,n),n+=e.length}return i}(t,e),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}};try{Ji=self.performance.now.bind(self.performance)}catch(Qn){W.debug("Unable to use Performance API on this environment"),Ji=self.Date.now}var $i=[{demux:Oi,remux:Vi},{demux:li,remux:zi},{demux:si,remux:Vi},{demux:_i,remux:Vi}],Zi=1024;$i.forEach((({demux:t})=>{Zi=Math.max(Zi,t.minProbeByteLength)}));var Qi=class{constructor(t,e,i,n){this.decryptionPromise=null,this.cache=new qi,this.observer=t,this.typeSupported=e,this.config=i,this.vendor=n}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,n){const a=i.transmuxing;a.executeStart=Ji();let r=new Uint8Array(t);const{cache:s,config:o,currentTransmuxState:l,transmuxConfig:d}=this;n&&(this.currentTransmuxState=n);const u=function(t,e){let i=null;t.byteLength>0&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(i=e);return i}(r,e);if(u&&"AES-128"===u.method){const t=this.getDecrypter();if(!o.enableSoftwareAES)return this.decryptionPromise=t.webCryptoDecrypt(r,u.key.buffer,u.iv.buffer).then((t=>{const e=this.push(t,null,i);return this.decryptionPromise=null,e})),this.decryptionPromise;{const e=t.softwareDecrypt(r,u.key.buffer,u.iv.buffer);if(!e)return a.executeEnd=Ji(),tn(i);r=new Uint8Array(e)}}const{contiguous:h,discontinuity:c,trackSwitch:g,accurateTimeOffset:f,timeOffset:p}=n||l,{audioCodec:m,videoCodec:v,defaultInitPts:T,duration:y,initSegmentData:E}=d;if((c||g)&&this.resetInitSegment(E,m,v,y),c&&this.resetInitialTimestamp(T),h||this.resetContiguity(),this.needsProbing(r,c,g)){if(s.dataLength){r=ht(s.flush(),r)}this.configureTransmuxer(r,d)}const b=this.transmux(r,u,p,f,i),S=this.currentTransmuxState;return S.contiguous=!0,S.discontinuity=!1,S.trackSwitch=!1,a.executeEnd=Ji(),b}flush(t){const e=t.transmuxing;e.executeStart=Ji();const{decrypter:i,cache:n,currentTransmuxState:a,decryptionPromise:r}=this;if(r)return r.then((()=>this.flush(t)));const s=[],{timeOffset:o}=a;if(i){const e=i.flush();e&&s.push(this.push(e,null,t))}const l=n.dataLength;n.reset();const{demuxer:d,remuxer:u}=this;if(!d||!u)return l>=Zi&&this.observer.emit(w.ERROR,w.ERROR,{type:D.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),e.executeEnd=Ji(),[tn(t)];const h=d.flush(o);return en(h)?h.then((e=>(this.flushRemux(s,e,t),s))):(this.flushRemux(s,h,t),s)}flushRemux(t,e,i){const{audioTrack:n,avcTrack:a,id3Track:r,textTrack:s}=e,{accurateTimeOffset:o,timeOffset:l}=this.currentTransmuxState;W.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const d=this.remuxer.remux(n,a,r,s,l,o,!0);t.push({remuxResult:d,chunkMeta:i}),i.transmuxing.executeEnd=Ji()}resetInitialTimestamp(t){const{demuxer:e,remuxer:i}=this;e&&i&&(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,n){const{demuxer:a,remuxer:r}=this;a&&r&&(a.resetInitSegment(e,i,n),r.resetInitSegment(t,e,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,n,a){let r;return r=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,i,n,a):this.transmuxUnencrypted(t,i,n,a),r}transmuxUnencrypted(t,e,i,n){const{audioTrack:a,avcTrack:r,id3Track:s,textTrack:o}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,r,s,o,e,i,!1),chunkMeta:n}}transmuxSampleAes(t,e,i,n,a){return this.demuxer.demuxSampleAes(t,e,i).then((t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.avcTrack,t.id3Track,t.textTrack,i,n,!1),chunkMeta:a})))}configureTransmuxer(t,e){const{config:i,observer:n,typeSupported:a,vendor:r}=this,{audioCodec:s,defaultInitPts:o,duration:l,initSegmentData:d,videoCodec:u}=e;let h;for(let m=0,v=$i.length;m<v;m++)if($i[m].demux.probe(t)){h=$i[m];break}h||(W.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),h={demux:li,remux:zi});const c=this.demuxer,g=this.remuxer,f=h.remux,p=h.demux;g&&g instanceof f||(this.remuxer=new f(n,i,a,r)),c&&c instanceof p||(this.demuxer=new p(n,i,a),this.probe=p.probe),this.resetInitSegment(d,s,u,l),this.resetInitialTimestamp(o)}needsProbing(t,e,i){return!this.demuxer||!this.remuxer||e||i}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new _e(this.observer,this.config)),t}};var tn=t=>({remuxResult:{},chunkMeta:t});function en(t){return"then"in t&&t.then instanceof Function}var nn,an,rn=B(G()),sn=Ye()||{isTypeSupported:()=>!1},on=class{constructor(t,e,i,n){this.frag=null,this.part=null,this.transmuxer=null,this.hls=t,this.id=e,this.onTransmuxComplete=i,this.onFlush=n;const a=t.config,r=(e,i)=>{(i=i||{}).frag=this.frag,i.id=this.id,t.trigger(e,i)};this.observer=new rn.EventEmitter,this.observer.on(w.FRAG_DECRYPTED,r),this.observer.on(w.ERROR,r);const s={mp4:sn.isTypeSupported("video/mp4"),mpeg:sn.isTypeSupported("audio/mpeg"),mp3:sn.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;this.transmuxer=new Qi(this.observer,s,a,o)}destroy(){const t=this.worker;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.worker=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.observer=null}push(t,e,i,n,a,r,s,o,l,d){l.transmuxing.start=self.performance.now();const{transmuxer:u,worker:h}=this,c=r?r.start:a.start,g=a.decryptdata,f=this.frag,p=!(f&&a.cc===f.cc),m=!(f&&l.level===f.level),v=f?l.sn-f.sn:-1,T=this.part?l.part-this.part.index:1,y=!m&&(1===v||0===v&&1===T),E=self.performance.now();(m||v||0===a.stats.parsing.start)&&(a.stats.parsing.start=E),!r||!T&&y||(r.stats.parsing.start=E);const b=new class{constructor(t,e,i,n,a){this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=n,this.timeOffset=a}}(p,y,o,m,c);if(!y||p){W.log(`[transmuxer-interface, ${a.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${p}\n        trackSwitch: ${m}\n        contiguous: ${y}\n        accurateTimeOffset: ${o}\n        timeOffset: ${c}`);const t=new class{constructor(t,e,i,n,a){this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=n,this.defaultInitPts=a}}(i,n,e,s,d);this.configureTransmuxer(t)}if(this.frag=a,this.part=r,h)h.postMessage({cmd:"demux",data:t,decryptdata:g,chunkMeta:l,state:b},t instanceof ArrayBuffer?[t]:[]);else if(u){const e=u.push(t,g,l,b);en(e)?e.then((t=>{this.handleTransmuxComplete(t)})):this.handleTransmuxComplete(e)}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:e,worker:i}=this;if(i)i.postMessage({cmd:"flush",chunkMeta:t});else if(e){const i=e.flush(t);en(i)?i.then((e=>{this.handleFlushResult(e,t)})):this.handleFlushResult(i,t)}}handleFlushResult(t,e){t.forEach((t=>{this.handleTransmuxComplete(t)})),this.onFlush(e)}onWorkerMessage(t){const e=t.data,i=this.hls;switch(e.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,i.trigger(e.event,e.data)}}configureTransmuxer(t){const{worker:e,transmuxer:i}=this;e?e.postMessage({cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}},ln=class{constructor(t,e,i,n){this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=e,this.fragmentTracker=i,this.hls=n}destroy(){this.hls=this.fragmentTracker=this.media=null}poll(t){var e;const{config:i,media:n,stalled:a}=this,{currentTime:r,seeking:s}=n,o=this.seeking&&!s,l=!this.seeking&&s;if(this.seeking=s,r!==t){if(this.moved=!0,null!==a){if(this.stallReported){const t=self.performance.now()-a;W.warn(`playback not stuck anymore @${r}, after ${Math.round(t)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((l||o)&&(this.stalled=null),n.paused||n.ended||0===n.playbackRate||!Te.getBuffered(n).length)return;const d=Te.bufferInfo(n,r,0),u=d.len>0,h=d.nextStart||0;if(!u&&!h)return;if(s){const t=d.len>2,e=!h||h-r>2&&!this.fragmentTracker.getPartialFragment(r);if(t||e)return;this.moved=!1}if(!this.moved&&null!==this.stalled){const t=Math.max(h,d.start||0)-r,i=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=(null==(e=null==i?void 0:i.details)?void 0:e.live)?2*i.details.targetduration:2;if(t>0&&t<=n)return void this._trySkipBufferHole(null)}const c=self.performance.now();if(null===a)return void(this.stalled=c);const g=c-a;!s&&g>=250&&this._reportStall(d.len);const f=Te.bufferInfo(n,r,i.maxBufferHole);this._tryFixBufferStall(f,g)}_tryFixBufferStall(t,e){const{config:i,fragmentTracker:n,media:a}=this,r=a.currentTime,s=n.getPartialFragment(r);if(s){if(this._trySkipBufferHole(s))return}t.len>i.maxBufferHole&&e>1e3*i.highBufferWatchdogPeriod&&(W.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:e,media:i,stallReported:n}=this;n||(this.stallReported=!0,W.warn(`Playback stalling at @${i.currentTime} due to low buffer (buffer=${t})`),e.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,fatal:!1,buffer:t}))}_trySkipBufferHole(t){const{config:e,hls:i,media:n}=this,a=n.currentTime;let r=0;const s=Te.getBuffered(n);for(let o=0;o<s.length;o++){const l=s.start(o);if(a+e.maxBufferHole>=r&&a<l){const e=Math.max(l+.05,n.currentTime+.1);return W.warn(`skipping hole, adjusting currentTime from ${a} to ${e}`),this.moved=!0,this.stalled=null,n.currentTime=e,t&&i.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:`fragment loaded with buffer holes, seeking from ${a} to ${e}`,frag:t}),e}r=s.end(o)}return 0}_tryNudgeBuffer(){const{config:t,hls:e,media:i}=this,n=i.currentTime,a=(this.nudgeRetry||0)+1;if(this.nudgeRetry=a,a<t.nudgeMaxRetry){const r=n+a*t.nudgeOffset;W.warn(`Nudging 'currentTime' from ${n} to ${r}`),i.currentTime=r,e.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_NUDGE_ON_STALL,fatal:!1})}else W.error(`Playhead still not moving while enough data buffered @${n} after ${t.nudgeMaxRetry} nudges`),e.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,fatal:!0})}},dn=class extends We{constructor(t,e){super(t,e,"[stream-controller]"),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.stalled=!1,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(w.MANIFEST_LOADING,this.onManifestLoading,this),t.on(w.MANIFEST_PARSED,this.onManifestParsed,this),t.on(w.LEVEL_LOADING,this.onLevelLoading,this),t.on(w.LEVEL_LOADED,this.onLevelLoaded,this),t.on(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(w.ERROR,this.onError,this),t.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(w.BUFFER_CREATED,this.onBufferCreated,this),t.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(w.MANIFEST_LOADING,this.onManifestLoading,this),t.off(w.MANIFEST_PARSED,this.onManifestParsed,this),t.off(w.LEVEL_LOADED,this.onLevelLoaded,this),t.off(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(w.ERROR,this.onError,this),t.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(w.BUFFER_CREATED,this.onBufferCreated,this),t.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(w.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(t){if(this.levels){const{lastCurrentTime:e,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){let t=i.startLevel;-1===t&&(i.config.testBandwidth?(t=0,this.bitrateTest=!0):t=i.nextAutoLevel),this.level=i.nextLoadLevel=t,this.loadedmetadata=!1}e>0&&-1===t&&(this.log(`Override startPosition with lastCurrentTime @${e.toFixed(3)}`),t=e),this.state=Pe,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=Ne}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){var t,e;switch(this.state){case Pe:this.doTickIdle();break;case Xe:{const{levels:e,level:i}=this,n=null==(t=null==e?void 0:e[i])?void 0:t.details;if(n&&(!n.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(n))break;this.state=Pe;break}break}case Ue:{const t=self.performance.now(),i=this.retryDate;(!i||t>=i||(null==(e=this.media)?void 0:e.seeking))&&(this.log("retryDate reached, switch back to IDLE state"),this.state=Pe)}}this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){var t,e;const{hls:i,levelLastLoaded:n,levels:a,media:r}=this,{config:s,nextLoadLevel:o}=i;if(null===n||!r&&(this.startFragRequested||!s.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;if(!a||!a[o])return;const l=a[o];this.level=i.nextLoadLevel=o;const d=l.details;if(!d||this.state===Xe||d.live&&this.levelLastLoaded!==o)return void(this.state=Xe);const u=this.getLoadPosition();if(!Number.isFinite(u))return;let h=d.initSegment,c=0;if(!h||h.data||this.bitrateTest){const t=l.maxBitrate;let e;e=t?Math.max(8*s.maxBufferSize/t,s.maxBufferLength):s.maxBufferLength,e=Math.min(e,s.maxMaxBufferLength);const i=u<s.maxBufferHole?Math.max(2,s.maxBufferHole):s.maxBufferHole,n=Te.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,u,i);if(n.len>=e)return;if(this._streamEnded(n,d)){const t={};return this.altAudio&&(t.type="video"),this.hls.trigger(w.BUFFER_EOS,t),void(this.state=Ke)}if(c=n.end,h=this.getNextFragment(c,d),h&&this.fragmentTracker.getState(h)===de.OK&&this.nextLoadPosition>c&&(h=this.getNextFragment(this.nextLoadPosition,d)),!h)return}"identity"!==(null==(t=h.decryptdata)?void 0:t.keyFormat)||(null==(e=h.decryptdata)?void 0:e.key)?this.loadFragment(h,d,c):this.loadKey(h,d)}loadFragment(t,e,i){var n;let a=this.fragmentTracker.getState(t);if(this.fragCurrent=t,a===de.BACKTRACKED){const e=this.fragmentTracker.getBacktrackData(t);if(e)return this._handleFragmentLoadProgress(e),void this._handleFragmentLoadComplete(e);a=de.NOT_LOADED}a===de.NOT_LOADED||a===de.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t):this.bitrateTest?(t.bitrateTest=!0,this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t)):(this.startFragRequested=!0,super.loadFragment(t,e,i)):a===de.APPENDING?this.reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t):0===(null==(n=this.media)?void 0:n.buffered.length)&&this.fragmentTracker.removeAllFragments()}getAppendedFrag(t){const e=this.fragmentTracker.getAppendedFrag(t,wt.MAIN);return e&&"fragment"in e?e.fragment:e}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,wt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null==e?void 0:e.readyState){let i;const n=this.getAppendedFrag(e.currentTime);if(n&&n.start>1&&this.flushMainBuffer(0,n.start-1),!e.paused&&t){const e=t[this.hls.nextLoadLevel],n=this.fragLastKbps;i=n&&this.fragCurrent?this.fragCurrent.duration*e.maxBitrate/(1e3*n)+1:0}else i=0;const a=this.getBufferedFrag(e.currentTime+i);if(a){const t=this.followingBufferedFrag(a);if(t){this.abortCurrentFrag();const e=t.maxStartPTS?t.maxStartPTS:t.start,i=t.duration,n=Math.max(a.end,e+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,.5*i),.75*i));this.flushMainBuffer(n,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;this.fragCurrent=null,(null==t?void 0:t.loader)&&t.loader.abort(),this.state===Me&&(this.state=Pe),this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const i=e.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new ln(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,e=t?t.currentTime:null;Number.isFinite(e)&&this.log(`Media seeked to ${e.toFixed(3)}`),this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(w.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null}onManifestParsed(t,e){let i,n=!1,a=!1;e.levels.forEach((t=>{i=t.audioCodec,i&&(-1!==i.indexOf("mp4a.40.2")&&(n=!0),-1!==i.indexOf("mp4a.40.5")&&(a=!0))})),this.audioCodecSwitch=n&&a&&!function(){var t;const e=Je();return"function"==typeof(null==(t=null==e?void 0:e.prototype)?void 0:t.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:i}=this;if(!i||this.state!==Pe)return;const n=i[e.level];(!n.details||n.details.live&&this.levelLastLoaded!==e.level||this.waitForCdnTuneIn(n.details))&&(this.state=Xe)}onLevelLoaded(t,e){var i;const{levels:n}=this,a=e.level,r=e.details,s=r.totalduration;if(!n)return void this.warn(`Levels were reset while loading level ${a}`);this.log(`Level ${a} loaded [${r.startSN},${r.endSN}], cc [${r.startCC}, ${r.endCC}] duration:${s}`);const o=this.fragCurrent;!o||this.state!==Be&&this.state!==Ue||o.level!==e.level&&o.loader&&(this.state=Pe,o.loader.abort());const l=n[a];let d=0;if(r.live||(null==(i=l.details)?void 0:i.live)){if(r.fragments[0]||(r.deltaUpdateFailed=!0),r.deltaUpdateFailed)return;d=this.alignPlaylists(r,l.details)}if(l.details=r,this.levelLastLoaded=a,this.hls.trigger(w.LEVEL_UPDATED,{details:r,level:a}),this.state===Xe){if(this.waitForCdnTuneIn(r))return;this.state=Pe}this.startFragRequested?r.live&&this.synchronizeToLiveEdge(r):this.setStartPosition(r,d),this.tick()}_handleFragmentLoadProgress(t){var e;const{frag:i,part:n,payload:a}=t,{levels:r}=this;if(!r)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const s=r[i.level],o=s.details;if(!o)return void this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`);const l=s.videoCodec,d=o.PTSKnown||!o.live,u=null==(e=o.initSegment)?void 0:e.data,h=this._getAudioCodec(s),c=this.transmuxer=this.transmuxer||new on(this.hls,wt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),g=n?n.index:-1,f=-1!==g,p=new ye(i.level,i.sn,i.stats.chunkCount,a.byteLength,g,f),m=this.initPTS[i.cc];c.push(a,u,h,l,i,n,o.totalduration,d,p,m)}onAudioTrackSwitching(t,e){const i=this.altAudio,n=!!e.url,a=e.id;if(!n){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const t=this.fragCurrent;(null==t?void 0:t.loader)&&(this.log("Switching to main audio track, cancel main fragment load"),t.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const t=this.hls;i&&t.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),t.trigger(w.AUDIO_TRACK_SWITCHED,{id:a})}}onAudioTrackSwitched(t,e){const i=e.id,n=!!this.hls.audioTracks[i].url;if(n){const t=this.videoBuffer;t&&this.mediaBuffer!==t&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t)}this.altAudio=n,this.tick()}onBufferCreated(t,e){const i=e.tracks;let n,a,r=!1;for(const s in i){const t=i[s];if("main"===t.id){if(a=s,n=t,"video"===s){const t=i[s];t&&(this.videoBuffer=t.buffer)}}else r=!0}r&&n?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:i,part:n}=e;if(i&&i.type!==wt.MAIN)return;if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${n?" p: "+n.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===He&&(this.state=Pe));const a=n?n.stats:i.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,n)}onError(t,e){switch(e.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(wt.MAIN,e);break;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:this.state!==je&&(e.fatal?(this.warn(`${e.details}`),this.state=je):e.levelRetry||this.state!==Xe||(this.state=Pe));break;case k.BUFFER_FULL_ERROR:if("main"===e.parent&&(this.state===Ge||this.state===He)){!!this.media&&Te.isBuffered(this.media,this.media.currentTime)&&Te.isBuffered(this.media,this.media.currentTime+.5)?(this.reduceMaxBufferLength(),this.state=Pe):(this.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.immediateLevelSwitch())}}}checkBuffer(){const{media:t,gapController:e}=this;if(!t||!e||!t.readyState)return;const i=Te.getBuffered(t);!this.loadedmetadata&&i.length?(this.loadedmetadata=!0,this.seekToStartPos()):e.poll(this.lastCurrentTime),this.lastCurrentTime=t.currentTime}onFragLoadEmergencyAborted(){this.state=Pe,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}onBufferFlushed(t,{type:e}){if(e!==J.AUDIO||this.audioOnly&&!this.altAudio){const t=(e===J.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(t,e,wt.MAIN)}}onLevelsUpdated(t,e){this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this,e=t.currentTime;let i=this.startPosition;if(i>=0&&e<i){if(t.seeking)return void W.log(`could not seek to ${i}, already seeking at ${e}`);const n=Te.getBuffered(t),a=(n.length?n.start(0):0)-i;a>0&&a<this.config.maxBufferHole&&(W.log(`adjusting start position by ${a} to match buffer start`),i+=a,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${e}`),t.currentTime=i}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t){this._doFragLoad(t).then((e=>{const{hls:i}=this;if(!e||i.nextLoadLevel||this.fragContextChanged(t))return;this.fragLoadError=0,this.state=Pe,this.startFragRequested=!1,this.bitrateTest=!1;const n=t.stats;n.parsing.start=n.parsing.end=n.buffering.start=n.buffering.end=self.performance.now(),i.trigger(w.FRAG_LOADED,e)}))}_handleTransmuxComplete(t){var e;const i="main",{hls:n}=this,{remuxResult:a,chunkMeta:r}=t,s=this.getCurrentContext(r);if(!s)return this.warn(`The loading context changed while buffering fragment ${r.sn} of level ${r.level}. This chunk will not be buffered.`),void this.resetLiveStartWhenNotLoaded(r.level);const{frag:o,part:l,level:d}=s,{video:u,text:h,id3:c,initSegment:g}=a,f=this.altAudio?void 0:a.audio;if(!this.fragContextChanged(o)){if(this.state=Ge,g){g.tracks&&(this._bufferInitSegment(d,g.tracks,o,r),n.trigger(w.FRAG_PARSING_INIT_SEGMENT,{frag:o,id:i,tracks:g.tracks}));const t=g.initPTS,e=g.timescale;Number.isFinite(t)&&(this.initPTS[o.cc]=t,n.trigger(w.INIT_PTS_FOUND,{frag:o,id:i,initPTS:t,timescale:e}))}if(u&&!1!==a.independent){if(d.details){const{startPTS:t,endPTS:e,startDTS:i,endDTS:n}=u;if(l)l.elementaryStreams[u.type]={startPTS:t,endPTS:e,startDTS:i,endDTS:n};else if(u.dropped&&u.independent){if(this.getLoadPosition()+this.config.maxBufferHole<t)return void this.backtrack(o);o.setElementaryStreamInfo(u.type,o.start,e,o.start,n,!0)}o.setElementaryStreamInfo(u.type,t,e,i,n),this.bufferFragmentData(u,o,l,r)}}else if(!1===a.independent)return void this.backtrack(o);if(f){const{startPTS:t,endPTS:e,startDTS:i,endDTS:n}=f;l&&(l.elementaryStreams[J.AUDIO]={startPTS:t,endPTS:e,startDTS:i,endDTS:n}),o.setElementaryStreamInfo(J.AUDIO,t,e,i,n),this.bufferFragmentData(f,o,l,r)}if(null==(e=null==c?void 0:c.samples)?void 0:e.length){const t={frag:o,id:i,samples:c.samples};n.trigger(w.FRAG_PARSING_METADATA,t)}if(h){const t={frag:o,id:i,samples:h.samples};n.trigger(w.FRAG_PARSING_USERDATA,t)}}}_bufferInitSegment(t,e,i,n){if(this.state!==Ge)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&delete e.audio;const{audio:a,video:r,audiovideo:s}=e;if(a){let e=t.audioCodec;const i=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==a.metadata.channelCount&&-1===i.indexOf("firefox")&&(e="mp4a.40.5")),-1!==i.indexOf("android")&&"audio/mpeg"!==a.container&&(e="mp4a.40.2",this.log(`Android: force audio codec to ${e}`)),t.audioCodec&&t.audioCodec!==e&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${e}"`),a.levelCodec=e,a.id="main",this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${e||""}/${t.audioCodec||""}/${a.codec}]`)}r&&(r.levelCodec=t.videoCodec,r.id="main",this.log(`Init video buffer, container:${r.container}, codecs[level/parsed]=[${t.videoCodec||""}/${r.codec}]`)),s&&this.log(`Init audiovideo buffer, container:${s.container}, codecs[level/parsed]=[${t.attrs.CODECS||""}/${s.codec}]`),this.hls.trigger(w.BUFFER_CODECS,e),Object.keys(e).forEach((t=>{const a=e[t].initSegment;(null==a?void 0:a.byteLength)&&this.hls.trigger(w.BUFFER_APPENDING,{type:t,data:a,frag:i,part:null,chunkMeta:n,parent:i.type})})),this.tick()}backtrack(t){this.resetTransmuxer(),this.flushBufferGap(t);const e=this.fragmentTracker.backtrack(t);this.fragPrevious=null,this.nextLoadPosition=t.start,e?this.resetFragmentLoading(t):this.state=Ve}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const i=t.currentTime;if(Te.isBuffered(t,i)?e=this.getAppendedFrag(i):Te.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){const t=this.fragPlaying,i=e.level;t&&e.sn===t.sn&&t.level===i&&e.urlId===t.urlId||(this.hls.trigger(w.FRAG_CHANGED,{frag:e}),t&&t.level===i||this.hls.trigger(w.LEVEL_SWITCHED,{level:i}),this.fragPlaying=e)}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentLevel(){const t=this.media;if(t){const e=this.getAppendedFrag(t.currentTime);if(e)return e.level}return-1}get nextBufferedFrag(){const t=this.media;if(t){const e=this.getAppendedFrag(t.currentTime);return this.followingBufferedFrag(e)}return null}get forceStartLoad(){return this._forceStartLoad}},un=class{constructor(t,e=0,i=0){this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){const i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}},hn=class{constructor(t,e,i){this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new un(t),this.fast_=new un(e)}update(t,e){const{slow_:i,fast_:n}=this;this.slow_.halfLife!==t&&(this.slow_=new un(t,i.getEstimate(),i.getTotalWeight())),this.fast_.halfLife!==e&&(this.fast_=new un(e,n.getEstimate(),n.getTotalWeight()))}sample(t,e){const i=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/i;this.fast_.sample(i,n),this.slow_.sample(i,n)}canEstimate(){const t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}destroy(){}},cn=class{constructor(t){this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.hls=t;const e=t.config;this.bwEstimator=new hn(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(w.FRAG_LOADING,this.onFragLoading,this),t.on(w.FRAG_LOADED,this.onFragLoaded,this),t.on(w.FRAG_BUFFERED,this.onFragBuffered,this),t.on(w.LEVEL_LOADED,this.onLevelLoaded,this),t.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(w.FRAG_LOADING,this.onFragLoading,this),t.off(w.FRAG_LOADED,this.onFragLoaded,this),t.off(w.FRAG_BUFFERED,this.onFragBuffered,this),t.off(w.LEVEL_LOADED,this.onLevelLoaded,this),t.off(w.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(t,e){var i;const n=e.frag;n.type===wt.MAIN&&(this.timer||(this.fragCurrent=n,this.partCurrent=null!=(i=e.part)?i:null,this.timer=self.setInterval(this.onCheck,100)))}onLevelLoaded(t,e){const i=this.hls.config;e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:t,partCurrent:e,hls:i}=this,{autoLevelEnabled:n,config:a,media:r}=i;if(!t||!r)return;const s=e?e.stats:t.stats,o=e?e.duration:t.duration;if(s.aborted)return W.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(!n||r.paused||!r.playbackRate||!r.readyState)return;const l=performance.now()-s.loading.start,d=Math.abs(r.playbackRate);if(l<=500*o/d)return;const{levels:u,minAutoLevel:h}=i,c=u[t.level],g=s.total||Math.max(s.loaded,Math.round(o*c.maxBitrate/8)),f=Math.max(1,s.bwEstimate?s.bwEstimate/8:1e3*s.loaded/l),p=(g-s.loaded)/f,m=r.currentTime,v=(Te.bufferInfo(r,m,a.maxBufferHole).end-m)/d;if(v>=2*o/d||p<=v)return;let T,y=Number.POSITIVE_INFINITY;for(T=t.level-1;T>h;T--){if(y=o*u[T].maxBitrate/(6.4*f),y<v)break}if(y>=p)return;const E=this.bwEstimator.getEstimate();W.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of level ${t.level} is loading too slowly and will cause an underbuffer; aborting and switching to level ${T}\n      Current BW estimate: ${Number.isFinite(E)?(E/1024).toFixed(3):"Unknown"} Kb/s\n      Estimated load time for current fragment: ${p.toFixed(3)} s\n      Estimated load time for the next fragment: ${y.toFixed(3)} s\n      Time to underbuffer: ${v.toFixed(3)} s`),i.nextLoadLevel=T,this.bwEstimator.sample(l,s.loaded),this.clearTimer(),t.loader&&(this.fragCurrent=this.partCurrent=null,t.loader.abort()),i.trigger(w.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:e,stats:s})}onFragLoaded(t,{frag:e,part:i}){if(e.type===wt.MAIN&&Number.isFinite(e.sn)){const t=i?i.stats:e.stats,n=i?i.duration:e.duration;if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const i=this.hls.levels[e.level],a=(i.loaded?i.loaded.bytes:0)+t.loaded,r=(i.loaded?i.loaded.duration:0)+n;i.loaded={bytes:a,duration:r},i.realBitrate=Math.round(8*a/r)}if(e.bitrateTest){const n={stats:t,frag:e,part:i,id:e.type};this.onFragBuffered(w.FRAG_BUFFERED,n),e.bitrateTest=!1}}}onFragBuffered(t,e){const{frag:i,part:n}=e,a=n?n.stats:i.stats;if(a.aborted)return;if(i.type!==wt.MAIN||"initSegment"===i.sn)return;const r=a.parsing.end-a.loading.start;this.bwEstimator.sample(r,a.loaded),a.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}onError(t,e){switch(e.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:this.clearTimer()}}clearTimer(){self.clearInterval(this.timer),this.timer=void 0}get nextAutoLevel(){const t=this._nextAutoLevel,e=this.bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;let i=this.getNextABRAutoLevel();return-1!==t&&(i=Math.min(t,i)),i}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:i}=this,{maxAutoLevel:n,config:a,minAutoLevel:r,media:s}=i,o=e?e.duration:t?t.duration:0,l=s?s.currentTime:0,d=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,h=(Te.bufferInfo(s,l,a.maxBufferHole).end-l)/d;let c=this.findBestLevel(u,r,n,h,a.abrBandWidthFactor,a.abrBandWidthUpFactor);if(c>=0)return c;W.trace((h?"rebuffering expected":"buffer is empty")+", finding optimal quality level");let g=o?Math.min(o,a.maxStarvationDelay):a.maxStarvationDelay,f=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(!h){const t=this.bitrateTestDelay;if(t){g=(o?Math.min(o,a.maxLoadingDelay):a.maxLoadingDelay)-t,W.trace(`bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),f=p=1}}return c=this.findBestLevel(u,r,n,h+g,f,p),Math.max(c,0)}findBestLevel(t,e,i,n,a,r){var s;const{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:d}=this,{levels:u}=this.hls,h=u[d],c=!!(null==(s=null==h?void 0:h.details)?void 0:s.live),g=null==h?void 0:h.codecSet,f=l?l.duration:o?o.duration:0;for(let p=i;p>=e;p--){const e=u[p];if(!e||g&&e.codecSet!==g)continue;const i=e.details,s=(l?null==i?void 0:i.partTarget:null==i?void 0:i.averagetargetduration)||f;let o;o=p<=d?a*t:r*t;const h=u[p].maxBitrate,m=h*s/o;if(W.trace(`level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: ${p}/${Math.round(o)}/${h}/${s}/${n}/${m}`),o>h&&(!m||c&&!this.bitrateTestDelay||m<n))return p}return-1}set nextAutoLevel(t){this._nextAutoLevel=t}},gn=class{constructor(t){this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,e){const i=this.queues[e];i.push(t),1===i.length&&this.buffers[e]&&this.executeNext(e)}insertAbort(t,e){this.queues[e].unshift(t),this.executeNext(e)}appendBlocker(t){let e;const i=new Promise((t=>{e=t})),n={execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(n,t),i}executeNext(t){const{buffers:e,queues:i}=this,n=e[t],a=i[t];if(a.length){const t=a[0];try{t.execute()}catch(r){W.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(r),n&&n.updating||a.shift()}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}},fn=Ye(),pn=/([ha]vc.)(?:\.[^.,]+)+/,mn=class{constructor(t){this.details=null,this._objectUrl=null,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this._onMediaSourceOpen=()=>{const{hls:t,media:e,mediaSource:i}=this;W.log("[buffer-controller]: Media source opened"),e&&(this.updateMediaElementDuration(),t.trigger(w.MEDIA_ATTACHED,{media:e})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{W.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{W.log("[buffer-controller]: Media source ended")},this.hls=t,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null}registerListeners(){const{hls:t}=this;t.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(w.MANIFEST_PARSED,this.onManifestParsed,this),t.on(w.BUFFER_RESET,this.onBufferReset,this),t.on(w.BUFFER_APPENDING,this.onBufferAppending,this),t.on(w.BUFFER_CODECS,this.onBufferCodecs,this),t.on(w.BUFFER_EOS,this.onBufferEos,this),t.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(w.FRAG_PARSED,this.onFragParsed,this),t.on(w.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(w.MANIFEST_PARSED,this.onManifestParsed,this),t.off(w.BUFFER_RESET,this.onBufferReset,this),t.off(w.BUFFER_APPENDING,this.onBufferAppending,this),t.off(w.BUFFER_CODECS,this.onBufferCodecs,this),t.off(w.BUFFER_EOS,this.onBufferEos,this),t.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(w.FRAG_PARSED,this.onFragParsed,this),t.off(w.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new gn(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}}onManifestParsed(t,e){let i=2;(e.audio&&!e.video||!e.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,this.details=null,W.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,e){const i=this.media=e.media;if(i&&fn){const t=this.mediaSource=new fn;t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(t),this._objectUrl=i.src}}onMediaDetaching(){const{media:t,mediaSource:e,_objectUrl:i}=this;if(e){if(W.log("[buffer-controller]: media source detaching"),"open"===e.readyState)try{e.endOfStream()}catch(Qn){W.warn(`[buffer-controller]: onMediaDetaching: ${Qn.message} while calling endOfStream`)}this.onBufferReset(),e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(i&&self.URL.revokeObjectURL(i),t.src===i?(t.removeAttribute("src"),t.load()):W.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(w.MEDIA_DETACHED,void 0)}onBufferReset(){const t=this.sourceBuffer;this.getSourceBufferTypes().forEach((e=>{const i=t[e];try{i&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(i),t[e]=void 0)}catch(Qn){W.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,Qn)}})),this._initSourceBuffer()}onBufferCodecs(t,e){const i=Object.keys(this.sourceBuffer).length;Object.keys(e).forEach((t=>{if(i){const i=this.tracks[t];if(i&&"function"==typeof i.buffer.changeType){const{codec:n,levelCodec:a,container:r}=e[t];if((i.levelCodec||i.codec).replace(pn,"$1")!==(a||n).replace(pn,"$1")){const e=`${r};codecs=${a||n}`;this.appendChangeType(t,e)}}}else this.pendingTracks[t]=e[t]})),i||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(t,e){const{operationQueue:i}=this,n={execute:()=>{const n=this.sourceBuffer[t];n&&(W.log(`[buffer-controller]: changing ${t} sourceBuffer type to ${e}`),n.changeType(e)),i.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:e=>{W.warn(`[buffer-controller]: Failed to change ${t} SourceBuffer type`,e)}};i.append(n,t)}onBufferAppending(t,e){const{hls:i,operationQueue:n,tracks:a}=this,{data:r,type:s,frag:o,part:l,chunkMeta:d}=e,u=d.buffering[s],h=self.performance.now();u.start=h;const c=o.stats.buffering,g=l?l.stats.buffering:null;0===c.start&&(c.start=h),g&&0===g.start&&(g.start=h);const f=a.audio,p="audio"===s&&1===d.id&&"audio/mpeg"===(null==f?void 0:f.container),m={execute:()=>{if(u.executeStart=self.performance.now(),p){const t=this.sourceBuffer[s];if(t){const e=o.start-t.timestampOffset;Math.abs(e)>=.1&&(W.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${o.start} (delta: ${e}) sn: ${o.sn})`),t.timestampOffset=o.start)}}this.appendExecutor(r,s)},onStart:()=>{},onComplete:()=>{const t=self.performance.now();u.executeEnd=u.end=t,0===c.first&&(c.first=t),g&&0===g.first&&(g.first=t);const{sourceBuffer:e}=this,i={};for(const n in e)i[n]=Te.getBuffered(e[n]);this.appendError=0,this.hls.trigger(w.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:d,parent:o.type,timeRanges:i})},onError:t=>{W.error(`[buffer-controller]: Error encountered while trying to append to the ${s} SourceBuffer`,t);const e={type:D.MEDIA_ERROR,parent:o.type,details:k.BUFFER_APPEND_ERROR,err:t,fatal:!1};t.code===DOMException.QUOTA_EXCEEDED_ERR?e.details=k.BUFFER_FULL_ERROR:(this.appendError++,e.details=k.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry&&(W.error(`[buffer-controller]: Failed ${i.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),e.fatal=!0)),i.trigger(w.ERROR,e)}};n.append(m,s)}onBufferFlushing(t,e){const{operationQueue:i}=this,n=t=>({execute:this.removeExecutor.bind(this,t,e.startOffset,e.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(w.BUFFER_FLUSHED,{type:t})},onError:e=>{W.warn(`[buffer-controller]: Failed to remove from ${t} SourceBuffer`,e)}});e.type?i.append(n(e.type),e.type):(i.append(n("audio"),"audio"),i.append(n("video"),"video"))}onFragParsed(t,e){const{frag:i,part:n}=e,a=[],r=n?n.elementaryStreams:i.elementaryStreams;r[J.AUDIOVIDEO]?a.push("audiovideo"):(r[J.AUDIO]&&a.push("audio"),r[J.VIDEO]&&a.push("video"));0===a.length&&W.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers((()=>{const t=self.performance.now();i.stats.buffering.end=t,n&&(n.stats.buffering.end=t);const e=n?n.stats:i.stats;this.hls.trigger(w.FRAG_BUFFERED,{frag:i,part:n,stats:e,id:i.type})}),a)}onFragChanged(t,e){this.flushBackBuffer()}onBufferEos(t,e){this.getSourceBufferTypes().reduce(((t,i)=>{const n=this.sourceBuffer[i];return e.type&&e.type!==i||n&&!n.ended&&(n.ended=!0,W.log(`[buffer-controller]: ${i} sourceBuffer now EOS`)),t&&!(n&&!n.ended)}),!0)&&this.blockBuffers((()=>{const{mediaSource:t}=this;t&&"open"===t.readyState&&t.endOfStream()}))}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:t,details:e,media:i,sourceBuffer:n}=this;if(!i||null===e)return;const a=this.getSourceBufferTypes();if(!a.length)return;const r=e.live&&null!==t.config.liveBackBufferLength?t.config.liveBackBufferLength:t.config.backBufferLength;if(!Number.isFinite(r)||r<0)return;const s=i.currentTime,o=e.levelTargetDuration,l=Math.max(r,o),d=Math.floor(s/o)*o-l;a.forEach((i=>{const a=n[i];if(a){const n=Te.getBuffered(a);n.length>0&&d>n.start(0)&&(t.trigger(w.BACK_BUFFER_REACHED,{bufferEnd:d}),e.live&&t.trigger(w.LIVE_BACK_BUFFER_REACHED,{bufferEnd:d}),t.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:d,type:i}))}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:t,hls:e,media:i,mediaSource:n}=this,a=t.fragments[0].start+t.totalduration,r=i.duration,s=Number.isFinite(n.duration)?n.duration:0;t.live&&e.config.liveDurationInfinity?(W.log("[buffer-controller]: Media Source duration is set to Infinity"),n.duration=1/0,this.updateSeekableRange(t)):(a>s&&a>r||!Number.isFinite(r))&&(W.log(`[buffer-controller]: Updating Media Source duration to ${a.toFixed(3)}`),n.duration=a)}updateSeekableRange(t){const e=this.mediaSource,i=t.fragments;if(i.length&&t.live&&(null==e?void 0:e.setLiveSeekableRange)){const n=Math.max(0,i[0].start),a=Math.max(n,n+t.totalduration);e.setLiveSeekableRange(n,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:e,pendingTracks:i}=this,n=Object.keys(i).length;if(n&&!t||2===n){this.createSourceBuffers(i),this.pendingTracks={};const t=Object.keys(this.sourceBuffer);if(0===t.length)return void this.hls.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});t.forEach((t=>{e.executeNext(t)}))}}createSourceBuffers(t){const{sourceBuffer:e,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");let n=0;for(const a in t)if(!e[a]){const r=t[a];if(!r)throw Error(`source buffer exists for track ${a}, however track does not`);const s=r.levelCodec||r.codec,o=`${r.container};codecs=${s}`;W.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{const t=e[a]=i.addSourceBuffer(o),l=a;this.addBufferListener(l,"updatestart",this._onSBUpdateStart),this.addBufferListener(l,"updateend",this._onSBUpdateEnd),this.addBufferListener(l,"error",this._onSBUpdateError),this.tracks[a]={buffer:t,codec:s,container:r.container,levelCodec:r.levelCodec,id:r.id},n++}catch(Qn){W.error(`[buffer-controller]: error while trying to add sourceBuffer: ${Qn.message}`),this.hls.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:Qn,mimeType:o})}}n&&this.hls.trigger(w.BUFFER_CREATED,{tracks:this.tracks})}_onSBUpdateStart(t){const{operationQueue:e}=this;e.current(t).onStart()}_onSBUpdateEnd(t){const{operationQueue:e}=this;e.current(t).onComplete(),e.shiftAndExecuteNext(t)}_onSBUpdateError(t,e){W.error(`[buffer-controller]: ${t} SourceBuffer error`,e),this.hls.trigger(w.ERROR,{type:D.MEDIA_ERROR,details:k.BUFFER_APPENDING_ERROR,fatal:!1});const i=this.operationQueue.current(t);i&&i.onError(e)}removeExecutor(t,e,i){const{media:n,mediaSource:a,operationQueue:r,sourceBuffer:s}=this,o=s[t];if(!n||!a||!o)return W.warn(`[buffer-controller]: Attempting to remove from the ${t} SourceBuffer, but it does not exist`),void r.shiftAndExecuteNext(t);const l=Number.isFinite(n.duration)?n.duration:1/0,d=Number.isFinite(a.duration)?a.duration:1/0,u=Math.max(0,e),h=Math.min(i,l,d);h>u?(W.log(`[buffer-controller]: Removing [${u},${h}] from the ${t} SourceBuffer`),console.assert(!o.updating,`${t} sourceBuffer must not be updating`),o.remove(u,h)):r.shiftAndExecuteNext(t)}appendExecutor(t,e){const{operationQueue:i,sourceBuffer:n}=this,a=n[e];if(!a)return W.warn(`[buffer-controller]: Attempting to append to the ${e} SourceBuffer, but it does not exist`),void i.shiftAndExecuteNext(e);a.ended=!1,console.assert(!a.updating,`${e} sourceBuffer must not be updating`),a.appendBuffer(t)}blockBuffers(t,e=this.getSourceBufferTypes()){if(!e.length)return void W.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist");const{operationQueue:i}=this,n=e.map((t=>i.appendBlocker(t)));Promise.all(n).then((()=>{t(),e.forEach((t=>{const e=this.sourceBuffer[t];e&&e.updating||i.shiftAndExecuteNext(t)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,e,i){const n=this.sourceBuffer[t];if(!n)return;const a=i.bind(this,t);this.listeners[t].push({event:e,listener:a}),n.addEventListener(e,a)}removeBufferListeners(t){const e=this.sourceBuffer[t];e&&this.listeners[t].forEach((t=>{e.removeEventListener(t.event,t.listener)}))}};(an=nn||(nn={}))[an.ERROR=0]="ERROR",an[an.TEXT=1]="TEXT",an[an.WARNING=2]="WARNING",an[an.INFO=2]="INFO",an[an.DEBUG=3]="DEBUG",an[an.DATA=3]="DATA",new(function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function i(t,e){if("string"!=typeof e)return!1;if(!Array.isArray(t))return!1;const i=e.toLowerCase();return!!~t.indexOf(i)&&i}function n(t){return i(e,t)}function a(t,...e){let i=1;for(;i<arguments.length;i++){const e=arguments[i];for(const i in e)t[i]=e[i]}return t}function r(e,r,s){const o=this,l={enumerable:!0};o.hasBeenReset=!1;let d="",u=!1,h=e,c=r,g=s,f=null,p="",m=!0,v="auto",T="start",y=50,E="middle",b=50,S="middle";Object.defineProperty(o,"id",a({},l,{get:function(){return d},set:function(t){d=""+t}})),Object.defineProperty(o,"pauseOnExit",a({},l,{get:function(){return u},set:function(t){u=!!t}})),Object.defineProperty(o,"startTime",a({},l,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},l,{get:function(){return c},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");c=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},l,{get:function(){return g},set:function(t){g=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},l,{get:function(){return f},set:function(t){f=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},l,{get:function(){return p},set:function(e){const n=function(e){return i(t,e)}(e);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");p=n,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},l,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},l,{get:function(){return v},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},l,{get:function(){return T},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},l,{get:function(){return y},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},l,{get:function(){return E},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},l,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},l,{get:function(){return S},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");S=e,this.hasBeenReset=!0}})),o.displayState=void 0}return r.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},r}())(0,0,"");var vn=function(t){let e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return(e>>>0).toString()};function Tn(t,e,i){return vn(t.toString())+vn(e.toString())+vn(i)}var yn,En,bn=class{constructor(t){this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(w.MANIFEST_PARSED,this.onManifestParsed,this),t.on(w.BUFFER_CODECS,this.onBufferCodecs,this),t.on(w.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(w.MANIFEST_PARSED,this.onManifestParsed,this),t.off(w.BUFFER_CODECS,this.onBufferCodecs,this),t.off(w.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){bn.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null}onManifestParsed(t,e){const i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const t=this.hls.levels;if(t.length){const e=this.hls;e.autoLevelCapping=this.getMaxLevel(t.length-1),e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const i=e.filter(((e,i)=>bn.isLevelAllowed(i,this.restrictedLevels)&&i<=t));return this.clientRect=null,bn.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,e.width||e.height||(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*bn.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*bn.contentScaleFactor}static get contentScaleFactor(){let t=1;try{t=self.devicePixelRatio}catch(e){}return t}static isLevelAllowed(t,e=[]){return-1===e.indexOf(t)}static getMaxLevelByMediaSize(t,e,i){if(!t||!t.length)return-1;let n=t.length-1;for(let s=0;s<t.length;s+=1){const o=t[s];if((o.width>=e||o.height>=i)&&(a=o,!(r=t[s+1])||a.width!==r.width||a.height!==r.height)){n=s;break}}var a,r;return n}},Sn=bn,An=class{constructor(t){this.isVideoPlaybackQualityAvailable=!1,this.media=null,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHING,this.onMediaAttaching)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const i=this.hls.config;if(i.capLevelOnFPSDrop){const t=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=t,t&&"function"==typeof t.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(t,e,i){const n=performance.now();if(e){if(this.lastTime){const t=n-this.lastTime,a=i-this.lastDroppedFrames,r=e-this.lastDecodedFrames,s=1e3*a/t,o=this.hls;if(o.trigger(w.FPS_DROP,{currentDropped:a,currentDecoded:r,totalDroppedFrames:i}),s>0&&a>o.config.fpsDroppedMonitoringThreshold*r){let t=o.currentLevel;W.warn("drop FPS ratio greater than max allowed value for currentLevel: "+t),t>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=t)&&(t-=1,o.trigger(w.FPS_DROP_LEVEL_CAPPING,{level:t,droppedLevel:o.currentLevel}),o.autoLevelCapping=t,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}};(En=yn||(yn={})).WIDEVINE="com.widevine.alpha",En.PLAYREADY="com.microsoft.playready";var Ln="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,wn=/^age:\s*[\d.]+\s*$/m,Cn=class{constructor(t){this.config=null,this.callbacks=null,this.loader=null,this.xhrSetup=t?t.xhrSetup:null,this.stats=new Q,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(null==(t=this.callbacks)?void 0:t.onAbort)&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.retryDelay=e.retryDelay,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t)return;const i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0;const a=this.xhrSetup;try{if(a)try{a(i,e.url)}catch(r){i.open("GET",e.url,!0),a(i,e.url)}i.readyState||i.open("GET",e.url,!0)}catch(r){return void this.callbacks.onError({code:i.status,text:r.message},e,i)}e.rangeEnd&&i.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),i.onreadystatechange=this.readystatechange.bind(this),i.onprogress=this.loadprogress.bind(this),i.responseType=e.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.timeout),i.send()}readystatechange(){const{context:t,loader:e,stats:i}=this;if(!t||!e)return;const n=e.readyState,a=this.config;if(!i.aborted&&n>=2)if(self.clearTimeout(this.requestTimeout),0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start)),4===n){e.onreadystatechange=null,e.onprogress=null;const n=e.status;if(n>=200&&n<300){let n,a;if(i.loading.end=Math.max(self.performance.now(),i.loading.first),"arraybuffer"===t.responseType?(n=e.response,a=n.byteLength):(n=e.responseText,a=n.length),i.loaded=i.total=a,!this.callbacks)return;const r=this.callbacks.onProgress;if(r&&r(i,t,n,e),!this.callbacks)return;const s={url:e.responseURL,data:n};this.callbacks.onSuccess(s,i,t,e)}else i.retry>=a.maxRetry||n>=400&&n<499?(W.error(`${n} while loading ${t.url}`),this.callbacks.onError({code:n,text:e.statusText},t,e)):(W.warn(`${n} while loading ${t.url}, retrying in ${this.retryDelay}...`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout)}loadtimeout(){W.warn(`timeout while loading ${this.context.url}`);const t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&wn.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}};function Dn(t,e){return new self.Request(t.url,e)}var Rn=class extends Error{constructor(t,e,i){super(t),this.code=e,this.details=i}},kn=class{constructor(t){this.config=null,this.callbacks=null,this.loader=null,this.fetchSetup=t.fetchSetup||Dn,this.controller=new self.AbortController,this.stats=new Q}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const t=this.response;t&&t.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(null==(t=this.callbacks)?void 0:t.onAbort)&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const a=function(t,e){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:e};t.rangeEnd&&(i.headers=new self.Headers({Range:"bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)}));return i}(t,this.controller.signal),r=i.onProgress,s="arraybuffer"===t.responseType,o=s?"byteLength":"length";this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,a),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),i.onTimeout(n,t,this.response)}),e.timeout),self.fetch(this.request).then((i=>{if(this.response=this.loader=i,!i.ok){const{status:t,statusText:e}=i;throw new Rn(e||"fetch, bad network response",t,i)}return n.loading.first=Math.max(self.performance.now(),n.loading.start),n.total=parseInt(i.headers.get("Content-Length")||"0"),r&&Number.isFinite(e.highWaterMark)?this.loadProgressively(i,n,t,e.highWaterMark,r):s?i.arrayBuffer():i.text()})).then((a=>{const{response:s}=this;self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first),n.loaded=n.total=a[o];const l={url:s.url,data:a};r&&!Number.isFinite(e.highWaterMark)&&r(n,t,a,s),i.onSuccess(l,n,t,s)})).catch((e=>{if(self.clearTimeout(this.requestTimeout),n.aborted)return;const a=e.code||0;i.onError({code:a,text:e.message},t,e.details)}))}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}loadProgressively(t,e,i,n=0,a){const r=new qi,s=t.body.getReader(),o=()=>s.read().then((s=>{if(s.done)return r.dataLength&&a(e,i,r.flush(),t),Promise.resolve(new ArrayBuffer(0));const l=s.value,d=l.length;return e.loaded+=d,d<n||r.dataLength?(r.push(l),r.dataLength>=n&&a(e,i,r.flush(),t)):a(e,i,l,t),o()})).catch((()=>Promise.reject()));return o()}},xn=/\s/,On=r(r({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Cn,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:cn,bufferController:mn,capLevelController:Sn,fpsController:An,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ln,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:{newCue(t,e,i,n){const a=[];let r,s,o,l,d;const u=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(r=n.rows[h],o=!0,l=0,d="",!r.isEmpty()){for(let t=0;t<r.chars.length;t++)xn.test(r.chars[t].uchar)&&o?l++:(d+=r.chars[t].uchar,o=!1);r.cueStartTime=e,e===i&&(i+=1e-4),l>=16?l--:l++;const n=d.trim().replace(/<br(?: \/)?>/gi,"\n"),c=Tn(e,i,n);t&&t.cues&&t.cues.getCueById(c)||(s=new u(e,i,n),s.id=c,s.line=h+1,s.align="left",s.position=10+Math.min(80,10*Math.floor(8*l/32)),a.push(s))}return t&&a.length&&(a.sort(((t,e)=>"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line)),a.forEach((e=>function(t,e){const i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(Qn){W.debug(`[texttrack-utils]: ${Qn}`);const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,t.addCue(n)}"disabled"===i&&(t.mode=i)}(t,e)))),a}},enableCEA708Captions:void 0,enableWebVTT:void 0,enableIMSC1:void 0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{subtitleStreamController:void 0,subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0});function In(t){const e=t.loader;if(e!==kn&&e!==Cn)W.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1})()&&(t.loader=kn,t.progressive=!0,t.enableSoftwareAES=!0,W.log("[config]: Progressive streaming enabled, using FetchLoader"))}}var _n=B(G()),Fn=class{constructor(t={}){this._emitter=new _n.EventEmitter,this._media=null,this.url=null;const e=this.config=function(t,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return Object.assign({},t,e)}(Fn.DefaultConfig,t);this.userConfig=t,function(t){if(self.console&&!0===t||"object"==typeof t){X(t,"debug","log","info","warn","error");try{j.log()}catch(e){j=K}}else j=K}(e.debug),this._autoLevelCapping=-1,e.progressive&&In(e);const{abrController:i,bufferController:n,capLevelController:a,fpsController:r}=e,s=this.abrController=new i(this),o=this.bufferController=new n(this),l=this.capLevelController=new a(this),d=new r(this),u=new _t(this),h=new Ft(this),c=new te(this),g=this.levelController=new ge(this),f=new class{constructor(t){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(w.BUFFER_APPENDED,this.onBufferAppended,this),t.on(w.FRAG_BUFFERED,this.onFragBuffered,this),t.on(w.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(w.BUFFER_APPENDED,this.onBufferAppended,this),t.off(w.FRAG_BUFFERED,this.onFragBuffered,this),t.off(w.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.timeRanges=null}getAppendedFrag(t,e){if(e===wt.MAIN){const{activeFragment:e,activeParts:i}=this;if(!e)return null;if(i)for(let n=i.length;n--;){const a=i[n],r=a?a.end:e.appendedPTS;if(a.start<=t&&void 0!==r&&t<=r)return n>9&&(this.activeParts=i.slice(n-9)),a}else if(e.start<=t&&void 0!==e.appendedPTS&&t<=e.appendedPTS)return e}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){const{fragments:i}=this,n=Object.keys(i);for(let a=n.length;a--;){const r=i[n[a]];if((null==r?void 0:r.body.type)===e&&r.buffered){const e=r.body;if(e.start<=t&&t<=e.end)return e}}return null}detectEvictedFragments(t,e,i){Object.keys(this.fragments).forEach((n=>{const a=this.fragments[n];if(!a)return;if(!a.buffered)return void(a.body.type===i&&this.removeFragment(a.body));const r=a.range[t];r&&r.time.some((t=>{const i=!this.isTimeBuffered(t.startPTS,t.endPTS,e);return i&&this.removeFragment(a.body),i}))}))}detectPartialFragments(t){const e=this.timeRanges,{frag:i,part:n}=t;if(!e||"initSegment"===i.sn)return;const a=pe(i),r=this.fragments[a];r&&(Object.keys(e).forEach((t=>{const a=i.elementaryStreams[t];if(!a)return;const s=e[t],o=null!==n||!0===a.partial;r.range[t]=this.getBufferedTimes(i,n,o,s)})),r.backtrack=r.loaded=null,Object.keys(r.range).length?r.buffered=!0:this.removeFragment(r.body))}getBufferedTimes(t,e,i,n){const a={time:[],partial:i},r=e?e.start:t.start,s=e?e.end:t.end,o=t.minEndPTS||s,l=t.maxStartPTS||r;for(let d=0;d<n.length;d++){const t=n.start(d)-this.bufferPadding,e=n.end(d)+this.bufferPadding;if(l>=t&&o<=e){a.time.push({startPTS:Math.max(r,n.start(d)),endPTS:Math.min(s,n.end(d))});break}if(r<e&&s>t)a.partial=!0,a.time.push({startPTS:Math.max(r,n.start(d)),endPTS:Math.min(s,n.end(d))});else if(s<=t)break}return a}getPartialFragment(t){let e,i,n,a=null,r=0;const{bufferPadding:s,fragments:o}=this;return Object.keys(o).forEach((l=>{const d=o[l];d&&fe(d)&&(i=d.body.start-s,n=d.body.end+s,t>=i&&t<=n&&(e=Math.min(t-i,n-t),r<=e&&(a=d.body,r=e)))})),a}getState(t){const e=pe(t),i=this.fragments[e];return i?i.buffered?fe(i)?de.PARTIAL:de.OK:i.backtrack?de.BACKTRACKED:de.APPENDING:de.NOT_LOADED}backtrack(t,e){const i=pe(t),n=this.fragments[i];if(!n||n.backtrack)return null;const a=n.backtrack=e||n.loaded;return n.loaded=null,a}getBacktrackData(t){var e;const i=pe(t),n=this.fragments[i];if(n){const{backtrack:i}=n;if(null==(e=null==i?void 0:i.payload)?void 0:e.byteLength)return i;this.removeFragment(t)}return null}isTimeBuffered(t,e,i){let n,a;for(let r=0;r<i.length;r++){if(n=i.start(r)-this.bufferPadding,a=i.end(r)+this.bufferPadding,t>=n&&e<=a)return!0;if(e<=n)return!1}return!1}onFragLoaded(t,e){const{frag:i,part:n}=e;if("initSegment"===i.sn||i.bitrateTest||n)return;const a=pe(i);this.fragments[a]={body:i,loaded:e,backtrack:null,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:i,part:n,timeRanges:a}=e;if(i.type===wt.MAIN)if(this.activeFragment=i,n){let t=this.activeParts;t||(this.activeParts=t=[]),t.push(n)}else this.activeParts=null;this.timeRanges=a,Object.keys(a).forEach((t=>{const e=a[t];if(this.detectEvictedFragments(t,e),!n)for(let n=0;n<e.length;n++)i.appendedPTS=Math.max(e.end(n),i.appendedPTS||0)}))}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=pe(t);return!!this.fragments[e]}removeFragment(t){const e=pe(t);t.stats.loaded=0,t.clearElementaryStreamInfo(),delete this.fragments[e]}removeAllFragments(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null}}(this),p=this.streamController=new dn(this,f);l.setStreamController(p),d.setStreamController(p);const m=[g,p];this.networkControllers=m;const v=[u,h,s,o,l,d,c,f];this.audioTrackController=this.createController(e.audioTrackController,null,m),this.createController(e.audioStreamController,f,m),this.subtitleTrackController=this.createController(e.subtitleTrackController,null,m),this.createController(e.subtitleStreamController,f,m),this.createController(e.timelineController,null,v),this.emeController=this.createController(e.emeController,null,v),this.latencyController=this.createController(ee,null,v),this.coreComponents=v}static get version(){return __VERSION__}static isSupported(){return function(){const t=Ye();if(!t)return!1;const e=Je(),i=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!i&&!!n}()}static get Events(){return w}static get ErrorTypes(){return D}static get ErrorDetails(){return k}static get DefaultConfig(){return Fn.defaultConfig?Fn.defaultConfig:On}static set DefaultConfig(t){Fn.defaultConfig=t}createController(t,e,i){if(t){const n=e?new t(this,e):new t(this);return i&&i.push(n),n}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,n){this._emitter.off(t,e,i,n)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){W.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),this.trigger(w.ERROR,{type:D.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:!1,event:t,error:i})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){W.log("destroy"),this.trigger(w.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((t=>t.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((t=>t.destroy())),this.coreComponents.length=0}attachMedia(t){W.log("attachMedia"),this._media=t,this.trigger(w.MEDIA_ATTACHING,{media:t})}detachMedia(){W.log("detachMedia"),this.trigger(w.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const e=this.media,i=this.url,n=this.url=H.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});W.log(`loadSource:${n}`),e&&i&&i!==n&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(e)),this.trigger(w.MANIFEST_LOADING,{url:t})}startLoad(t=-1){W.log(`startLoad(${t})`),this.networkControllers.forEach((e=>{e.startLoad(t)}))}stopLoad(){W.log("stopLoad"),this.networkControllers.forEach((t=>{t.stopLoad()}))}swapAudioCodec(){W.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){W.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,e=0){this.levelController.removeLevel(t,e)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){W.log(`set currentLevel:${t}`),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){W.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){W.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){W.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){W.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(W.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const i=t.length;for(let n=0;n<i;n++)if(t[n].maxBitrate>e)return n;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e}=this;let i;return i=-1===e&&t&&t.length?t.length-1:e,i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}};const Nn={autoStartLoad:!0,startPosition:-1,debug:!1,initialLiveManifestSize:1,maxBufferLength:6,maxMaxBufferLength:6,backBufferLength:30,maxBufferSize:3e4,maxBufferHole:.5};function Pn(t){const e=document.querySelector("video");e.volume=.5;const i=new Fn(Nn);i.attachMedia(e),i.on(Fn.Events.MEDIA_ATTACHED,(()=>{i.loadSource(t.url)})),i.on(Fn.Events.MANIFEST_PARSED,((n,a)=>{console.log(i.levels),i.levels.length>1&&i.loadSource(i.levels[i.levels.length-1].url[0]);var r=a.levels.length-1;i.loadLevel=r;var s=e.play();s&&s.catch((function(t){if(console.log(" > video.play() failed with error: [ "+t.name+" ] 💣 🗡 "+t.message),"NotAllowedError"===t.name)return console.log("[test] > Attempting to play with video muted"),e.muted=!0,e.play()})),localStorage.setItem("previous",JSON.stringify(t))})),i.on(Fn.Events.ERROR,((t,e)=>{e.fatal&&e.type===Fn.ErrorTypes.NETWORK_ERROR&&i.startLoad()}))}function Mn(t){document.addEventListener("wheel",L(Bn,200)),document.addEventListener("scroll",L(Bn,200)),document.querySelector("#random-button").addEventListener("click",(()=>function(t){const e=Math.ceil(Math.random()*t.length);m(t[e].url)?(Pn(t[e]),A("#channel-message",t[e])):A("#channel-message",{name:"no channel"})}(t))),document.querySelector("#menu-button").addEventListener("click",L(Un,50))}function Bn(t){(/Mobile/i.test(navigator.userAgent)||function(){const t=document.documentElement.scrollTop,e=document.documentElement.clientHeight,i=document.documentElement.scrollHeight;return t+e===i}()&&jn)&&Wn(20)}function Un(t){const e=document.querySelector("#channel-list");window.scroll(0,0),e.classList.toggle("blur-sm"),document.querySelector("#video-wrap").classList.toggle("sticky"),document.querySelector("#menu-pop").classList.toggle("hidden"),document.querySelectorAll("#menu-button>svg").forEach((t=>t.classList.toggle("hidden")))}function Gn(t,e,i=null,n=!1){if(i||(i=new WeakSet),!i.has(t))return t.forEach((t=>{const a=function(t,e){const i=document.createElement(t.tagName);t.innerHtml&&(i.innerHTML=t.innerHtml);t.id&&i.setAttribute("id",t.id);if(t.attribute)for(const n of Object.keys(t.attribute))i.setAttribute(n,t.attribute[n]);t.classList&&i.classList.add(...function(t){const e=new Set;return t.trim().split(f).forEach((t=>e.add(t))),[...e]}(t.classList));return e.appendChild(i),i}(t,e);n||(n=a),"object"==typeof t.subelement&&(i.add(t),Gn(t.subelement,a,i))})),n}async function Hn(t){const e=document.querySelector("#channel-list");u.innerHtml=t.name,h.attribute.alt=t.name,h.attribute.src=t.tvg?t.tvg.logo:"";Gn([c],e).addEventListener("click",L(Vn).bind({},t))}function Vn(){const t=arguments[0];Pn(t),A("#channel-message",t)}function Kn(t,e="category"){const i="language"===e?"#tab-language":"country"===e?"#tab-country":"#tab-category",n="string"==typeof t?t:t[0],a=document.querySelector(i);g.innerHtml=n;Gn([g],a).addEventListener("click",L(Xn.bind({},t),200))}let jn=null;function Xn(){const t=arguments[0];let e;e="string"==typeof t?`categories/${t.toLowerCase()}`:`${t[2]}/${t[1]}`,console.log(e),fetch(`${o}${e}.m3u`,l).then((t=>{if(t.ok)return t.text()})).then((t=>{jn=v(t),Jn(),Wn(),Un()}))}function Wn(t=88){const e=jn.items.length>t?t:jn.items.length;console.log(`${jn.items.length} channel`);for(let i=0;i<e;i++)Yn(jn.items.shift())}function Yn(t){const e=m(t.url);e&&(t.url=e,setTimeout((()=>{Hn(t)}),50))}function Jn(){return document.querySelector("#channel-list").innerHTML=""}const zn=["Auto","Business","Classic","Comedy","Documentary","Education","Entertainment","Family","Fashion","Food","General","Health","History","Hobby","Kids","Legislative","Lifestyle","Local","Movies","Music","News","Quiz","Religious","Sci-Fi","Shop","Sport","Travel","Weather","Other"],qn={Akan:"aka",Albanian:"sqi",Amharic:"amh",Arabic:"ara",Armenian:"hye","Assyrian Neo-Aramaic":"aii",Azerbaijani:"aze",Bashkir:"bak",Bengali:"ben",Bosnian:"bos",Bulgarian:"bul",Burmese:"mya",Catalan:"cat",Chinese:"zho",Croatian:"hrv",Czech:"ces",Danish:"dan",Dutch:"nld",English:"eng",Estonian:"est",Faroese:"fao",Finnish:"fin",French:"fra",Galician:"glg",Georgian:"kat",German:"deu",Hebrew:"heb",Hindi:"hin",Hungarian:"hun",Icelandic:"isl",Indonesian:"ind",Inuktitut:"iku",Italian:"ita",Japanese:"jpn",Javanese:"jav",Kannada:"kan",Kazakh:"kaz",Khmer:"khm",Kinyarwanda:"kin",Korean:"kor",Kurdish:"kur",Lao:"lao",Latvian:"lav",Lithuanian:"lit",Luxembourgish:"ltz",Macedonian:"mkd","Malay (macrolanguage)":"msa",Malayalam:"mal","Mandarin Chinese":"cmn",Maori:"mri","Min Nan Chinese":"nan","Modern Greek (1453-)":"ell",Mongolian:"mon",Montenegrin:"cnr","Nepali (macrolanguage)":"nep","Norwegian Bokmål":"nob",Panjabi:"pan",Persian:"fas",Polish:"pol",Portuguese:"por",Pushto:"pus",Romanian:"ron","Russian\t404\t":"rus",Serbian:"srp",Sinhala:"sin",Slovak:"slk",Slovenian:"slv",Somali:"som",Spanish:"spa",Swedish:"swe",Tagalog:"tgl",Tamil:"tam",Thai:"tha",Turkish:"tur",Turkmen:"tuk",Ukrainian:"ukr",Urdu:"urd",Uzbek:"uzb",Vietnamese:"vie","Western Frisian":"fry","Yue Chinese":"yue",Undefined:"undefined"},$n={Afghanistan:"af",Albania:"al",Algeria:"dz","American Samoa":"as",Andorra:"ad",Angola:"ao",Anguilla:"ai","Antigua & Barbuda":"ag",Argentina:"ar",Armenia:"am",Aruba:"aw",Australia:"au",Austria:"at",Azerbaijan:"az",Bahamas:"bs",Bahrain:"bh",Bangladesh:"bd",Barbados:"bb",Belarus:"by",Belgium:"be",Belize:"bz",Benin:"bj",Bermuda:"bm",Bhutan:"bt",Bolivia:"bo",Bosnia:"ba",Botswana:"bw",Brazil:"br","British Virgin Islands":"vg",Brunei:"bn",Bulgaria:"bg","Burkina Faso":"bf",Burundi:"bi",Cambodia:"kh",Cameroon:"cm",Canada:"ca","Cape Verde":"cv","Cayman Islands":"ky","Central African Republic":"cf",Chad:"td",Chile:"cl",China:"cn",Colombia:"co",Comoros:"km","Congo - Brazzaville":"cg","Congo - Kinshasa":"cd","Cook Islands":"ck","Costa Rica":"cr",Croatia:"hr",Cuba:"cu","Curaçao":"cw",Cyprus:"cy",Czechia:"cz","Côte d’Ivoire":"ci",Denmark:"dk",Djibouti:"dj",Dominica:"dm","Dominican Republic":"do",Ecuador:"ec",Egypt:"eg","El Salvador":"sv","Equatorial Guinea":"gq",Eritrea:"er",Estonia:"ee",Eswatini:"sz",Ethiopia:"et","Faroe Islands":"fo",Fiji:"fj",Finland:"fi",France:"fr","French Guiana":"gf","French Polynesia":"pf","French Southern Territories":"tf",Gabon:"ga",Gambia:"gm",Georgia:"ge",Germany:"de",Ghana:"gh",Greece:"gr",Greenland:"gl",Grenada:"gd",Guadeloupe:"gp",Guam:"gu",Guatemala:"gt",Guinea:"gn","Guinea-Bissau":"gw",Haiti:"ht",Honduras:"hn",Hungary:"hu",Iceland:"is",India:"in",Indonesia:"id","🌍International":"int",Iran:"ir",Iraq:"iq",Ireland:"ie",Israel:"il",Italy:"it",Jamaica:"jm",Japan:"jp",Jordan:"jo",Kazakhstan:"kz",Kenya:"ke",Kiribati:"ki",Kosovo:"xk",Kuwait:"kw",Kyrgyzstan:"kg","Laos 0":"la",Latvia:"lv",Lebanon:"lb",Lesotho:"ls",Liberia:"lr",Libya:"ly",Liechtenstein:"li",Lithuania:"lt",Luxembourg:"lu",Macao:"mo",Madagascar:"mg",Malawi:"mw",Malaysia:"my",Maldives:"mv",Mali:"ml",Malta:"mt","Marshall Islands":"mh",Martinique:"mq",Mauritania:"mr",Mauritius:"mu",Mayotte:"yt",Mexico:"mx",Micronesia:"fm",Moldova:"md",Monaco:"mc",Mongolia:"mn",Montenegro:"me",Montserrat:"ms",Morocco:"ma",Mozambique:"mz",Myanmar:"mm",Namibia:"na",Nauru:"nr",Nepal:"np",Netherlands:"nl","New Caledonia":"nc","New Zealand":"nz",Nicaragua:"ni",Niger:"ne",Nigeria:"ng",Niue:"nu","Norfolk Island":"nf","North Korea":"kp","North Macedonia":"mk","Northern Mariana Islands":"mp",Norway:"no",Oman:"om",Pakistan:"pk",Palau:"pw",Palestine:"ps",Panama:"pa","Papua New Guinea":"pg",Paraguay:"py",Peru:"pe",Philippines:"ph","Pitcairn Islands":"pn",Poland:"pl",Portugal:"pt","Puerto Rico":"pr",Qatar:"qa",Romania:"ro",Russia:"ru",Rwanda:"rw","Réunion":"re",Samoa:"ws","San Marino":"sm","Saudi Arabia":"sa",Senegal:"sn",Serbia:"rs",Seychelles:"sc","Sierra Leone":"sl",Singapore:"sg","Sint Maarten":"sx",Slovakia:"sk",Slovenia:"si","Solomon Islands":"sb",Somalia:"so","South Africa":"za","South Korea":"kr","South Sudan":"ss",Spain:"es",SriLanka:"lk","St.Barthélemy":"bl","St.Helena":"sh","St.Kitts & Nevis":"kn","St.Lucia":"lc","St.Martin":"mf","St.Pierre & Miquelon":"pm","St.Vincent & Grenadines":"vc",Sudan:"sd",Sweden:"se",Switzerland:"ch",Syria:"sy","São Tomé & Príncipe":"st",Tajikistan:"tj",Tanzania:"tz",Thailand:"th","Timor-Leste":"tl",Togo:"tg",Tokelau:"tk",Tonga:"to","Trinidad & Tobago":"tt",Tunisia:"tn",Turkey:"tr",Turkmenistan:"tm","Turks & Caicos Islands":"tc",Tuvalu:"tv","U.S. Virgin Islands":"vi",Uganda:"ug",Ukraine:"ua","United Arab Emirates":"ae","United Kingdom":"uk","United States":"us",Uruguay:"uy",Uzbekistan:"uz",Vanuatu:"vu","Vatican City":"va",Venezuela:"ve",Vietnam:"vn","Wallis & Futuna":"wf","Western Sahara":"eh",Yemen:"ye",Zambia:"zm",Zimbabwe:"zw","Åland Islands":"ax",Undefined:"undefined"};class Zn{init(){const t=document.querySelector("body");fetch(`${o}index.m3u`).then((t=>{if(t.ok)return t.text()})).then((e=>{this.playlist=v(e),this.channels=this.playlist.items;const i=v('#EXTM3U\n#EXTINF:-1 tvg-id="FeiCuiTai81.hk" tvg-name="翡翠台" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="http://img.tvb.com/corporate/_fck_/image/Jade_logo_L(1).jpg" group-title="",翡翠台\nhttps://cdn.hkdtmb.com/hls/81/index.m3u8\n#EXTINF:-1 tvg-id="J2.hk" tvg-name="J2" tvg-country="HK;MO" tvg-language="Chinese;Yue Chinese" tvg-logo="http://img.tvb.com/corporate/_fck_/image/J2_logo_L(2).jpg" group-title="",J2\nhttps://cdn.hkdtmb.com/hls/82/index.m3u8\n\n#EXTINF:-1 tvg-id="TVAsahi.jp" tvg-name="TV Asahi" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/TV_Asahi_Logo.svg/1280px-TV_Asahi_Logo.svg.png" group-title="",TV Asahi\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa4/index.m3u8\n#EXTINF:-1 tvg-id="TBS.jp" tvg-name="TBS" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Tokyo_Broadcasting_System_logo_2020.svg/1280px-Tokyo_Broadcasting_System_logo_2020.svg.png" group-title="",TBS\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa5/index.m3u8\n#EXTINF:-1 tvg-id="NipponTV.jp" tvg-name="Nippon TV" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://static.wikia.nocookie.net/drama/images/1/17/Nippon_TV.png" group-title="Local",Nippon TV\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa3/index.m3u8\n#EXTINF:-1 tvg-id="FujiTV.jp" tvg-name="Fuji TV" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://tse4-mm.cn.bing.net/th/id/OIP.QZnTkBN0ieas8K8Be7tRbgAAAA?pid=ImgDet&rs=1" group-title="",Fuji TV\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa7/index.m3u8\n\n#EXTINF:-1 tvg-id="BSAnimax.jp" tvg-name="BS Animax" tvg-country="JP" tvg-language="" tvg-logo="https://www.animax.co.jp/sites/all/themes/responsive/responsive_animax_jp/logo.png" group-title="",BS Animax\nhttp://redlabmcdn.s.llnwi.net/jp01/bs14/index.m3u8\n#EXTINF:-1 tvg-id="BSAsahi.jp" tvg-name="BS Asahi" tvg-country="JP" tvg-language="" tvg-logo="https://company.tv-asahi.co.jp/saiyo/group/img/company/logo-bsasahi.png" group-title="",BS Asahi\nhttp://redlabmcdn.s.llnwi.net/jp01/bs04/index.m3u8\n#EXTINF:-1 tvg-id="BSFuji.jp" tvg-name="BS Fuji" tvg-country="JP" tvg-language="" tvg-logo="https://www.zne-iptv.com/wp-content/uploads/2017/10/22-BS-FUJI-770x480.jpg" group-title="",BS Fuji\nhttp://redlabmcdn.s.llnwi.net/jp01/bs07/index.m3u8\n#EXTINF:-1 tvg-id="BSNIPPON.jp" tvg-name="BS NIPPON" tvg-country="JP" tvg-language="" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/BS4_logo.svg/1200px-BS4_logo.svg.png" group-title="",BS NIPPON\nhttp://redlabmcdn.s.llnwi.net/jp01/bs03/index.m3u8\n#EXTINF:-1 tvg-id="BSTBS.jp" tvg-name="BS TBS" tvg-country="JP" tvg-language="" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/BS-TBS_2020.svg/1200px-BS-TBS_2020.svg.png" group-title="",BS TBS\nhttp://redlabmcdn.s.llnwi.net/jp01/bs05/index.m3u8\n#EXTINF:-1 tvg-id="BSTVTokyo.jp" tvg-name="BS TV Tokyo" tvg-country="JP" tvg-language="" tvg-logo="https://static.wikia.nocookie.net/logopedia/images/d/d8/BS_TV_Tokyo_logo.png" group-title="",BS TV Tokyo\nhttp://redlabmcdn.s.llnwi.net/jp01/bs06/index.m3u8\n#EXTINF:-1 tvg-id="Bs12.jp" tvg-name="Bs12" tvg-country="JP" tvg-language="" tvg-logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYUAAACBCAMAAAAYG1bYAAAAk1BMVEX///8BSJgAOJLJ1OUARpcANZDq7fS/y98ARJbN1+cAQ5YAPpQAN5EANJAAPJMAQZUAMZAAS5rv8/gwX6Kmt9OUpcdDbKo7ZqYhVp7X3em5xtz2+fxVdK3c4+57lL9aeK4ALI2InsRxjLoSUJyvvtdggLQkWKAAJoxohreYq8wAIYqBlb7i6PGqttF1kL2ywdkAEofDcONZAAAKl0lEQVR4nO2daWOquhZABYMiIQkgDohjHaptT3v//697DKIEdgBt6zny9vpye3sC1KwMOxN2OgiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCPBteFyb48KouC73FYjBYLLzwtseVnlN5fej1gkG3O1j0Kv+Y52f2qoMYTCeTTR+4wutvxi41mGHbBmPcHb/PmqoIDqzwmLcenDIc/Hmfby0ePUXXo+dwbbLcLe79kP88fV1TQDSL2mJZKIWzua5Ti5BrMpPq+grSVeLdIcWHGJCFwWbCDS4sol3SE2IKzrbLwQ985H8QtYUUqu9yqb+2tlXKySiPhHGozZ/ulpevLFvoH4VBTeAhyXPYYQfd+9mps6ARZ5SlDecMzp0k2bH6QS+OCVxWsOCNNFtU/jmm7jaqd89FrQVNc2ZpUs+tzKB1UPGYmaDgRZKF3gujSs0XCFvdGBL8+zSwQKw0qQsV5iu22kK4UlWinIVw6VRXgwtCVAl/RhpY0NKuYQ+X5gYWdroye68Wdrzm/jkIa1mr1MSCtYoSBqwmlcpCb2yoL7pYGNfdXsbpPiqDHoJsgbAIvVwoo4T7cnkmUfx4bWkUFk7qipC3sL5Jgkbsj4dl0QOQLJBpGIa9wabYR9KoO9QLvyNRSO9Op66IrBGlhcWweJ3CgnObBc3aPjKXfpuChfSXH4XaoHudoNCsCPcUJKFK2OtvtoYFW9iw6h79fgsaf39QDj0C0ELnJGuILHzJQy6xl+4yWDGzbGEwBcZpP2VBc1o0oQFbGMi9RdQi/ZEylPBiyD7YlsYLn+A47ccsiNXv5swjgS3I7Q+J2mDZgnko32koW+iTJpHnNyy0qTLAFrpSXRAvcTgv5x7QCeSjlnCvnuz4KQvi85fz5nHAFpZSdGlEY6SBXciCynHTl2g4DP6OBc363ax5IKCFgOcLspn8thhxGnPlLKo3txtVhFoLNXexWzN0K1qIBgzBRpJAnCS7j8XSbbGDDy6BLVjDilBlgZhcZ9QSts2VfTzdPCybfpnC2JlzbhhUluAnCRflKQaT23ugOHbtUspbLUQKxqduLyoSXuBPDIUHc/K4fPpdCvNIhMitAKH6eV678w4E/8Qytqdi0NoFp6YIWEFAC6Y9lWpZMFSEW+T38+cxVM3mEcGd3IrnGMyLqEJsZA+gBcGPVkML+rTU8x/h4R9ry6aACgtkuJxJaceKtFT388kAC6azDwOooSpbEFy62Zk5pFAz2jJiqFj9386XvhwHAcv3aVJ9kiuVJQtEPwTF8bjKggEvpHkcerLeliCpqi5ELZItpOZmMFVMkQp6HcYVLVCRlO4mFkwGVYSYF6hbaU2oWrvKQ/lXPv1uq4ONA7EvrYNswWTL1GMDCxZRrteBfydrb4tULOxZqJrxNWECqBCmliXIWyBsnOVUvQVxUPe2C2jBjin2lD0dxUjVJFZpnOQURsnBJwWGUnx5/uecBe5e+/daC7Qq/O8BK6LxXG87KM9ghL3ZRA4MzWHpst2kPEB2ziX5YkGwUe6SOgt0XPV3QnWBtGa9TbJgZrN5n/LQgAHNdbB3Ch1EFmKeLRBnLzUYNRZE9UC4D4wYrNasMMBzqh1XavnpCLp0caBgpiQWoui00I5VW1gDKxZ5NsCQkZ/u/tj/GAoL71J7U1jfvCCPpcg5I2MLlJZCzhoLNU38AZhLMlqzd1hhwZeX1uKOAYgKQ3ks5aa/7eqm81nO1GoLNbvtwN1QLV9fKC7/kzh/KbCuM5RKaGbhbQzF8dUWaoAGbfESYEtQWJA/dfJ7l5ULuNR9ZIvRA3hz+3cs9MA5qLaMnFUWPLnoWXEQ6RIqRvKwypcy1ppXPuk7FkpLTFqb4lSFBW8i94UiHpDF5Z6z1e6yyL/4lGP4mqWvb1joQr0COPf6pBQsBEEw2L0Up4r0uEtIWx+LMz5Z7ff7CTUKBZRVhyzfsAAtQBP+Ex//H6Gw4mnbts6L00SExikvfQAxLSFE6dBTXQtxv4UVtLzUnsFCp+H5heQDuzU7IthX9ZPutnCCJvJIa1Y7YxpYsNLYp8aCqJwG6txvYQaebGjXOZJ6C6ZIc6ragrWtm9+800LXgJ7bpk2qnSarPO45KCJVFviwdiH+PgvgVRqx2jKnnVJjwWL77PMeGbjIlqZaVj4k4S4LfXi7a8sOVFXvhKFsnIs+gxWjwJwaiQYRTVYe77HwBZ92s1uzKe8MbIGYgnLmbgq52zsdWPz+hWsqrrPDqNn49w4LJ3jPB1dM8T4vszdWwnH0w2rzBWaQN9ustsxJUpHJ8dRvvDHrdgtHuCbUrAc9I2GvTH3PF0bc+qRbLXiKfZHWVHkJUsuNFroCDgbEtF3h0YO5zcJIcRaIDlHCd7jFgqfaEsurZ8+ROm6w0KeKcyisPUfZ/hLNLXwqWiPTadGSwl+iqYXFVHFmhKp3sSJNaWhhpDirTljrxmp/g0YWPg6KlzZQMYNvi9xEEwuqimA6L60OUIPlZvm95jYYdFXvKvL6HX+eTXHUW1gM4YpAjEnLe4S+Q517l61O7++nTmfL1vkpzkG3e8mylzd/tM7Wh2stjBRT53zb+saor6c7LO5hzuNB1NCUNhMfGLuMrBbOwXOybcA1FhaqHmHayjeoyigsdH3/2ggEm5FEln5lxdu0CxYmJLeh3X3zhlmLXm2hv1YcLSfbqQtD6la6nweFhSNzrjtNfIfmYdlbumAL5sWCP86Psqot+MoXWhEVVqssiGW5d10K+ufyPzvDiojLKol/4Fk3oLCQrsx7I6pb61yLfq8FJWarLGjCOfjXQPC/eKEn6idp/N+3WFB/PI8Ym9Hnjn+YZ7VEXRe83diJR8D09XpftKAmXfE0uX3MVjcdjZgRUeE3kzfmZQS2pssBo2zhM61RE5McJka8x9LSxSa3EocW1PSTgzckfp37PM1jR3MnKUOS3wwa5aIt70Qdm+J4sRC+suQc28SMLMZe2VjerIcW1EQWuH9y40M5gq3i4uxcjnR+GES7pixb2BLxfrEQ3Sh5f2G83Zvq+tgvzhChBTXnGMlPPKzjbT7O5dWEfT1/JKFsgSVbds8WjiJVFlnYbqA9AWhBzSVS9blI8/yVZhaWNN/vlix8GFr88qTUQo+R5JRDPlKVQQtqruOF8Phf0jGsjtmCliUdSShZmPHkVZKphbGlOUn3jBbuID9qK5wCWVLptaklC0ehGWFi4dR54RpNv4wELdyBeh5paRNpnm8QRap5Cz2Wnncbmub8QDXzfO4VLdyBwkLPd6lmpE3TR/rNaj6Noqn0x2RoMRbp0bKhqVlEM/XzADzunWdnvvzNtXtHC2oAC4Pl3LU5MZ3zfNFmnXy1WpxNPPnJie182ue3bcdnnok+zWZBViJKlkGpc70tWlACWFisLWJSNsx2p4+KGUTjYKjnmnYyWTek1NCuU39fazM/5ba+/ANogaGFmP4rfy0uoriONdlcJyvOdeFKUhc6PZ7mwmq/kU4T7IZCZNOvwt1eRg5d6FsSL99d6BcfUg8rvzDoWQk9r/RdnB+9UhKZ9IIP1VJweCX3W/gbQ7MUPcX3iVbRmpeRIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIMj/Ff8DY7msWHXTmyQAAAAASUVORK5CYII=" group-title="",Bs12\nhttp://redlabmcdn.s.llnwi.net/jp01/bs08/index.m3u8\n#EXTINF:-1 tvg-id="FujiTVJOCXDTV.jp" tvg-name="Fuji TV (JOCX-DTV)" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://tse4-mm.cn.bing.net/th/id/OIP.QZnTkBN0ieas8K8Be7tRbgAAAA?pid=ImgDet&rs=1" group-title="Local",Fuji TV (JOCX-DTV)\nhttps://gorilla.gaki-no-tsukai.eu/hls/test.m3u8\n#EXTINF:-1 tvg-id="GunmaTV.jp" tvg-name="Gunma TV" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/Gtv_logo_ja_01.svg/800px-Gtv_logo_ja_01.svg.png" group-title="Local",Gunma TV\nhttps://movie.mcas.jp/switcher/smil:mcas8.smil/master.m3u8\n#EXTINF:-1 tvg-id="JSports1.jp" tvg-name="J Sports 1" tvg-country="JP" tvg-language="" tvg-logo="https://lh3.googleusercontent.com/proxy/Zm9sSKVZBe79OIZLWlHAsqgwOqN4PTxzvJ3gKd5IzHax6jCimThTDxIR2gd6ET_hocvZKI8vQh6TjnodJR63i7Sf-UKZQLi6YJYtZGtFPA" group-title="",J Sports 1\nhttp://redlabmcdn.s.llnwi.net/jp01/bs15/index.m3u8\n#EXTINF:-1 tvg-id="JSports2.jp" tvg-name="J Sports 2" tvg-country="JP" tvg-language="" tvg-logo="https://lh3.googleusercontent.com/proxy/4RdaB-IvY-tJ7l9RORmaBNsTaHN1pQCCoEDfAdxNQ99CQrDsHvXkp5eHlAG8AkTZIXvRyQsriCpuho4qpHwPvGkY69X2aFmPMZhXs7hmDg" group-title="",J Sports 2\nhttp://redlabmcdn.s.llnwi.net/jp01/bs11/index.m3u8\n#EXTINF:-1 tvg-id="JSports3.jp" tvg-name="J Sports 3" tvg-country="JP" tvg-language="" tvg-logo="https://lh3.googleusercontent.com/proxy/gDv9JIRTwviyY-oVlVfnY5n3-fVeGD_NeX8EDhXVDmS-wL6sDWSvfq8QOhVdeKu1GFqgcjzH7avyvHplnS56bPM_WmgwDrz3y87i0VPXjw" group-title="",J Sports 3\nhttp://redlabmcdn.s.llnwi.net/jp01/bs12/index.m3u8\n#EXTINF:-1 tvg-id="JapanetChannelDX.jp" tvg-name="Japanet Channel DX" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://img.japanet.co.jp/shopping/img/senqua/header/logo.gif" group-title="Shop",Japanet Channel DX (1080p)\nhttps://bcsecurelivehls-i.akamaihd.net/hls/live/265320/5043843989001/140130JTDX/index.m3u8\n#EXTINF:-1 tvg-id="JSTV2.jp" tvg-name="JSTV 2" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://www.monpetitforfait.com/comparateur-box-internet/wp-content/uploads/2020/05/jstv2-regarder.png" group-title="Local",JSTV 2\nhttps://aka-amd-njpwworld-hls-enlive.akamaized.net/hls/video/njpw_en/njpw_en_channel01_3/chunklist_DVR.m3u8\n#EXTINF:-1 tvg-id="NHKBS1.jp" tvg-name="NHK BS1" tvg-country="JP" tvg-language="" tvg-logo="https://static.wikia.nocookie.net/logopedia/images/2/27/NHK_BS1_%282020%29.svg" group-title="",NHK BS1\nhttp://redlabmcdn.s.llnwi.net/jp01/bs01/index.m3u8\n#EXTINF:-1 tvg-id="NHKBSP.jp" tvg-name="NHK BSP" tvg-country="JP" tvg-language="" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/NHK_BS%E3%83%97%E3%83%AC%E3%83%9F%E3%82%A2%E3%83%A0_%E6%96%B0%E3%83%AD%E3%82%B4.png/480px-NHK_BS%E3%83%97%E3%83%AC%E3%83%9F%E3%82%A2%E3%83%A0_%E6%96%B0%E3%83%AD%E3%82%B4.png" group-title="",NHK BSP\nhttp://redlabmcdn.s.llnwi.net/jp01/bs02/index.m3u8\n#EXTINF:-1 tvg-id="NHKChineseVision.jp" tvg-name="NHK Chinese Vision" tvg-country="JP" tvg-language="Chinese" tvg-logo="https://i.imgur.com/4yRulEZ.png" group-title="News",NHK Chinese Vision\nhttps://nhkw-zh-hlscomp.akamaized.net/8thz5iufork8wjip/playlist.m3u8\n#EXTINF:-1 tvg-id="NHKE.jp" tvg-name="NHK E" tvg-country="JP" tvg-language="Japanese" tvg-logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAaVBMVEUDr3r///8AqnAArHXh8upGvZOG0LTk9e8Wsn9Zv5cAqW4ArHT5/Pvy+/jh9O3V7uWa17+75NRyyaiQ1Lo3uIuk28XE59qAzrDM69/u+fVfw55rx6R4y6uo3Miz4c+Aza9NvpUktoYAo2JurtshAAADh0lEQVR4nO3c61biMBSG4TQZBBoOighycIS5/4scIEmTYAXLWg474/v8Mn4u3dvGpKmiUgAAAAAAAAAAAAAAAAAAAAAAAPhGxlwYdgjPPlSMer4d6jg0ajZT9pPQZqHubdcxtGYzG1glj11UVdUfNMPZYVhtbXu4/TzUm2P2nHw7hLAvx8KqSe3H89Owmqfh9FI4cT3Vby5bi5upeuwqe3AXxpddvdg03Ku2cBRDoyZuUD1Jm6em5yur3Gyr+270+1RoCHsqC9/OQ70On6V6lTZN7WNTmpuKfrQ0aeivy8AP320e1i9Ng9WjtGuop01ts0NtZpleUT3JrksTqiysmxl6sJLWYHPNDkaHkV64t/vZBX1wq0cIJ/nV3o3i53gVt86YWayueqqV9dWe1pImVNoe6Lo1TGZo9Vxf+4L/nH1K6qvWduff2pk0XI2d1jCZBD1pq4yK24EzDkvGyH4MYyOfhFMlboqquOKHGefXncXpYsxbG/Rh7/zdj/JmqEr3ity76RqOdwJnqIp7xWKR1ztIw3Ot4UrkFD0siL6+B5WV6/YKU7XKN5KkRYnM1pe3t8u02nw7GHmt4b5ZcPry9vq44q/qfNZl28HqT30ybwv79aDZ76cCl5qw4h/vpPexwZE+D1U8V+R7xZs1ccUVd9MdV/zjmS5ZHPO9wh/4wm3ohzCeTqonaS3mRwfdD4W2nivaDx2nwbBpsSdsQQ130m52nZ0UbRYqs0lD/ZqGNmTVs7AOw3IRjg7+OYTbDs5CM7wQ6rASvwtbT40/mYexHSdlh5ZCqFeXwud8LIYrbBi+8WZ+XPl/6zRsHizloXVhfK54+sEcCpukB3aw3CSPcY3eLOc6httZFq4/D4/jjZXXoPr4RNveGop94A0A+A6mg3vXepN5r4t7V3sDf/v5VQKP9dfoX10aHNGhQHRIh/LR4U/rsPT9cHDdvcu9QdrhvWv5HnRYPjosHx2Wjw7LR4flo8Py0WH5upwP713rbTqc8VcFHvBVpw4ndCgTHdKhfHT4ozrsl9/h8LLdvWu9TXZf+h/+IcZPu/O+dy3fgw7LR4flo8Py0WH56LB8dFg+Oixf2qGu9TXCXjP6FWmH/evE/d+r6zr+9eVU2uvTr6NDOpSPDulQvvj/P75kUl6HZvvQxazAZ/tdXkJa7i8vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKDFX+qdL/AYZn9DAAAAAElFTkSuQmCC" group-title="",NHK E [Not 24/7]\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa1/index.m3u8\n#EXTINF:-1 tvg-id="NHKG.jp" tvg-name="NHK G" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/6/6f/NHK%E7%B7%8F%E5%90%88%E3%83%AD%E3%82%B42020-.png" group-title="",NHK G\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa2/index.m3u8\n#EXTINF:-1 tvg-id="NHKGeneralTV.jp" tvg-name="NHK General TV" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/6/6f/NHK%E7%B7%8F%E5%90%88%E3%83%AD%E3%82%B42020-.png" group-title="",NHK General TV\nhttps://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8\n#EXTINF:-1 tvg-id="NHKWorldJapan.jp" tvg-name="NHK World Japan" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://i.imgur.com/SQISXoD.jpg" group-title="News",NHK World Japan (720p)\nhttps://nhkworld.webcdn.stream.ne.jp/www11/nhkworld-tv/global/2003458/live.m3u8\n#EXTINF:-1 tvg-id="ShopChannel.jp" tvg-name="Shop Channel" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://i.imgur.com/3K36JEA.jpg" group-title="Shop",Shop Channel\nhttps://stream3.shopch.jp/HLS/master.m3u8\n#EXTINF:-1 tvg-id="NipponTVJOAXDTV.jp" tvg-name="Nippon TV (JOAX-DTV)" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://static.wikia.nocookie.net/drama/images/1/17/Nippon_TV.png" group-title="Local",Nippon TV (JOAX-DTV)\nhttps://cdn-live1.qvc.jp/iPhone/1501/1501.m3u8\n#EXTINF:-1 tvg-id="Star1.jp" tvg-name="Star 1" tvg-country="JP" tvg-language="" tvg-logo="https://www.star-ch.jp/resources/img/base/logo-black.svg" group-title="",Star 1\nhttp://redlabmcdn.s.llnwi.net/jp01/bs09/index.m3u8\n#EXTINF:-1 tvg-id="Star2.jp" tvg-name="Star 2" tvg-country="JP" tvg-language="" tvg-logo="https://www.star-ch.jp/resources/img/base/logo-black.svg" group-title="",Star 2\nhttp://redlabmcdn.s.llnwi.net/jp01/bs10/index.m3u8\n#EXTINF:-1 tvg-id="TokyoMX1.jp" tvg-name="Tokyo MX 1" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Tokyo_metropolitan_television_logo_%28rainbow%29.svg/800px-Tokyo_metropolitan_television_logo_%28rainbow%29.svg.png" group-title="",Tokyo MX 1\nhttps://redlabmcdn.s.llnwi.net/jp01/ryowa8/tracks-v1a1/mono.m3u8\n#EXTINF:-1 tvg-id="TokyoMX1.jp" tvg-name="Tokyo MX1" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Tokyo_metropolitan_television_logo_%28rainbow%29.svg/800px-Tokyo_metropolitan_television_logo_%28rainbow%29.svg.png" group-title="Local",Tokyo MX1 (360p)\nhttps://movie.mcas.jp/mcas/smil:mx1_prod.smil/master.m3u8\n#EXTINF:-1 tvg-id="TokyoMX2.jp" tvg-name="Tokyo MX2" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Tokyo_metropolitan_television_logo_%28rainbow%29.svg/800px-Tokyo_metropolitan_television_logo_%28rainbow%29.svg.png" group-title="Local",Tokyo MX2 (360p)\nhttps://movie.mcas.jp/mcas/smil:mx2_prod.smil/master.m3u8\n#EXTINF:-1 tvg-id="TVTokyo.jp" tvg-name="TV Tokyo" tvg-country="JP" tvg-language="Japanese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/TV_Tokyo_logo_20110629.svg/1200px-TV_Tokyo_logo_20110629.svg.png" group-title="",TV Tokyo\nhttp://redlabmcdn.s.llnwi.net/jp01/ryowa6/tracks-v1a1/mono.m3u8\n#EXTINF:-1 tvg-id="WeatherNews.jp" tvg-name="Weather News" tvg-country="JP" tvg-language="Japanese" tvg-logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY4AAAB/CAMAAADPY9VGAAAAtFBMVEX///8MQZoAPZgAOZcAO5gAPpkANpYAMpUAKZIANJUoUqJBZaz19vkAMZTW3u2xv9zr7/cALZOEmMXp7vbz9vqYrNLg5vHL1ulmg7u/y+Lk6vQkTqAAJpGpudjZ4vBOc7Ryh7u7xd0zWaWJoMt7lcUQRZyksdIuWabI0uZzjsFObK41YKpdfbhWb67Ayd9ZdrMAFo0AII+TqNAAB4tVfbs/bLGSq9J9mspph76Mm8RmfLR7jr6ddp+6AAAVOUlEQVR4nO1dCVvivBaGJm0pS6FSdkFBiiyOzsd3595R////uj1LlhYUdQScmZ55nnmkNGly9vckDaXSCxTf9Zth+6VvCzoxdUfCL2+eO5NzD6QgoPuoXC47Ioj8q0U4PPdo/nqaizKT9N3NdSc894D+bhq5ZUOO8KLgqlNYybmo5ZXzJAOwkt65R/ZXUnNXHGQlDT+1ku65h/e30aPYJw62Erm53hZWckKKv8kXxZGSKz0/+LEtYsmJqJuJ5C9YiSdm19vluYf6N9B946A02EqCoLbtdevnHvCfTfOXQ8ceK/Fu+4WVHJPe4KtyVuJ5tZvCSo5DcfAuabCVBGAlg3OP/Q+k/aijsJIz0Suo4zA5XlB92g4KiXwWHUAdb7ESIbxNaiXxuafyJ9BbUMcbreRxUEjkV+mNqOMwgZWIzcWysJJfofkHI/l+cjy/evc4LSTyUap+hq+yCaxEbv5XWMlH6EOo4zClVjJ6eGwWEnknfRR1HKbUSqS8nRdW8h76JdRxmByvAVbSOvc0fxOKH34RdRwmjCW38/vCSg7T56CON8hENJL5uSf79enTUMdh8jvnnuzXp89FHa9SVOzeOkifjjpeJPe2iOeHKPZPJY2y7Bdl30N0PNSxQ2Jx7sl+fToy6shQsXR4iE6AOhS5owJ2HKLu6SK5XJ97sl+flqdDHcH23JP9+lSgji9FJ0Qd1QJ1HKJToo67AnUcouZxlp72kVcUrA7S4+lCR4E6DtJJUUcROg7RKVFH7dyT/fq0PF0k927OPdmvT6dEHcXbhQfp9nSoY1QceHKI4myFRFYMZeXkRuo6mVNkbszZl+kDkwShPv1zVdQPD9EwIw75VDeU2PJwZxO+XNoC+72WuXGRyc3kt5K6s59+IS7Mjeee7G9AGaZ7donvyuayfNDXITN27CSpl9jisAJ2zUkbNo8/hz+I+vbaU6bEt/D3MrkOu4C8R+vG+szd20eY3umOiqrhe6hpeyvP/ibMCEpnRUsMCFP7ThtJuomOEM20A2dz/Cn8SRRa3kpe2d+0N47hstCXFwJKsxmd71hlL2tzwkUaZMTPo8/gj6L22qi2n91YcC32CWoldlb1JpaFebqPGEJHowgd76Nnyydl39zvmG8CzeQ2ABWR3drZmhk7SnSZsAU24xVY43200LDB2WSPSVoau3G1oCbA5MY024cRqTvT/Ieo5NQKrPE+mugESvZzX+mw4s70ST0YJ/wckxfm3L5v+uJPAajjmEP/I6msmL6zOqSRRx515NOlpUYe1uaEAnV8iO4U03c2FuiMyYKHiDrypdlYV+kL1PGrNFbeKsh/E3o7TO7BRzHN36nsyNrX1gQzmh1v2G+iuI30OwWw0N1JZpnaDLddV1/agzqAlB1Z4ecroI74elRNKfmdKvvtGqWpBnXoNVRGHlboeN5FHUAKeeRQh3/m0DG8lW5K0W9VvFRwTyez2hcx8jCoowVIXax0UwUyWhw8Et0HngN7btRBdR739ryjeCd1MEQ4NZPMqj+WTk5QE7jVIO22urPel5QQa8M6L+qY1PUgUvW5PtMoPkYhOn75pC+YAIDIw9loQWGVt6GZPNUpFiEPy6utzoc66r27Mv31E0cVjM8yjA+T62ZQR2ut+f1DZgWVQx0dLThCHhZygdAhzhE6uuON7/EQ2YX+Zqc2YppqktllVf9mBK385VCH1vn6kw7qhDwi3fBcqGOyGgmphthyyIP+Fj+B0dJ+Hl2QVUKXOjFEP2aYnEMdrZGpUIFI86jjDGsdP3xQi4CGOJC5us1XpqXOl0KZQR0XFe1khrepkpf1NznUEUYjLTiwI2GCzuOZUAdWfFwGGhTQrETwK9NCC2CYpq8GdcTffM3HepoEyzvdhFCHzuK3nrGUXpRBHRB0/NOH0AkniWS0VGg+wzA+QldmKRaQh9bzbiJH+psUebyMOtbShJVWmoRZqAMYEbxyYHu91YrTf1qy+Mm4zzp95g/D8byfUv7wy2HzAi7/7IR8vVVXCR523aKVtahbqk+28583od08Xm5/YmNzxulyAJTyob6c3w3S//Hzsl6qD1b9/ipzXFrcw+Yr3ZwGrPuKs59xuno+cW+83W6b2dNVvYpe3uh4SqFKeCRGRTNy6biGyd0s6ohHrslsU+ThzkwGDKhj8wrqGH+HrVffO5mPlQpHqfr6H9iYVaW+fkS+kFIKLxpZO12md37Dk3A9qGxQY5rfK6pWU6n8G6Z6hYmVLPXWkSeE11jraXUvRuklbBxdsSK2y1Gj0bjsl5qzyJODUk/C52hUmlaj9FYR1TS/2jdV1bzxA9mz/Be3kj2rwfHWMsWrFczncgTPby0evMj3gsCP1tbqa9gw/qnnWVApRQzGvuuJ3GhBYbEx0io8SL10WbN84VleDVHHa6fB0Fsl6jkxrxBLFgenzQP8yrFWwYJn1qj4wrFWMaV/ww/V5KuXHuVVM+EevAce7XTkmR0CorpU04F7xts0NXOrbcxGwNI6ksGwUABgOrOayzI47DDCxmqDDc9HZfqxp2HAeOPp+UjfALOOJ571h8Q3epemrJZwfngGdfwnhzrSh0TadAb28S8HUceU3Drf0mRGChbHykNGpLMf1nAmrpTEgIBb9LEM7QQRZlKpWoQMktRM02HeUNOaENy47FJRZ9FABjuSlYASQnZ0c+gZynL04otbDTzBzXk7TdOXmeZJqqDdjDh6FZ4Pq1sH+nTd9DE3lw6Om7oo+zr2Xgu51orev9RL3G3YjlPT39xUXkQdUBgxSx/dUUUnxBNAHa/WUac4HLXIW2NGBtQDKxNwnlgsR3d3dMiTc8sMxcu18aRJUA8sfZSoVbAkcee6V29298DrmjT7JcJe163drel28r+8wox9pJatXnyRm4sVN6f7lkmuOTB9SOJgXvVlRhxk/MCqBacai+kdaoTOZ9Nsyk10ytr8rsMKaKrFyt53rf851NEGRlhlkdl7UMcUJ9hgNxExG30SB5brkfEdKjr1U3852WCTSp0GX1ZbupYku3Suy96YgsW6t1x21TKn/BaX2PHQ4OMqfHBHwNstbSOGTDKuqf0XrvQum6WYZBCAy23SkhAi5Ril7JaB07RUBF4mRnsQ5B96alWbxXGPLarDVNXhC/mQzmFIixcqaYJVjkC7k9CsaOCRGOabrq8FhajDIO0QWGWtol/lUEd+5T1D5KjZ+vW2OaoMkDLBELo4ZneEQ6CftGhAPJ36UDen2EfLNWSlxDYu1UyoqokwaUh8RphETok86xAZh0CxzTx0nVn/Zh6z+6E3tojZbhmiKG3OFGgHdZQ4bC2r2+LQO6L4CJY7wSPcYtsAPFGXtCtRvPVtjk3+o/6i478Ngmv90CzcQR34SO3l5u9BHRSsif3LsiL6jMokIW7S1LknCgUojlUyGo0S0gw6G43uoZKhIJsbUyzAOU7K5CTanK0rEQ9HWhxLMlFZVf4ekw2KBiQaHFKdjIPeq6tTc3DtDcP+oTJ2Fk+bRNVSeucPUYsg9bpU3MWihpJNqftf/Rd5Ro084v9pwdTyqAPHq4WwMDuspHroK+LAGhemjqg8ibEWUibgCnOOEsxnYx0tWHHlNJ6kRHUdup/LBhSKCTWRsxKQldDrXjwPSxwc+MvK+sn/094L45TYrDmJrNM9sPGSFAFFad5gInFgz94KjB39oQBLrg+RVIzGJpfqU1uzkg/i05ikbtwWNPFt1GENDAaqw/9B1JG6V2ztw1NQ9QTaGuZpqFyoD91LfAKndk8E6qxuW5NeOPmBIriFqFP3tRLrd1DJ4LY6wCgLuqcxE9fAF9Byv9CJC6sCNqcUGnX/kTJ0iqDDihYTuS0QxwRiqvsT/CyKA1dbUafUuqu3yqsq5cmaubH+fpVfANTp0i7qQHVKNPIs2X1YWfQ+ClEcHogDPK38hkJpAJNQmfD5W5y6s+4A3VAKpUoJ7e1TbVNNfRZp6zcT1TlLH94yCIShXZNoQOlIi5I5dto3gafqlu3QOMH73BnOihwB4OE6bVwWF9icRIv5FAWhJos+tVDcrQnfYE5PSz9PKqGfXWSVlVYA9/CMlwj2BOK7XdRh1C9D6NVerxSFNPsu79lOUx5QNEh8cae2swGxkz2UHQ+JEl16sSS88wPpQDzn4eJsFwZtqW0w9LYui6ZR5/QQWmCf9AB4LGVDZhsApX6UONLbxQANS+2G3Zy3EowV30AcMQzJb+K2DxQHBhtUvFLPVwDIS25sgVDwJ6Wyqc1JjlU0UYSoQyPtusqtvZ1TeA6jDrbocrlLCROANp99ACoTsnRYs7bQKy7iAJoJMcJR6JAiOUUX1g9KAwgmdTnJSv8c73mNHkyeo4vWwkWg7aY0SLQmTPcdbwQuFgXuDAjyyVqMjgkSgUlk9dtRBYJUIDWzKkaJ+54FIoWPd9m5D3UYBcr08YYdVpjCukmaisO0IfXDWNIkZSJEwem79C36BwYwpfcWPbmpPVD6jksyqmRIT6DdfB7GCGIihogLMmrP6jOq1lXg1+kgaxvlFmR1GP35B+QyzTEholAz4DJrkwYD4gAdMQlCb60MpCwvNTPV3qrgPscmfRBfkC9xjIVK3KkHpSbWdgXVh7dnv2+OEAW5oyFGCiyHgPGl3EBlClAp7ykyXzVtisF34NTlTbcVD+lneRoo4hGt7NMTqtbKx0qXZDjABwu7z4EJ/CqDicm9CZwbIx7gCD0uuck15/KBu6R3jG4ZPKXiQL2zik71ZlWqPYIahqsXzfJLM+ZHh6x6IFEOddzoV2yS3FI0DuTQIgNGCLfaGgLXBEwI5p8G8JVgL60UeXev1gVttcAnkFuniEIlQ54SeV32ubeOcipDMmon32eLIrd+datNNTHcChOTK4H1ghbj0t3TPCgx6+GjUJUfSBzo9IKME2puOOyKq0xjdqcWmeO/DSbh8WJ8vs49Hg03x3lEHY0DP06LJQn3tgV+QCIWggvBgiIgFcLI3QQ7qQLVqx5QM3oUvTFCbO0cdGCQBoNnd9ZVUcTZOY5jwtVfpW5NS7T00+F4BHDI+dbuhMi6JoOGishPtJUGxJPf39lSulzhC1q1L7Ox3Dr+u5Jd8O+K8h7UgWPOrcFOo4Oog8XhbBB0CnQoIF+vMw6gOkfKx+4GxxF3LoDmXcWpgPInAm/kc1FDVNCzkAZvF0OwRwk+m36IfV5ATxy5dVoyt2DdktvUVVDncNmdU3MUIcaaJASpUIClt7hhkbTs0JBaSMgYjmCX9LBQw/jcizPWkkGQfb1gP+ogC8uyfn4YdZQolXfWGDmecD5gC94W8xH2oKSJtMlrMsLMMtJT4f0ULDK0IBy72hRGqSNNz1ozp6oWbwDrRNjnSnHTWhNgpIFh4cbkz3b6W+pUsPmz4dxokVCaWFIbzVZSTzCsbWq12uyGpuNa4jDvVnrZnWnW8T25YIyow+yutF5Uy9vR23ZYQZByNwDieN8KQCpnLSjfssRR7ZoRo6AYneNNVAumCDGxd+8xAK6gplhr5mOrRMIxwQdZckxQmUqLkQY+hPyQO82Jo04i4xfD0JwS1KaBvuDOoJ+Aa2iRk1KE+JryfHWEkXkJk10wU9ticg55AG/ELupAO8q84fkW1FFSKUrZOFacj2tUV+FnLAgOE42ZOdvAHKhFf8truJ0Oy6a/uWZIpTezZq5SXsq+OgbED9kSlZ0vDdIoxTNTLiFxUOzoED5n4HjBJS9KE0vKpiymcwn03jya852heUXZrdqq3bTEkc2YQlTOXdSBz8skYU3nTTusdFFdhvZo4YJKNomLzm0vbN5SOgv+gsUh5u12r0ZWThGCpujOxrD74B7NhsIa5ydYLulSSulfhD1ioIMFSi4Magg1trYEUXmNgFTIi2DzXu8CBauTVT18weW/rX5XaWnfIa/apeHYVIhLBnXYNyNljv/ObG19CXWQrtnB4y2oo6QLICZZUw7UAGO+4iQjQYpYs1u6m03iETqgDIOrNq4ELs4t9esxfoG/WzW1IJuQ9CgRW1iBH+jZaq7WzOFvtUYlRlQXcOU4N3x9hpq+oCof/FqT3DxsaF5qO6F9vIUdPLIH8WWU/hk9u2a7Fj1piCXSN6GOklm/dFUey6N1y9pchxt1D/4X9enxHR696/j9MYV1VJOeyk8aYwbJ7NdpsFzKGgdWn2WZoCTr5L31wn9Ma8JYcM42b/JDqFYmXT3RhdIm1Yd6qUy7FA7fqQip7UjFV/vwF9uvZH90yNp9+MJahxapFbhb0MUh1JHSzwACm+NpmU8jumDlZD2hNg2UpZfcqCjHBSvprUvjBrThdYJVQBMFIQiZXpfkia88+Js3ipb6nt7IIOQtKUNrJuAWnTi2JDbH1eb6AzR3Kqw2c9NcipkJkWMe/pMaJc9HGGTX8TXXXClvtdplzttrTEKmydjW+VRZpuqryQDL4Tfqcy/7Y1GyH5o+fAhIPfU5+6a6RTeQ9aWkb1jyBRv1TR5HjQaUhdyrR5NYhHfpxUisUyVYYCOV8I3Xo0YURZtJKcTrm2sqj2O/V2r604ckSvts+NUnpbhterZOa8JbbL6Cz/EVjUuJavpEzaPqU9NKg+55+GaTwQw/bywkMX2SjcATnh8ld0aDDepAQVU1ZQ5Tglihv6HEw3wuZymx+sh8Tl48dD0mUGSqDfX8BaRhdzoej8PsD6rFYXNMv7FGvWhJxcPuZDIZ6s6oVb7juBumfTa7Q8PNtnV76W3Nw6Gdk5bq7fzwW9mx4U3dwWK+mo97Q2s+nawRuJpyTLa+cd98Z/Zz8V75YboWeW4ei9zRb/FqxVnJQh3Hpt1SXUF5CndczdHoN3m14qw09g/z8ZOoURy6fpAeTneQsSxOszpIq00QyJM4LLk+sOpRUErtcPEjkUIcPaJnzhMt6DVaLq5rnn9cK3EL1PEOSq1knYjjWUmBOt5PvdRKxHGspEAdH6J2OL46hpUUqOPj1Fs81+TnWklUoI5foc+2kgJ1/Dp9npUUqONzqB02HxJPiD17vd9DBer4RAoXz2v3l6ykQB2fS6mV3CWe90ErKVDHMWgyfl6XP2IlBeo4ErXASgJPvE8mBeo4JoGVJO+xkgJ1HJla4bSf+G+1ElGgjhNQF61EHJSILH4l8ESUWsnPpBG8biUF6jgpDZsX316zEnfnVwwKOi61JqmVRPutpPjljvNQO7WS0a6VFKjjbBRP7lcjOD7SkkmBOs5LrebFg2UlBeo4O7GV4AsQYvdF+ILOQDFYSeAXax1fhuLu/Tz/m3cFvUD/B8ZIl3TDpT0fAAAAAElFTkSuQmCC" group-title="Weather",Weather News\nhttps://movie.mcas.jp/mcas/smil:wn1.smil/master.m3u8\n\n\n\n#EXTINF:-1 tvg-id="A1Tai.hk" tvg-name="A1台" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/thumb/8/80/ATV_A1_logo.jpg/300px-ATV_A1_logo.jpg" group-title="General",A1台 (720p)\nhttps://15813114727637862976168173814320.live.prod.hkatv.com/a1_cbr_lo.m3u8\n#EXTINF:-1 tvg-id="CelestialClassicMovies.hk" tvg-name="Celestial Classic Movies" tvg-country="MY" tvg-language="" tvg-logo="https://1.bp.blogspot.com/-JitJUuWTMxg/VH--1LtXqGI/AAAAAAAAAo0/FL_bgsBFjeU/s1600/CELESTIAL%2BCLASSIC%2BMOVIES%2Blogo.png" group-title="",Celestial Classic 天映经典\nhttp://50.7.161.82:8278/streams/d/Celestial2/playlist.m3u8\n#EXTINF:-1 tvg-id="CelestialMovies.hk" tvg-name="Celestial Movies" tvg-country="HK;SG;MY;ID;TW;BN;BD" tvg-language="Chinese" tvg-logo="https://astrocontent.s3.amazonaws.com/Images/ChannelLogo/Pos/322_300.png" group-title="Movies",Celestial Movies (480p)\nhttp://210.210.155.35/qwr9ew/s/s33/index.m3u8\n#EXTINF:-1 tvg-id="CelestialMoviesMalaysia.hk" tvg-name="Celestial Movies Malaysia" tvg-country="MY" tvg-language="" tvg-logo="https://upload.wikimedia.org/wikipedia/id/thumb/a/af/CMC_English_full_color_black_text_2.jpg/200px-CMC_English_full_color_black_text_2.jpg" group-title="",Celestial Movies 天映频道\nhttp://50.7.161.82:8278/streams/d/Celestial/playlist.m3u8\n#EXTINF:-1 tvg-id="Kix.hk" tvg-name="Kix" tvg-country="MY" tvg-language="Malay (macrolanguage)" tvg-logo="https://i.imgur.com/mX1nnGy.png" group-title="Entertainment",Kix\nhttp://210.210.155.35/uq2663/h/h07/01.m3u8\n#EXTINF:-1 tvg-id="Kix.hk" tvg-name="Kix" tvg-country="MY" tvg-language="" tvg-logo="https://astrocontent.s3.amazonaws.com/Images/ChannelLogo/Pos/705_300.png" group-title="",Kix\nhttps://livecdn.fptplay.net/hda/kixhd_hls.smil/chunklist_b2500000.m3u8\n#EXTINF:-1 tvg-id="RTHKGangTaiDianShi31.hk" tvg-name="RTHK (港台電視31)" tvg-country="HK" tvg-language="" tvg-logo="http://tv.sason.xyz/logo/rthk31.png" group-title="",RTHK (港台電視31)\nhttp://rthklive1-lh.akamaihd.net/i/rthk31_1@167495/index_2052_av-p.m3u8?sd=10&rebase=on\n#EXTINF:-1 tvg-id="RTHKGangTaiDianShi32.hk" tvg-name="RTHK (港台電視32)" tvg-country="HK" tvg-language="" tvg-logo="" group-title="",RTHK (港台電視32)\nhttps://rthklive2-lh.akamaihd.net/i/rthk32_1@168450/index_1080_av-b.m3u8\n#EXTINF:-1 tvg-id="RTHKGangTaiDianShi32.hk" tvg-name="RTHK (港台電視32)" tvg-country="HK" tvg-language="" tvg-logo="http://tv.sason.xyz/logo/rthk32.png" group-title="",RTHK (港台電視32)\nhttps://rthklive2-lh.akamaihd.net/i/rthk32_1@168450/index_1080_av-b.m3u8?sd=10&rebase=on\n#EXTINF:-1 tvg-id="RTHKTV31.hk" tvg-name="RTHK TV 31" tvg-country="HK" tvg-language="" tvg-logo="https://i.imgur.com/H36G8wZ.png" group-title="",RTHK TV 31\nhttp://rthklive1-lh.akamaihd.net/i/rthk31_1@167495/index_810_av-b.m3u8\n#EXTINF:-1 tvg-id="RTHKTV32.hk" tvg-name="RTHK TV 32" tvg-country="HK" tvg-language="" tvg-logo="" group-title="",RTHK TV 32\nhttps://rthklive2-lh.akamaihd.net/i/rthk32_1@168450/index_702_av-b.m3u8\n#EXTINF:-1 tvg-id="RTHKTV32.hk" tvg-name="RTHK TV 32" tvg-country="HK" tvg-language="" tvg-logo="https://i.imgur.com/fmzC0MN.png" group-title="",RTHK TV 32\nhttps://rthklive2-lh.akamaihd.net/i/rthk32_1@168450/index_702_av-b.m3u8?sd=10&rebase=on\n#EXTINF:-1 tvg-id="RTHK31.hk" tvg-name="RTHK31" tvg-country="HK" tvg-language="" tvg-logo="https://gitee.com/radioer/radioer/raw/main/RTHK31.png" group-title="",RTHK31\nhttp://rthklive1-lh.akamaihd.net:80/i/rthk31_1@167495/index_2052_av-p.m3u8\n#EXTINF:-1 tvg-id="RTHK32.hk" tvg-name="RTHK32" tvg-country="HK" tvg-language="" tvg-logo="https://gitee.com/radioer/radioer/raw/main/RTHK32.png" group-title="",RTHK32\nhttps://rthklive2-lh.akamaihd.net/i/rthk32_1@168450/index_1080_av-p.m3u8\n#EXTINF:-1 tvg-id="StarSports.hk" tvg-name="Star Sports" tvg-country="SAS" tvg-language="English" tvg-logo="https://photo.sofun.tw/2013/11/STAR-SPORTS-LOGO.jpg" group-title="Sport",Star Sports\nrtmp://ivi.bupt.edu.cn:1935/livetv/starsports\n#EXTINF:-1 tvg-id="StarSports2HD.hk" tvg-name="Star Sports 2 HD" tvg-country="HK;IN" tvg-language="English" tvg-logo="https://upload.wikimedia.org/wikipedia/en/4/49/Star_Sports_India_logo1.png" group-title="Sport",Star Sports 2 HD\nhttp://221.120.204.4/STAR-SPORTS-2/tracks-v1a1/mono.m3u8\n#EXTINF:-1 tvg-id="Thrill.hk" tvg-name="Thrill" tvg-country="SAS" tvg-language="English" tvg-logo="http://console.celestialtiger.com/images/upload/1f6e441382a388940977fd9e165178c42fe0c193.png" group-title="Movies",Thrill (480p)\nhttp://45.126.83.51/qwr9ew/s/s34/index.m3u8\n#EXTINF:-1 tvg-id="TVBJade.hk" tvg-name="TVB Jade" tvg-country="HK" tvg-language="Chinese" tvg-logo="" group-title="",TVB Jade\nhttp://ubaio.chaoniu1995.top:6796/ub/cr/crtv.php?id=30\n#EXTINF:-1 tvg-id="TVBXingHe.hk" tvg-name="TVB Xing He" tvg-country="MY" tvg-language="" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/thumb/1/17/TVB_Xing_He_logo_2017.png/220px-TVB_Xing_He_logo_2017.png" group-title="",TVB Xing He 星河\nhttp://50.7.161.82:8278/streams/d/Xinhe/playlist.m3u8\n#EXTINF:-1 tvg-id="ViuTV.hk" tvg-name="ViuTV" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="http://aaaa.com.hk/main/wp-content/uploads/2020/02/ViuTV-logo.png" group-title="",ViuTV\nhttps://cdn.hkdtmb.com/hls/99/index.m3u8\n#EXTINF:-1 tvg-id="YaLuWeiShi.hk" tvg-name="亞旅衛視" tvg-country="HK" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://i.imgur.com/1wbOhJV.jpg" group-title="Travel",亞旅衛視\nhttp://hls.jingchangkan.tv/jingchangkan/156722438_0HaM/index.m3u8\n#EXTINF:-1 tvg-id="XingKongWeiShi.hk" tvg-name="星空衛視" tvg-country="HK" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/thumb/8/8d/Xing_Kong_Wei_Shi.jpg/250px-Xing_Kong_Wei_Shi.jpg" group-title="General",星空衛視\nrtmp://58.200.131.2:1935/livetv/startv\n#EXTINF:-1 tvg-id="GangTaiDianShi31.hk" tvg-name="港台電視31" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/RTHK_TV_31.svg/1200px-RTHK_TV_31.svg.png" group-title="General",港台電視31 (720p)\nhttps://www.rthk.hk/feeds/dtt/rthktv31_https.m3u8\n#EXTINF:-1 tvg-id="GangTaiDianShi32.hk" tvg-name="港台電視32" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/RTHK_TV_32.svg/1200px-RTHK_TV_32.svg.png" group-title="News",港台電視32 (480p)\nhttps://www.rthk.hk/feeds/dtt/rthktv32_https.m3u8\n#EXTINF:-1 tvg-id="FeiCuiTai81.hk" tvg-name="翡翠台（81）" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="http://img.tvb.com/corporate/_fck_/image/Jade_logo_L(1).jpg" group-title="",翡翠台（81）\nhttp://61.238.6.49:8000/bysid/1\n#EXTINF:-1 tvg-id="FeiCuiTai81.hk" tvg-name="翡翠台（81）" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="http://img.tvb.com/corporate/_fck_/image/Jade_logo_L(1).jpg" group-title="",翡翠台（81）\nhttps://cdn.hkdtmb.com/hls/81/index.m3u8\n#EXTINF:-1 tvg-id="YaoCaiCaiJingTai.hk" tvg-name="耀才財經台" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="https://i.imgur.com/xliVoIt.jpg?1" group-title="Shop",耀才財經台\nhttp://202.69.67.66:443/webcast/bshdlive-pc/playlist.m3u8\n#EXTINF:-1 tvg-id="XiangGangKaiDianShiHKSTVHKS.hk" tvg-name="香港开电视 / HKSTV-HKS" tvg-country="HK" tvg-language="" tvg-logo="" group-title="",香港开电视 / HKSTV-HKS\nhttp://media.fantv.hk/m3u8/archive/channel2.m3u8\n#EXTINF:-1 tvg-id="XiangGangWeiShi.hk" tvg-name="香港衛視" tvg-country="HK" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://i.imgur.com/wnQPn2d.jpg" group-title="",香港衛視\nhttp://zhibo.hkstv.tv/livestream/mutfysrq/playlist.m3u8\n#EXTINF:-1 tvg-id="XiangGangKaiDianShi.hk" tvg-name="香港開電視" tvg-country="HK" tvg-language="Chinese;Yue Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/e/ed/HK_open_tv_logo.jpg" group-title="General",香港開電視\nhttp://media.fantv.hk/m3u8/archive/channel2_stream1.m3u8\n#EXTINF:-1 tvg-id="FengHuangWeiShiZhongWenTai.hk" tvg-name="鳳凰衛視中文台" tvg-country="HK" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://pbs.twimg.com/profile_images/1246604721462239232/QCKNvVux_400x400.jpg" group-title="",鳳凰衛視中文台\nhttp://221.179.217.70/PLTV/88888888/224/3221225942/1.m3u8\n#EXTINF:-1 tvg-id="FengHuangZiXun.hk" tvg-name="鳳凰資訊" tvg-country="HK" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/thumb/1/16/Phoenix_InfoNews.svg/1200px-Phoenix_InfoNews.svg.png" group-title="News",鳳凰衛視資訊台HD\nhttp://117.169.120.138:8080/live/fhzixun/.m3u8\n#EXTINF:-1 tvg-id="FengHuangWeiShiDianYingTai.hk" tvg-name="鳳凰衛視電影台" tvg-country="HK" tvg-language="Chinese" tvg-logo="https://p1.ifengimg.com/a/2018_43/45a9d426b4ae58c.jpg" group-title="",鳳凰衛視電影台\nrtmp://ivi.bupt.edu.cn:1935/livetv/fhdy\n\n\n#EXTINF:-1 tvg-id="GOODTVCH1ZongHeTai.tw" tvg-name="GOOD TV CH1 綜合台" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/1_file.jpg" group-title="Religious",GOOD TV CH1 綜合台 (720p)\nhttps://live.streamingfast.net/osmflivech1.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH10KaoXiangDuShuHuiDuanBan.tw" tvg-name="GOOD TV CH10 烤箱讀書會 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/10_file.jpg" group-title="Religious",GOOD TV CH10 烤箱讀書會 短版 (720p)\nhttps://live.streamingfast.net/osmflivech10.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH12WeiTaMingShi.tw" tvg-name="GOOD TV CH12 維他命施" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/12_file.jpg" group-title="Religious",GOOD TV CH12 維他命施 (720p)\nhttps://live.streamingfast.net/osmflivech12.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH13JianKangXinZhuLiuDuanBan.tw" tvg-name="GOOD TV CH13 健康新煮流 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/13_file.jpg" group-title="Religious",GOOD TV CH13 健康新煮流 短版 (720p)\nhttps://live.streamingfast.net/osmflivech13.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH14ZhenQingBuLuoGe.tw" tvg-name="GOOD TV CH14 真情部落格" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/14_file.jpg" group-title="Religious",GOOD TV CH14 真情部落格 (720p)\nhttps://live.streamingfast.net/osmflivech14.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH15ZhenQingZhiYe.tw" tvg-name="GOOD TV CH15 真情之夜" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/15_file.jpg" group-title="Religious",GOOD TV CH15 真情之夜 (720p)\nhttps://live.streamingfast.net/osmflivech15.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH16XieGuangMing.tw" tvg-name="GOOD TV CH16 葉光明" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/16_file.jpg" group-title="Religious",GOOD TV CH16 葉光明 (720p)\nhttps://live.streamingfast.net/osmflivech16.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH17DaWeiBaoSen.tw" tvg-name="GOOD TV CH17 大衛鮑森" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/17_file.jpg" group-title="Religious",GOOD TV CH17 大衛鮑森 (720p)\nhttps://live.streamingfast.net/osmflivech17.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH18GuoJiJiangYuan.tw" tvg-name="GOOD TV CH18 國際講員" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/18_file.jpg" group-title="Religious",GOOD TV CH18 國際講員 (720p)\nhttps://live.streamingfast.net/osmflivech18.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH19GongXiangGuanDian.tw" tvg-name="GOOD TV CH19 共享觀點" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/19_file.jpg" group-title="Religious",GOOD TV CH19 共享觀點 (720p)\nhttps://live.streamingfast.net/osmflivech19.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH2ZhenLiTai.tw" tvg-name="GOOD TV CH2 真理台" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/2_file.jpg" group-title="Religious",GOOD TV CH2 真理台 (720p)\nhttps://live.streamingfast.net/osmflivech2.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH20EnDianShiFen.tw" tvg-name="GOOD TV CH20 恩典時分" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/20_file.jpg" group-title="Religious",GOOD TV CH20 恩典時分 (720p)\nhttps://live.streamingfast.net/osmflivech20.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH21HuaYuJiangYuan.tw" tvg-name="GOOD TV CH21 華語講員" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/21_file.jpg" group-title="Religious",GOOD TV CH21 華語講員 (720p)\nhttps://live.streamingfast.net/osmflivech21.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH22ZhiChangXinShiYe.tw" tvg-name="GOOD TV CH22 職場新視野" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/22_file.jpg" group-title="Religious",GOOD TV CH22 職場新視野 (720p)\nhttps://live.streamingfast.net/osmflivech22.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH23KongZhongZhuRiXueShengHuo.tw" tvg-name="GOOD TV CH23 空中主日學 生活" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/23_file.jpg" group-title="Religious",GOOD TV CH23 空中主日學 生活 (720p)\nhttps://live.streamingfast.net/osmflivech23.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH24LiuSanJiangGu.tw" tvg-name="GOOD TV CH24 劉三講古" tvg-country="TW" tvg-language="Chinese;Min Nan Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/24_file.jpg" group-title="Religious",GOOD TV CH24 劉三講古 (720p)\nhttps://live.streamingfast.net/osmflivech24.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH25FuQiRenSheng.tw" tvg-name="GOOD TV CH25 福氣人生" tvg-country="TW" tvg-language="Chinese;Min Nan Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/25_file.jpg" group-title="Religious",GOOD TV CH25 福氣人生 (720p)\nhttps://live.streamingfast.net/osmflivech25.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH26KongZhongZhuRiXueChaJing.tw" tvg-name="GOOD TV CH26 空中主日學 查經" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/26_file.jpg" group-title="Religious",GOOD TV CH26 空中主日學 查經 (720p)\nhttps://live.streamingfast.net/osmflivech26.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH27KongZhongShengJingXueYuan.tw" tvg-name="GOOD TV CH27 空中聖經學院" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/27_file.jpg" group-title="Religious",GOOD TV CH27 空中聖經學院 (720p)\nhttps://live.streamingfast.net/osmflivech27.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH28XianDaiShiGe.tw" tvg-name="GOOD TV CH28 現代詩歌" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/28_file.jpg" group-title="Religious",GOOD TV CH28 現代詩歌 (720p)\nhttps://live.streamingfast.net/osmflivech28.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH29JingDianYinLeHe.tw" tvg-name="GOOD TV CH29 經典音樂河" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/29_file.jpg" group-title="Religious",GOOD TV CH29 經典音樂河 (720p)\nhttps://live.streamingfast.net/osmflivech29.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH3ZhenQingBuLuoGeDuanBan.tw" tvg-name="GOOD TV CH3 真情部落格 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/3_file.jpg" group-title="Religious",GOOD TV CH3 真情部落格 短版 (720p)\nhttps://live.streamingfast.net/osmflivech3.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH30TianTangJingBai.tw" tvg-name="GOOD TV CH30 天堂敬拜" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/30_file.jpg" group-title="Religious",GOOD TV CH30 天堂敬拜 (720p)\nhttps://live.streamingfast.net/osmflivech30.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH31FuYinBuDaoYinLeHui.tw" tvg-name="GOOD TV CH31 福音佈道音樂會" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/31_file.jpg" group-title="Religious",GOOD TV CH31 福音佈道音樂會 (720p)\nhttps://live.streamingfast.net/osmflivech31.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH32TeHuiXiLieDaoGaoYuZhuanHua.tw" tvg-name="GOOD TV CH32 特會系列：禱告與轉化" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/32_file.jpg" group-title="Religious",GOOD TV CH32 特會系列：禱告與轉化 (720p)\nhttps://live.streamingfast.net/osmflivech32.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH33TeHuiXiLieYanJingPeiLing.tw" tvg-name="GOOD TV CH33 特會系列：研經培靈" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/33_file.jpg" group-title="Religious",GOOD TV CH33 特會系列：研經培靈 (720p)\nhttps://live.streamingfast.net/osmflivech33.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH36TeHuiXiLieChaoZiRanDaNengYiZhiShiFang.tw" tvg-name="GOOD TV CH36 特會系列：超自然大能．醫治釋放" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/36_file.jpg" group-title="Religious",GOOD TV CH36 特會系列：超自然大能．醫治釋放 (720p)\nhttps://live.streamingfast.net/osmflivech36.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH37TeHuiXiLieYiSeLieZhuanTi.tw" tvg-name="GOOD TV CH37 特會系列：以色列專題" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/37_file.jpg" group-title="Religious",GOOD TV CH37 特會系列：以色列專題 (720p)\nhttps://live.streamingfast.net/osmflivech37.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH38TeHuiXiLieQingNianTeHui.tw" tvg-name="GOOD TV CH38 特會系列：青年特會" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/38_file.jpg" group-title="Religious",GOOD TV CH38 特會系列：青年特會 (720p)\nhttps://live.streamingfast.net/osmflivech38.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH40JiaTing8DianDangZhuanZhuanFaXianAi.tw" tvg-name="GOOD TV CH40 家庭8點檔轉轉發現愛" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/40_file.jpg" group-title="Religious",GOOD TV CH40 家庭8點檔轉轉發現愛 (720p)\nhttps://live.streamingfast.net/osmflivech40.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH41XingFuXueTang.tw" tvg-name="GOOD TV CH41 幸福學堂" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/41_file.jpg" group-title="Religious",GOOD TV CH41 幸福學堂 (720p)\nhttps://live.streamingfast.net/osmflivech41.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH44KaoXiangDuShuHui.tw" tvg-name="GOOD TV CH44 烤箱讀書會" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/44_file.jpg" group-title="Religious",GOOD TV CH44 烤箱讀書會 (720p)\nhttps://live.streamingfast.net/osmflivech44.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH45QiaTong.tw" tvg-name="GOOD TV CH45 卡通" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/45_file.jpg" group-title="Religious",GOOD TV CH45 卡通 (720p)\nhttps://live.streamingfast.net/osmflivech45.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH47MuZhePinDao.tw" tvg-name="GOOD TV CH47 牧者頻道" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/47_file.jpg" group-title="Religious",GOOD TV CH47 牧者頻道 (720p)\nhttps://live.streamingfast.net/osmflivech47.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH49DaoGaoPinDao.tw" tvg-name="GOOD TV CH49 禱告頻道" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/49_file.jpg" group-title="Religious",GOOD TV CH49 禱告頻道 (720p)\nhttps://live.streamingfast.net/osmflivech49.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH5GongXiangGuanDianDuanBan.tw" tvg-name="GOOD TV CH5 共享觀點 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/5_file.jpg" group-title="Religious",GOOD TV CH5 共享觀點 短版 (720p)\nhttps://live.streamingfast.net/osmflivech5.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH50GuoJiJiangYuanZhongWenFaYin.tw" tvg-name="GOOD TV CH50 國際講員 中文發音" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/50_file.jpg" group-title="Religious",GOOD TV CH50 國際講員 中文發音 (720p)\nhttps://live.streamingfast.net/osmflivech50.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH6QinJinShenShiGeYinLe.tw" tvg-name="GOOD TV CH6 親近神 詩歌音樂" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/6_file.jpg" group-title="Religious",GOOD TV CH6 親近神 詩歌音樂 (720p)\nhttps://live.streamingfast.net/osmflivech6.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH7DaoGaoDaJunXinXi.tw" tvg-name="GOOD TV CH7 禱告大軍 信息" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/7_file.jpg" group-title="Religious",GOOD TV CH7 禱告大軍 信息 (720p)\nhttps://live.streamingfast.net/osmflivech7.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH8XingFuXueTangDuanBan.tw" tvg-name="GOOD TV CH8 幸福學堂 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/8_file.jpg" group-title="Religious",GOOD TV CH8 幸福學堂 短版 (720p)\nhttps://live.streamingfast.net/osmflivech8.m3u8\n#EXTINF:-1 tvg-id="GOODTVCH9AiPlusHaoYiShengDuanBan.tw" tvg-name="GOOD TV CH9 愛+好醫生 短版" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://app.streamingfast.net/uploads/channel/9_file.jpg" group-title="Religious",GOOD TV CH9 愛+好醫生 短版 (720p)\nhttps://live.streamingfast.net/osmflivech9.m3u8\n#EXTINF:-1 tvg-id="IndigenousTV.tw" tvg-name="Indigenous TV" tvg-country="TW" tvg-language="" tvg-logo="https://i.imgur.com/RuAYuSM.png" group-title="",Indigenous TV (720p)\nhttp://streamipcf.akamaized.net/live/_definst_/smil:liveabr.smil/playlist.m3u8\n#EXTINF:-1 tvg-id="TVBSXingWen.tw" tvg-name="TVBS新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://poster.starhubgo.com/Linear_channels2/808_1920x1080_HTV.png" group-title="News",TVBS新聞\nhttp://seb.sason.top/sc/tvbsxw_fhd.m3u8\n#EXTINF:-1 tvg-id="SanLiXingWen.tw" tvg-name="三立新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/e/e1/SETN_logo.png" group-title="News",三立新聞\nhttp://seb.sason.top/sc/sllive_fhd.m3u8\n#EXTINF:-1 tvg-id="ZhongTianXingWen.tw" tvg-name="中天新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://piceltaott-elta.cdn.hinet.net/upload/channel/908.png" group-title="News",中天新聞\nhttp://seb.sason.top/sc/ztxw_fhd.m3u8\n#EXTINF:-1 tvg-id="ZhongShiXingWen.tw" tvg-name="中視新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="http://new.ctv.com.tw/Cms_Data/Sites/CTV3/Themes/default/images/logo_news.png" group-title="News",中視新聞\nhttp://seb.sason.top/sc/zsxw_fhd.m3u8\n#EXTINF:-1 tvg-id="YuanZuMin.tw" tvg-name="原住民電視" tvg-country="TW" tvg-language="Chinese" tvg-logo="http://titv.ipcf.org.tw/images/logo.png" group-title="General",原住民電視 (720p)\nhttp://streamipcf.akamaized.net/live/_definst_/live_720/key_b1500.m3u8\n#EXTINF:-1 tvg-id="TaiShiXingWen.tw" tvg-name="台視新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.ttv.com.tw/news/15/images/TTV-N_logo200-min.png" group-title="News",台視新聞\nhttp://seb.sason.top/sc/tsxw_fhd.m3u8\n#EXTINF:-1 tvg-id="WeiXingDianShi.tw" tvg-name="唯心電視" tvg-country="TW" tvg-language="Chinese" tvg-logo="http://epg.51zmt.top:8000/tb1/gt/weixin.png" group-title="Religious",唯心電視\nhttp://mobile.ccdntech.com/transcoder/_definst_/vod164_Live/live/chunklist_w1177047531.m3u8\n#EXTINF:-1 tvg-id="YiDianShiXinWenTai.tw" tvg-name="壹電視新聞台" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://store-images.s-microsoft.com/image/apps.14454.9007199266706361.be7aa2de-7429-4e34-b9a4-eca9a55157c1.3eb6a511-ff23-46aa-bf3a-b8b7e7e5c808?mode=scale&q=90&h=270&w=270&background=%23FFFFFF" group-title="News",壹電視新聞台\nhttp://stream.nexttv.com.tw/n001/hd/live.m3u8\n#EXTINF:-1 tvg-id="DaAi1.tw" tvg-name="大愛2" tvg-country="TW" tvg-language="Chinese" tvg-logo="http://www.daai.tv/images/logo.png" group-title="General",大愛1\nhttps://pulltv1.wanfudaluye.com/live/tv1.m3u8\n#EXTINF:-1 tvg-id="DaAi2.tw" tvg-name="大愛2" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.cns.net.tw/web/upload/20141017171303RmzVY9Z.png" group-title="General",大愛2\nhttps://pulltv2.wanfudaluye.com/live/tv2.m3u8\n#EXTINF:-1 tvg-id="DaLiDianShi.tw" tvg-name="大立電視" tvg-country="TW" tvg-language="Min Nan Chinese" tvg-logo="http://www.dalitv.com.tw/img/LOGOn.png" group-title="General",大立電視\nhttp://www.dalitv.com.tw:4568/live/dali/index.m3u8\n#EXTINF:-1 tvg-id="DongLingXingWen.tw" tvg-name="東森新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://img.news.ebc.net.tw/EbcNews/logoes/pc_logo.png" group-title="News",東森新聞\nhttp://seb.sason.top/sc/dsxw_fhd.m3u8\n#EXTINF:-1 tvg-id="DongLingCaiJingXingWen.tw" tvg-name="東森財經新聞" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://img-fnc.ebc.net.tw/EbcFnc/logoes/pc_logo.png" group-title="News",東森財經新聞\nhttp://seb.sason.top/sc/dscjxw_fhd.m3u8\n#EXTINF:-1 tvg-id="MinShi.tw" tvg-name="民視" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.ftv.com.tw/images/Ch_01.png" group-title="General",民視 (720p)\nhttp://seb.sason.top/ptv/ftv.php?id=ms\n#EXTINF:-1 tvg-id="MinShiTaiWan.tw" tvg-name="民視台灣" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.ftv.com.tw/images/Ch_03.png" group-title="News",民視台灣 (720p)\nhttp://seb.sason.top/ptv/ftv.php?id=tw\n#EXTINF:-1 tvg-id="MinShiXinWenTai.tw" tvg-name="民視新聞台" tvg-country="TW" tvg-language="Chinese;Mandarin Chinese" tvg-logo="https://i.imgur.com/6jbjVNy.png" group-title="News",民視新聞台\nhttps://6.mms.vlog.xuite.net/hls/ftvtv/index.m3u8\n#EXTINF:-1 tvg-id="MinShiDiYi.tw" tvg-name="民視第一" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.ftv.com.tw/images/Ch_02.png" group-title="General",民視第一 (720p)\nhttp://seb.sason.top/ptv/ftv.php?id=dy\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoJiaoTongWeiYuanHui.tw" tvg-name="立法院IVOD直播交通委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播交通委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live6/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoNeiZhengWeiYuanHui.tw" tvg-name="立法院IVOD直播內政委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播內政委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live7/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoSiFaJiFaZhiWeiYuanHui.tw" tvg-name="立法院IVOD直播司法及法制委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播司法及法制委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live9/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoWaiJiaoJiGuoFangWeiYuanHui.tw" tvg-name="立法院IVOD直播外交及國防委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播外交及國防委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live8/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoJiaoYuJiWenHuaWeiYuanHui.tw" tvg-name="立法院IVOD直播教育及文化委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播教育及文化委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live4/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoZhaoYeXieShang.tw" tvg-name="立法院IVOD直播朝野協商" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播朝野協商 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live10/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoSheHuiFuLiJiWeiShengHuanJingWeiYuanHui.tw" tvg-name="立法院IVOD直播社會福利及衛生環境委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播社會福利及衛生環境委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live3/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoJingJiWeiYuanHui.tw" tvg-name="立法院IVOD直播經濟委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播經濟委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live5/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoCaiZhengWeiYuanHui.tw" tvg-name="立法院IVOD直播財政委員會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播財政委員會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live2/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="LiFaYuanIVODZhiBoYuanHui.tw" tvg-name="立法院IVOD直播院會" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://i.imgur.com/PxYhFpb.png" group-title="Legislative",立法院IVOD直播院會 (450p)\nhttps://lylive-videorent.cdn.hinet.net/out/u/live/gop4/ly/ly-Live1/hls-cl-tv/index.m3u8\n#EXTINF:-1 tvg-id="HuaZhangWeiShi.tw" tvg-name="華藏衛視" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://www.hwazan.org/statics/images/newhztv_logo.png" group-title="Religious",華藏衛視 (720p)\nhttp://118.163.88.61:1935/hwazanlivetv/live.stream/playlist.m3u8\n#EXTINF:-1 tvg-id="HuaShiXingWen.tw" tvg-name="華視新聞資訊" tvg-country="TW" tvg-language="Chinese" tvg-logo="https://upload.wikimedia.org/wikipedia/zh/thumb/2/27/Cts_news_info.png/200px-Cts_news_info.png" group-title="News",華視新聞資訊\nhttp://seb.sason.top/sc/hsxw_fhd.m3u8\n');localStorage.setItem("length",this.channels.length.toString()),Gn([d],t),i.items.forEach((t=>{const e=m(t.url);e&&(t.url=e,setTimeout((()=>{Hn(t)}),50))})),function(){const t=JSON.parse(localStorage.getItem("previous"));t&&(Pn(t),A("#channel-message",t))}(),Mn(this.channels),function(t,e,i){for(const n in t)Kn([n,t[n],"languages"],"language");for(const n in e)Kn([n,e[n],"countries"],"country");i.forEach((t=>Kn(t,"category")))}(qn,$n,zn)}))}}document.addEventListener("DOMContentLoaded",(()=>{(new Zn).init()})),window.addEventListener("load",(()=>{}));
